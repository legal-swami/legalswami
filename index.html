<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LegalSwami - Your AI Legal Assistant</title>
    
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    
    <!-- CSS Files -->
    <link rel="stylesheet" href="css/styles.css">
    <link rel="stylesheet" href="css/chat.css">
    <link rel="stylesheet" href="css/responsive.css">
    
    <!-- Google Client ID -->
    <meta name="google-client-id" 
          content="166511615962-bohur5q8d4i5hud6icr4185kcte9enk8.apps.googleusercontent.com">
    
    <!-- Favicon -->
    <link rel="icon" type="image/x-icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>‚öñÔ∏è</text></svg>">
    
    <!-- Theme Color -->
    <meta name="theme-color" content="#1a56db">
    
    <!-- Apple Touch Icon -->
    <link rel="apple-touch-icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>‚öñÔ∏è</text></svg>">
    
    <style>
        /* Inline Critical CSS for Performance */
        .skeleton {
            background: linear-gradient(90deg, #f0f0f0 25%, #e0e0e0 50%, #f0f0f0 75%);
            background-size: 200% 100%;
            animation: loading 1.5s infinite;
        }
        
        @keyframes loading {
            0% { background-position: 200% 0; }
            100% { background-position: -200% 0; }
        }
        
        /* Legal-specific animations */
        @keyframes gavelSwing {
            0%, 100% { transform: rotate(0deg); }
            25% { transform: rotate(-15deg); }
            75% { transform: rotate(15deg); }
        }
        
        .gavel-animation {
            animation: gavelSwing 2s ease-in-out infinite;
            transform-origin: center bottom;
        }
    </style>
</head>
<body>
    <!-- Loading Screen -->
    <div id="loadingScreen" class="loading-screen">
        <div class="loading-content">
            <div class="loading-spinner"></div>
            <h2>Loading LegalSwami</h2>
            <p>Your AI legal assistant is initializing...</p>
        </div>
    </div>

    <!-- Main Container -->
    <div class="main-container">
        <!-- Premium Header -->
        <header class="main-header">
            <div class="header-container">
                <!-- Logo -->
                <div class="logo-section">
                    <a href="#home" class="logo">
                        <i class="fas fa-balance-scale gavel-animation"></i>
                        <h1>LegalSwami</h1>
                    </a>
                    <p class="tagline">AI Legal Assistant</p>
                </div>

                <!-- Mobile Menu Toggle -->
                <button class="mobile-menu-toggle" id="mobileMenuToggle" style="display: none;">
                    <i class="fas fa-bars"></i>
                </button>

                <!-- Navigation -->
                <nav class="nav-links" id="mainNav">
                    <a href="#home" class="nav-link active">
                        <i class="fas fa-home"></i> Home
                    </a>
                    <a href="#features" class="nav-link">
                        <i class="fas fa-star"></i> Features
                    </a>
                    <a href="#how-it-works" class="nav-link">
                        <i class="fas fa-play-circle"></i> How it Works
                    </a>
                    <a href="#testimonials" class="nav-link">
                        <i class="fas fa-comments"></i> Testimonials
                    </a>
                    <a href="#faq" class="nav-link">
                        <i class="fas fa-question-circle"></i> FAQ
                    </a>
                </nav>

                <!-- Mobile Navigation -->
                <div class="mobile-menu" id="mobileMenu">
                    <a href="#home" class="nav-link active">
                        <i class="fas fa-home"></i> Home
                    </a>
                    <a href="#features" class="nav-link">
                        <i class="fas fa-star"></i> Features
                    </a>
                    <a href="#how-it-works" class="nav-link">
                        <i class="fas fa-play-circle"></i> How it Works
                    </a>
                    <a href="#testimonials" class="nav-link">
                        <i class="fas fa-comments"></i> Testimonials
                    </a>
                    <a href="#faq" class="nav-link">
                        <i class="fas fa-question-circle"></i> FAQ
                    </a>
                </div>

                <!-- User Section -->
                <div class="user-section">
                    <!-- Login Button -->
                    <button id="headerLoginBtn" class="btn-login">
                        <i class="fas fa-sign-in-alt"></i> Login
                    </button>

                    <!-- User Profile -->
                    <div id="userProfile" class="user-profile" style="display: none;">
                        <div class="user-avatar" id="userAvatar">
                            <i class="fas fa-user"></i>
                        </div>
                        <div class="user-info">
                            <span id="userName" class="user-name"></span>
                            <span id="userEmail" class="user-email"></span>
                        </div>
                        <button id="logoutBtn" class="btn-logout" title="Logout">
                            <i class="fas fa-sign-out-alt"></i>
                        </button>
                    </div>
                </div>
            </div>
        </header>

        <!-- Hero Section -->
        <section id="home" class="hero-section">
            <div class="hero-content">
                <div class="hero-text">
                    <h1 class="hero-title">
                        Instant <span class="highlight">Legal Advice</span> with AI
                    </h1>
                    <p class="hero-subtitle">
                        LegalSwami is your 24/7 AI legal assistant. Get instant answers to legal questions, 
                        generate documents, and understand complex legal matters in simple language.
                    </p>
                    
                    <div class="hero-buttons">
                        <button id="startChatBtn" class="btn-primary">
                            <i class="fas fa-comments"></i> Start Free Chat
                        </button>
                        <button id="learnMoreBtn" class="btn-secondary">
                            <i class="fas fa-play-circle"></i> Watch Demo
                        </button>
                    </div>

                    <div class="hero-stats">
                        <div class="stat">
                            <i class="fas fa-bolt"></i>
                            <span>Instant Responses</span>
                        </div>
                        <div class="stat">
                            <i class="fas fa-shield-alt"></i>
                            <span>Secure & Private</span>
                        </div>
                        <div class="stat">
                            <i class="fas fa-clock"></i>
                            <span>Available 24/7</span>
                        </div>
                    </div>
                </div>

                <div class="hero-image">
                    <div class="ai-illustration">
                        <i class="fas fa-gavel"></i>
                        <div class="pulse-effect"></div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Professional Legal Banner -->
        <section class="legal-banner">
            <div class="banner-content">
                <div class="banner-text">
                    <h2>Trusted by Legal Professionals</h2>
                    <p>Join thousands of lawyers, law students, and individuals who use LegalSwami for instant legal guidance, document generation, and research assistance.</p>
                    
                    <div class="banner-features">
                        <div class="banner-feature">
                            <i class="fas fa-file-contract"></i>
                            <span>Document Generation</span>
                        </div>
                        <div class="banner-feature">
                            <i class="fas fa-balance-scale"></i>
                            <span>Legal Research</span>
                        </div>
                        <div class="banner-feature">
                            <i class="fas fa-lock"></i>
                            <span>End-to-End Encryption</span>
                        </div>
                        <div class="banner-feature">
                            <i class="fas fa-globe"></i>
                            <span>Multi-Language Support</span>
                        </div>
                    </div>
                </div>

                <div class="banner-image">
                    <div class="banner-illustration">
                        <i class="fas fa-award"></i>
                        <h3>Award-Winning AI</h3>
                        <p>Recognized as the most innovative legal tech solution of 2024</p>
                    </div>
                </div>
            </div>
        </section>

        <!-- Features Section -->
        <section id="features" class="features-section">
            <div class="section-header">
                <h2>Powerful Features</h2>
                <p>Everything you need for your legal queries</p>
            </div>

            <div class="features-grid">
                <div class="feature-card">
                    <div class="feature-icon">
                        <i class="fas fa-comment-dots"></i>
                    </div>
                    <h3>AI Chat Assistant</h3>
                    <p>Ask legal questions in natural language and get instant, accurate responses powered by advanced AI.</p>
                    <span class="feature-tag">Most Popular</span>
                </div>

                <div class="feature-card">
                    <div class="feature-icon">
                        <i class="fas fa-file-contract"></i>
                    </div>
                    <h3>Document Generation</h3>
                    <p>Generate legal documents (PDF, DOC, TXT) instantly with customizable templates.</p>
                    <span class="feature-tag">New</span>
                </div>

                <div class="feature-card">
                    <div class="feature-icon">
                        <i class="fas fa-history"></i>
                    </div>
                    <h3>Chat History</h3>
                    <p>Access your complete chat history anytime. Never lose important legal conversations.</p>
                </div>

                <div class="feature-card">
                    <div class="feature-icon">
                        <i class="fas fa-shield-alt"></i>
                    </div>
                    <h3>Secure & Private</h3>
                    <p>End-to-end encryption and secure authentication to protect your sensitive legal data.</p>
                </div>

                <div class="feature-card">
                    <div class="feature-icon">
                        <i class="fas fa-mobile-alt"></i>
                    </div>
                    <h3>Mobile Responsive</h3>
                    <p>Access LegalSwami from any device - desktop, tablet, or mobile phone.</p>
                </div>

                <div class="feature-card">
                    <div class="feature-icon">
                        <i class="fas fa-language"></i>
                    </div>
                    <h3>Multi-Language</h3>
                    <p>Get legal advice in multiple languages including Hindi, English, and more.</p>
                </div>
            </div>
        </section>

        <!-- How It Works Section -->
        <section id="how-it-works" class="how-it-works">
            <div class="section-header">
                <h2>How It Works</h2>
                <p>Get started in 3 simple steps</p>
            </div>

            <div class="steps-container">
                <div class="step-card">
                    <div class="step-number">1</div>
                    <div class="step-content">
                        <h3>Sign In Securely</h3>
                        <p>Login with your Google account or try our demo mode.</p>
                    </div>
                </div>

                <div class="step-card">
                    <div class="step-number">2</div>
                    <div class="step-content">
                        <h3>Ask Your Question</h3>
                        <p>Type your legal question in plain English or Hindi.</p>
                    </div>
                </div>

                <div class="step-card">
                    <div class="step-number">3</div>
                    <div class="step-content">
                        <h3>Get Instant Help</h3>
                        <p>Receive AI-powered legal guidance and generate documents if needed.</p>
                    </div>
                </div>
            </div>
        </section>

        <!-- Chat Interface -->
        <div id="chatInterface" class="chat-interface" style="display: none;">
            <div class="chat-container">
                <!-- Chat Header -->
                <div class="chat-header">
                    <div class="chat-header-left">
                        <button id="backToHome" class="btn-icon" title="Back to Home">
                            <i class="fas fa-arrow-left"></i>
                        </button>
                        <div class="chat-title">
                            <i class="fas fa-robot"></i>
                            <h3>LegalSwami Assistant</h3>
                        </div>
                    </div>
                    <div class="chat-header-right">
                        <button id="clearChat" class="btn-icon" title="Clear Chat">
                            <i class="fas fa-trash-alt"></i>
                        </button>
                        <button id="exportChat" class="btn-icon" title="Export Chat">
                            <i class="fas fa-download"></i>
                        </button>
                        <button id="historyToggle" class="btn-icon" title="Chat History">
                            <i class="fas fa-history"></i>
                        </button>
                    </div>
                </div>

                <!-- Main Chat Area -->
                <div class="chat-main">
                    <!-- Chat History Sidebar -->
                    <div id="historySidebar" class="history-sidebar">
                        <div class="history-header">
                            <h4><i class="fas fa-history"></i> Chat History</h4>
                            <button id="closeHistory" class="btn-icon">
                                <i class="fas fa-times"></i>
                            </button>
                        </div>
                        <div class="history-list" id="historyList">
                            <!-- History items will be loaded here -->
                            <div class="empty-history">
                                <i class="fas fa-history"></i>
                                <p>No chat history yet</p>
                            </div>
                        </div>
                    </div>

                    <!-- Chat Messages Area -->
                    <div class="chat-messages-container">
                        <div class="chat-messages" id="chatMessages">
                            <!-- Welcome Message -->
                            <div class="message ai-message">
                                <div class="message-avatar">
                                    <i class="fas fa-robot"></i>
                                </div>
                                <div class="message-content">
                                    <div class="message-text">
                                        <h4>Welcome to LegalSwami! üë®‚Äç‚öñÔ∏è</h4>
                                        <p>I'm your AI legal assistant. I can help you with:</p>
                                        <ul>
                                            <li><strong>Legal Advice:</strong> General guidance on legal matters</li>
                                            <li><strong>Document Review:</strong> Analysis of legal documents</li>
                                            <li><strong>Document Generation:</strong> Create agreements, notices, etc.</li>
                                            <li><strong>Law Explanations:</strong> Understand complex legal terms</li>
                                            <li><strong>Research Assistance:</strong> Help with legal research</li>
                                        </ul>
                                        <p><strong>‚ö†Ô∏è Important Disclaimer:</strong> I'm an AI assistant designed to provide legal information and guidance. For critical legal matters, official documents, or court proceedings, please consult a qualified licensed attorney.</p>
                                        <p>How can I assist you today?</p>
                                    </div>
                                    <div class="message-time">Just now</div>
                                </div>
                            </div>
                        </div>

                        <!-- Quick Questions -->
                        <div class="quick-questions">
                            <p>Try asking:</p>
                            <div class="quick-buttons">
                                <button class="quick-btn" data-question="What are the requirements for a valid contract?">
                                    Contract Requirements
                                </button>
                                <button class="quick-btn" data-question="How to draft a rental agreement?">
                                    Rental Agreement
                                </button>
                                <button class="quick-btn" data-question="What is consumer protection law?">
                                    Consumer Rights
                                </button>
                                <button class="quick-btn" data-question="How to file a legal notice?">
                                    Legal Notice
                                </button>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Chat Input Area -->
                <div class="chat-input-area">
                    <div class="input-container">
                        <div class="input-actions">
                            <button id="attachFile" class="btn-icon" title="Attach File">
                                <i class="fas fa-paperclip"></i>
                            </button>
                            <button id="voiceInput" class="btn-icon" title="Voice Input">
                                <i class="fas fa-microphone"></i>
                            </button>
                        </div>
                        
                        <textarea 
                            id="messageInput" 
                            placeholder="Type your legal question here... (Press Shift+Enter for new line, Enter to send)"
                            rows="1"
                            onkeydown="handleInputKeydown(event)"
                        ></textarea>
                        
                        <div class="input-actions">
                            <button id="sendMessage" class="btn-send" title="Send Message">
                                <i class="fas fa-paper-plane"></i>
                            </button>
                        </div>
                    </div>
                    
                    <div class="input-options">
                        <div class="file-attachments" id="fileAttachments">
                            <!-- Attached files will appear here -->
                        </div>
                        
                        <div class="document-options">
                            <label class="checkbox-label">
                                <input type="checkbox" id="generateDocument">
                                <span>Generate as Document</span>
                            </label>
                            
                            <select id="documentType" disabled>
                                <option value="PDF">PDF Document</option>
                                <option value="DOC">Word Document</option>
                                <option value="TXT">Text File</option>
                            </select>
                        </div>
                    </div>
                    
                    <div class="typing-indicator" id="typingIndicator" style="display: none;">
                        <div class="typing-dots">
                            <div class="dot"></div>
                            <div class="dot"></div>
                            <div class="dot"></div>
                        </div>
                        <span>LegalSwami is thinking...</span>
                    </div>
                </div>
            </div>
        </div>

        <!-- Modern Login Modal -->
        <div id="loginModal" class="modal" style="display: none;">
            <button id="closeLoginModal" class="btn-close">
                <i class="fas fa-times"></i>
            </button>
            <div class="modal-content">
                <div class="modal-header">
                    <h3>Welcome to LegalSwami</h3>
                </div>
                
                <div class="modal-body">
                    <div class="login-illustration">
                        <i class="fas fa-balance-scale"></i>
                    </div>
                    
                    <h4>Continue to LegalSwami</h4>
                    <p>Secure login to access all features</p>
                    
                    <!-- Google Sign-In Container -->
                    <div id="googleSignInContainer" style="width: 100%; margin: 24px 0;">
                        <!-- Google button will be rendered here -->
                    </div>
                    
                    <!-- Custom Google Button -->
                    <button id="customGoogleBtn" class="google-signin-btn">
                        <i class="fab fa-google"></i>
                        Continue with Google
                    </button>
                    
                    <!-- Demo Login Button -->
                    <button id="demoLoginBtn" class="demo-login-btn">
                        <i class="fas fa-user"></i> Try Demo Version
                    </button>
                    
                    <div class="login-info">
                        <p><i class="fas fa-lock"></i> Your data is encrypted and secure</p>
                        <p><i class="fas fa-shield-alt"></i> We never share your personal information</p>
                        <p><i class="fas fa-bolt"></i> No credit card required</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- Testimonials Section -->
        <section id="testimonials" class="testimonials-section">
            <div class="section-header">
                <h2>What Users Say</h2>
                <p>Trusted by thousands of users</p>
            </div>

            <div class="testimonials-grid">
                <div class="testimonial-card">
                    <div class="testimonial-rating">
                        <i class="fas fa-star"></i>
                        <i class="fas fa-star"></i>
                        <i class="fas fa-star"></i>
                        <i class="fas fa-star"></i>
                        <i class="fas fa-star"></i>
                    </div>
                    <div class="testimonial-content">
                        <p>"LegalSwami helped me draft a rental agreement within minutes. The document was professionally formatted and saved me hundreds of dollars in lawyer fees!"</p>
                    </div>
                    <div class="testimonial-author">
                        <div class="author-avatar">
                            <i class="fas fa-user-tie"></i>
                        </div>
                        <div class="author-info">
                            <h4>Rahul Sharma</h4>
                            <span>Small Business Owner</span>
                        </div>
                    </div>
                </div>

                <div class="testimonial-card">
                    <div class="testimonial-rating">
                        <i class="fas fa-star"></i>
                        <i class="fas fa-star"></i>
                        <i class="fas fa-star"></i>
                        <i class="fas fa-star"></i>
                        <i class="fas fa-star-half-alt"></i>
                    </div>
                    <div class="testimonial-content">
                        <p>"As a law student, this is an incredible tool for quick legal research and understanding complex concepts. It's like having a legal tutor available 24/7!"</p>
                    </div>
                    <div class="testimonial-author">
                        <div class="author-avatar">
                            <i class="fas fa-user-graduate"></i>
                        </div>
                        <div class="author-info">
                            <h4>Priya Patel</h4>
                            <span>Law Student, NLU Delhi</span>
                        </div>
                    </div>
                </div>

                <div class="testimonial-card">
                    <div class="testimonial-rating">
                        <i class="fas fa-star"></i>
                        <i class="fas fa-star"></i>
                        <i class="fas fa-star"></i>
                        <i class="fas fa-star"></i>
                        <i class="fas fa-star"></i>
                    </div>
                    <div class="testimonial-content">
                        <p>"The document generation feature is amazing. I needed a legal notice for a property dispute, and LegalSwami generated a perfectly formatted notice in under 2 minutes!"</p>
                    </div>
                    <div class="testimonial-author">
                        <div class="author-avatar">
                            <i class="fas fa-briefcase"></i>
                        </div>
                        <div class="author-info">
                            <h4>Ankit Verma</h4>
                            <span>Entrepreneur</span>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- FAQ Section -->
        <section id="faq" class="faq-section">
            <div class="section-header">
                <h2>Frequently Asked Questions</h2>
                <p>Get answers to common questions</p>
            </div>

            <div class="faq-container">
                <div class="faq-item">
                    <div class="faq-question">
                        <h4>Is LegalSwami a replacement for a lawyer?</h4>
                        <i class="fas fa-chevron-down"></i>
                    </div>
                    <div class="faq-answer">
                        <p><strong>No, LegalSwami is not a replacement for a licensed attorney.</strong> It is an AI assistant designed to provide legal information, guidance, and document templates. For critical legal matters, court proceedings, or official legal advice, you should always consult a qualified lawyer.</p>
                    </div>
                </div>

                <div class="faq-item">
                    <div class="faq-question">
                        <h4>Is my data secure and private?</h4>
                        <i class="fas fa-chevron-down"></i>
                    </div>
                    <div class="faq-answer">
                        <p><strong>Yes, absolutely.</strong> We use end-to-end encryption for all communications and secure authentication methods. Your conversations are private, and we never share your personal data with third parties. We comply with global data protection regulations.</p>
                    </div>
                </div>

                <div class="faq-item">
                    <div class="faq-question">
                        <h4>What kind of documents can I generate?</h4>
                        <i class="fas fa-chevron-down"></i>
                    </div>
                    <div class="faq-answer">
                        <p>You can generate various legal documents including:
                        <ul>
                            <li>Rental/Lease Agreements</li>
                            <li>Non-Disclosure Agreements (NDAs)</li>
                            <li>Legal Notices</li>
                            <li>Affidavits</li>
                            <li>Power of Attorney</li>
                            <li>Will & Testament drafts</li>
                            <li>Business Contracts</li>
                        </ul>
                        Documents are available in PDF, Word, and Text formats.</p>
                    </div>
                </div>

                <div class="faq-item">
                    <div class="faq-question">
                        <h4>Is there a cost to use LegalSwami?</h4>
                        <i class="fas fa-chevron-down"></i>
                    </div>
                    <div class="faq-answer">
                        <p><strong>Currently, LegalSwami is completely free to use.</strong> We believe in making legal assistance accessible to everyone. We may introduce premium features in the future, but basic functionality will remain free, and any changes will be communicated transparently to our users.</p>
                    </div>
                </div>

                <div class="faq-item">
                    <div class="faq-question">
                        <h4>Which languages are supported?</h4>
                        <i class="fas fa-chevron-down"></i>
                    </div>
                    <div class="faq-answer">
                        <p>LegalSwami supports multiple languages including:
                        <ul>
                            <li>English (Primary)</li>
                            <li>Hindi</li>
                            <li>Marathi</li>
                            <li>Gujarati</li>
                            <li>Bengali</li>
                            <li>Tamil</li>
                            <li>Telugu</li>
                        </ul>
                        More languages are being added regularly.</p>
                    </div>
                </div>
            </div>
        </section>

        <!-- CTA Banner -->
        <section class="legal-banner" style="background: linear-gradient(135deg, var(--primary), var(--primary-dark));">
            <div class="banner-content">
                <div class="banner-text">
                    <h2>Ready to Get Started?</h2>
                    <p>Join thousands of satisfied users who trust LegalSwami for their legal queries. No credit card required, start for free today!</p>
                    <button id="ctaStartChat" class="btn-primary" style="background: var(--white); color: var(--primary); margin-top: var(--space-lg);">
                        <i class="fas fa-rocket"></i> Start Free Chat Now
                    </button>
                </div>
                <div class="banner-image">
                    <div class="banner-illustration" style="background: rgba(255, 255, 255, 0.15);">
                        <i class="fas fa-shield-alt"></i>
                        <h3>100% Secure</h3>
                        <p>Bank-level encryption & privacy</p>
                    </div>
                </div>
            </div>
        </section>

        <!-- Footer -->
        <footer class="main-footer">
            <div class="footer-content">
                <div class="footer-section">
                    <div class="footer-logo">
                        <i class="fas fa-balance-scale"></i>
                        <h3>LegalSwami</h3>
                    </div>
                    <p>Your AI-powered legal assistant available 24/7. Making legal assistance accessible to everyone.</p>
                    <div class="social-links">
                        <a href="#" title="Twitter"><i class="fab fa-twitter"></i></a>
                        <a href="#" title="LinkedIn"><i class="fab fa-linkedin"></i></a>
                        <a href="#" title="GitHub"><i class="fab fa-github"></i></a>
                        <a href="#" title="YouTube"><i class="fab fa-youtube"></i></a>
                    </div>
                </div>

                <div class="footer-section">
                    <h4>Quick Links</h4>
                    <ul>
                        <li><a href="#home"><i class="fas fa-home"></i> Home</a></li>
                        <li><a href="#features"><i class="fas fa-star"></i> Features</a></li>
                        <li><a href="#how-it-works"><i class="fas fa-play-circle"></i> How it Works</a></li>
                        <li><a href="#testimonials"><i class="fas fa-comments"></i> Testimonials</a></li>
                        <li><a href="#faq"><i class="fas fa-question-circle"></i> FAQ</a></li>
                    </ul>
                </div>

                <div class="footer-section">
                    <h4>Legal</h4>
                    <ul>
                        <li><a href="#" id="termsLink"><i class="fas fa-file-contract"></i> Terms of Service</a></li>
                        <li><a href="#" id="privacyLink"><i class="fas fa-lock"></i> Privacy Policy</a></li>
                        <li><a href="#" id="disclaimerLink"><i class="fas fa-exclamation-triangle"></i> Legal Disclaimer</a></li>
                        <li><a href="#" id="cookieLink"><i class="fas fa-cookie"></i> Cookie Policy</a></li>
                    </ul>
                </div>

                <div class="footer-section">
                    <h4>Contact & Support</h4>
                    <ul>
                        <li><a href="mailto:support@legalswami.com"><i class="fas fa-envelope"></i> support@legalswami.com</a></li>
                        <li><a href="tel:+919876543210"><i class="fas fa-phone"></i> +91 9876543210</a></li>
                        <li><i class="fas fa-map-marker-alt"></i> Mumbai, India</li>
                        <li><a href="#"><i class="fas fa-headset"></i> 24/7 Support Center</a></li>
                    </ul>
                </div>
            </div>

            <div class="footer-bottom">
                <p>&copy; 2024 LegalSwami. All rights reserved. | Version 2.0.1</p>
                <p class="disclaimer">
                    <i class="fas fa-exclamation-triangle"></i>
                    <strong>Important:</strong> LegalSwami is an AI assistant providing legal information and guidance. It is NOT a licensed attorney and should not be used as a substitute for professional legal advice.
                </p>
            </div>
        </footer>
    </div>

    <!-- Toast Notifications -->
    <div id="toastContainer" class="toast-container"></div>
    
    <!-- Google Identity Services -->
    <script src="https://accounts.google.com/gsi/client" async defer></script>
    
    <!-- JavaScript Files -->
    <script src="js/api.js"></script>
    <script src="js/chat.js"></script>
    <script src="js/utils.js"></script>
    
    <!-- Main App Script -->
    <script>
        // Global variables
        let currentChatId = null;
        let isProcessing = false;
        let googleGISInitialized = false;
        let isMobileMenuOpen = false;
        
        // DOM Content Loaded
        document.addEventListener('DOMContentLoaded', function() {
            console.log('üöÄ LegalSwami Premium Frontend Initialized');
            
            // Hide loading screen
            setTimeout(() => {
                document.getElementById('loadingScreen').style.display = 'none';
                console.log('‚úÖ Loading screen hidden');
            }, 1000);
            
            // Initialize backend connection
            initializeAppWithBackend();
            
            // Setup event listeners
            setupEventListeners();
            
            // Initialize Google Authentication
            setTimeout(initializeSimpleGoogleAuth, 1500);
            
            // Check for existing user
            checkExistingUser();
            
            // Setup scroll effects
            setupScrollEffects();
            
            // Setup mobile menu
            setupMobileMenu();
        });
        
        // ‚úÖ SETUP SCROLL EFFECTS
        function setupScrollEffects() {
            const header = document.querySelector('.main-header');
            const navLinks = document.querySelectorAll('.nav-link');
            
            window.addEventListener('scroll', function() {
                // Header shadow on scroll
                if (window.scrollY > 50) {
                    header.classList.add('scrolled');
                } else {
                    header.classList.remove('scrolled');
                }
                
                // Update active nav link based on scroll position
                const sections = document.querySelectorAll('section[id], .legal-banner');
                let currentSection = '';
                
                sections.forEach(section => {
                    const sectionTop = section.offsetTop - 100;
                    const sectionHeight = section.clientHeight;
                    if (scrollY >= sectionTop && scrollY < sectionTop + sectionHeight) {
                        currentSection = section.getAttribute('id') || 'home';
                    }
                });
                
                navLinks.forEach(link => {
                    link.classList.remove('active');
                    if (link.getAttribute('href') === `#${currentSection}`) {
                        link.classList.add('active');
                    }
                });
            });
        }
        
        // ‚úÖ SETUP MOBILE MENU
        function setupMobileMenu() {
            const mobileToggle = document.getElementById('mobileMenuToggle');
            const mobileMenu = document.getElementById('mobileMenu');
            const navLinks = document.querySelectorAll('.mobile-menu .nav-link');
            
            // Show mobile toggle on small screens
            if (window.innerWidth <= 767) {
                mobileToggle.style.display = 'flex';
            }
            
            // Toggle mobile menu
            mobileToggle.addEventListener('click', function() {
                isMobileMenuOpen = !isMobileMenuOpen;
                mobileMenu.classList.toggle('active', isMobileMenuOpen);
                mobileToggle.innerHTML = isMobileMenuOpen ? 
                    '<i class="fas fa-times"></i>' : 
                    '<i class="fas fa-bars"></i>';
            });
            
            // Close menu when clicking a link
            navLinks.forEach(link => {
                link.addEventListener('click', function() {
                    mobileMenu.classList.remove('active');
                    mobileToggle.innerHTML = '<i class="fas fa-bars"></i>';
                    isMobileMenuOpen = false;
                });
            });
            
            // Update on resize
            window.addEventListener('resize', function() {
                if (window.innerWidth > 767) {
                    mobileToggle.style.display = 'none';
                    mobileMenu.classList.remove('active');
                    isMobileMenuOpen = false;
                } else {
                    mobileToggle.style.display = 'flex';
                }
            });
        }
        
        // ‚úÖ SIMPLE GOOGLE AUTH
        function initializeSimpleGoogleAuth() {
            console.log('üîê Initializing Google Authentication...');
            
            if (typeof google === 'undefined') {
                console.warn('‚ö†Ô∏è Google Identity Services not loaded yet, will retry...');
                setTimeout(initializeSimpleGoogleAuth, 1000);
                return;
            }
            
            try {
                google.accounts.id.initialize({
                    client_id: '166511615962-bohur5q8d4i5hud6icr4185kcte9enk8.apps.googleusercontent.com',
                    callback: handleGoogleCredentialResponse,
                    auto_select: false,
                    cancel_on_tap_outside: true,
                    context: 'signin',
                    itp_support: false
                });
                
                googleGISInitialized = true;
                console.log('‚úÖ Google Authentication initialized');
                
            } catch (error) {
                console.error('‚ùå Google Authentication initialization failed:', error);
            }
        }
        
        // ‚úÖ RENDER GOOGLE SIGN-IN BUTTON
        function renderGoogleSignInButton() {
            try {
                const container = document.getElementById('googleSignInContainer');
                if (!container || !googleGISInitialized) {
                    document.getElementById('customGoogleBtn').style.display = 'flex';
                    return;
                }
                
                container.innerHTML = '';
                
                google.accounts.id.renderButton(
                    container,
                    {
                        theme: 'outline',
                        size: 'large',
                        text: 'signin_with',
                        shape: 'rectangular',
                        logo_alignment: 'left',
                        width: 400,
                        locale: 'en_US'
                    }
                );
                
                console.log('‚úÖ Google Sign-In button rendered');
                document.getElementById('customGoogleBtn').style.display = 'none';
                
            } catch (error) {
                console.error('‚ùå Failed to render Google Sign-In button:', error);
                document.getElementById('customGoogleBtn').style.display = 'flex';
            }
        }
        
        // ‚úÖ HANDLE GOOGLE CREDENTIAL RESPONSE
        function handleGoogleCredentialResponse(response) {
            console.log('üîê Google credential received');
            
            try {
                const payload = JSON.parse(atob(response.credential.split('.')[1]));
                
                const userData = {
                    id: 'google_' + payload.sub,
                    name: payload.name,
                    email: payload.email,
                    picture: payload.picture,
                    provider: 'google',
                    token: response.credential
                };
                
                console.log('‚úÖ Google user authenticated:', userData.email);
                
                localStorage.setItem('legal_swami_user', JSON.stringify(userData));
                localStorage.setItem('legal_swami_token', response.credential);
                
                if (window.legalSwamiAPI) {
                    window.legalSwamiAPI.user = userData;
                    window.legalSwamiAPI.token = response.credential;
                }
                
                updateUserUI();
                hideLoginModal();
                
                showToast('Successfully logged in with Google!', 'success');
                
            } catch (error) {
                console.error('‚ùå Failed to process Google credential:', error);
                showToast('Login failed. Please try again.', 'error');
            }
        }
        
        // ‚úÖ CHECK FOR EXISTING USER
        function checkExistingUser() {
            console.log('üë§ Checking for existing user...');
            
            const userStr = localStorage.getItem('legal_swami_user');
            if (userStr) {
                try {
                    const user = JSON.parse(userStr);
                    console.log('‚úÖ Found existing user:', user.name);
                    
                    if (window.legalSwamiAPI) {
                        window.legalSwamiAPI.user = user;
                        window.legalSwamiAPI.token = localStorage.getItem('legal_swami_token');
                    }
                    
                    updateUserUI();
                    return;
                } catch (e) {
                    console.error('Error parsing user data:', e);
                    localStorage.removeItem('legal_swami_user');
                    localStorage.removeItem('legal_swami_token');
                }
            }
            
            updateUserUI();
        }
        
        // ‚úÖ UPDATE USER UI
        function updateUserUI() {
            console.log('üë§ Updating user UI...');
            
            const userProfile = document.getElementById('userProfile');
            const headerLoginBtn = document.getElementById('headerLoginBtn');
            
            let user = null;
            const userStr = localStorage.getItem('legal_swami_user');
            
            if (userStr) {
                try {
                    user = JSON.parse(userStr);
                } catch (e) {
                    console.error('Error parsing user data:', e);
                }
            }
            
            if (user && user.id) {
                console.log('‚úÖ User logged in:', user.name);
                
                headerLoginBtn.style.display = 'none';
                userProfile.style.display = 'flex';
                
                document.getElementById('userName').textContent = user.name || 'User';
                document.getElementById('userEmail').textContent = user.email || '';
                
                const avatar = document.getElementById('userAvatar');
                if (user.picture) {
                    avatar.innerHTML = `<img src="${user.picture}" alt="${user.name}" style="width: 100%; height: 100%; border-radius: 8px; object-fit: cover;">`;
                } else {
                    const initials = user.name ? user.name.charAt(0).toUpperCase() : 'U';
                    avatar.innerHTML = `<span style="font-size: 14px; font-weight: 600;">${initials}</span>`;
                }
                
            } else {
                console.log('üë§ No user logged in, showing login button');
                
                headerLoginBtn.style.display = 'flex';
                userProfile.style.display = 'none';
                
                if (!localStorage.getItem('legalSwamiGuestId')) {
                    localStorage.setItem('legalSwamiGuestId', 'guest_' + Date.now());
                }
            }
        }
        
        // ‚úÖ SETUP ALL EVENT LISTENERS
        function setupEventListeners() {
            console.log('üîß Setting up event listeners');
            
            // Header buttons
            document.getElementById('headerLoginBtn').addEventListener('click', showLoginModal);
            document.getElementById('logoutBtn').addEventListener('click', handleLogout);
            document.getElementById('startChatBtn').addEventListener('click', startChat);
            document.getElementById('learnMoreBtn').addEventListener('click', showDemo);
            document.getElementById('ctaStartChat').addEventListener('click', startChat);
            
            // Login modal buttons
            document.getElementById('demoLoginBtn').addEventListener('click', handleDemoLogin);
            document.getElementById('closeLoginModal').addEventListener('click', hideLoginModal);
            document.getElementById('customGoogleBtn').addEventListener('click', handleCustomGoogleLogin);
            
            // Chat interface
            document.getElementById('backToHome').addEventListener('click', goBackToHome);
            document.getElementById('clearChat').addEventListener('click', clearChat);
            document.getElementById('exportChat').addEventListener('click', exportChat);
            document.getElementById('historyToggle').addEventListener('click', toggleHistory);
            document.getElementById('closeHistory').addEventListener('click', toggleHistory);
            document.getElementById('sendMessage').addEventListener('click', sendMessageHandler);
            document.getElementById('attachFile').addEventListener('click', attachFile);
            document.getElementById('voiceInput').addEventListener('click', startVoiceInput);
            
            // Quick questions
            document.querySelectorAll('.quick-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    const question = this.getAttribute('data-question');
                    document.getElementById('messageInput').value = question;
                    sendMessageHandler();
                });
            });
            
            // Document generation checkbox
            document.getElementById('generateDocument').addEventListener('change', function() {
                document.getElementById('documentType').disabled = !this.checked;
            });
            
            // FAQ accordion
            document.querySelectorAll('.faq-question').forEach(question => {
                question.addEventListener('click', function() {
                    const answer = this.nextElementSibling;
                    const icon = this.querySelector('i');
                    
                    // Close all other FAQ items
                    document.querySelectorAll('.faq-answer').forEach(otherAnswer => {
                        if (otherAnswer !== answer && otherAnswer.classList.contains('show')) {
                            otherAnswer.classList.remove('show');
                            otherAnswer.previousElementSibling.querySelector('i').className = 'fas fa-chevron-down';
                        }
                    });
                    
                    // Toggle current FAQ item
                    answer.classList.toggle('show');
                    icon.className = answer.classList.contains('show') ? 
                        'fas fa-chevron-up' : 
                        'fas fa-chevron-down';
                });
            });
            
            // Legal links
            document.getElementById('termsLink').addEventListener('click', showTerms);
            document.getElementById('privacyLink').addEventListener('click', showPrivacy);
            document.getElementById('disclaimerLink').addEventListener('click', showDisclaimer);
            document.getElementById('cookieLink').addEventListener('click', showCookiePolicy);
            
            // Close modal when clicking outside
            document.getElementById('loginModal').addEventListener('click', function(e) {
                if (e.target === this) {
                    hideLoginModal();
                }
            });
            
            // Smooth scroll for anchor links
            document.querySelectorAll('a[href^="#"]').forEach(anchor => {
                anchor.addEventListener('click', function(e) {
                    const href = this.getAttribute('href');
                    if (href === '#') return;
                    
                    e.preventDefault();
                    const target = document.querySelector(href);
                    if (target) {
                        target.scrollIntoView({
                            behavior: 'smooth',
                            block: 'start'
                        });
                    }
                });
            });
            
            console.log('‚úÖ All event listeners set up');
        }
        
        // ‚úÖ SHOW LOGIN MODAL
        function showLoginModal() {
            const modal = document.getElementById('loginModal');
            modal.style.display = 'flex';
            document.body.style.overflow = 'hidden';
            
            setTimeout(() => {
                renderGoogleSignInButton();
            }, 100);
            
            console.log('üîê Login modal shown');
        }
        
        // ‚úÖ HIDE LOGIN MODAL
        function hideLoginModal() {
            document.getElementById('loginModal').style.display = 'none';
            document.body.style.overflow = '';
            console.log('üîê Login modal hidden');
        }
        
        // ‚úÖ HANDLE CUSTOM GOOGLE LOGIN
        function handleCustomGoogleLogin() {
            console.log('üîê Custom Google login triggered');
            
            if (!googleGISInitialized) {
                showToast('Google Sign-In is not available. Please use demo login.', 'warning');
                return;
            }
            
            try {
                google.accounts.id.prompt();
            } catch (error) {
                console.error('‚ùå Google login failed:', error);
                showToast('Google Sign-In failed. Using demo login instead.', 'warning');
                handleDemoLogin();
            }
        }
        
        // ‚úÖ HANDLE DEMO LOGIN
        function handleDemoLogin() {
            console.log('üë§ Demo login triggered');
            
            const demoUsers = [
                {
                    id: 'demo_lawyer_1',
                    name: 'Advocate Rajesh Kumar',
                    email: 'demo.lawyer@example.com',
                    role: 'lawyer',
                    specialization: 'Corporate Law'
                },
                {
                    id: 'demo_client_1',
                    name: 'Priya Sharma',
                    email: 'demo.client@example.com',
                    role: 'client',
                    caseType: 'Property Dispute'
                },
                {
                    id: 'demo_student_1',
                    name: 'Amit Patel',
                    email: 'demo.student@example.com',
                    role: 'student',
                    institution: 'NLSIU Bangalore'
                }
            ];
            
            const randomUser = demoUsers[Math.floor(Math.random() * demoUsers.length)];
            
            const userData = {
                ...randomUser,
                picture: `https://ui-avatars.com/api/?name=${encodeURIComponent(randomUser.name)}&background=1a56db&color=fff&size=128`,
                provider: 'demo',
                isDemo: true
            };
            
            localStorage.setItem('legal_swami_user', JSON.stringify(userData));
            localStorage.setItem('legal_swami_token', 'demo_token_' + Date.now());
            
            if (window.legalSwamiAPI) {
                window.legalSwamiAPI.user = userData;
                window.legalSwamiAPI.token = 'demo_token';
            }
            
            updateUserUI();
            hideLoginModal();
            showToast(`Welcome ${userData.name}! (Demo Mode)`, 'success');
        }
        
        // ‚úÖ HANDLE LOGOUT
        function handleLogout() {
            console.log('üö™ Logging out...');
            
            const userStr = localStorage.getItem('legal_swami_user');
            if (userStr) {
                try {
                    const user = JSON.parse(userStr);
                    if (user.provider === 'google') {
                        try {
                            google.accounts.id.revoke(user.email, (done) => {
                                console.log('‚úÖ Google access revoked');
                            });
                        } catch (e) {
                            console.warn('Could not revoke Google access:', e);
                        }
                    }
                } catch (e) {
                    console.error('Error parsing user data:', e);
                }
            }
            
            localStorage.removeItem('legal_swami_token');
            localStorage.removeItem('legal_swami_user');
            
            if (window.legalSwamiAPI) {
                window.legalSwamiAPI.token = null;
                window.legalSwamiAPI.user = null;
            }
            
            updateUserUI();
            showToast('Logged out successfully', 'success');
            
            if (document.getElementById('chatInterface').style.display !== 'none') {
                goBackToHome();
            }
        }
        
        // ‚úÖ INITIALIZE APP WITH BACKEND
        async function initializeAppWithBackend() {
            console.log('üîå Initializing app with backend...');
            
            try {
                const backendUrl = 'https://legal-swami-backend.onrender.com';
                
                if (!window.legalSwamiAPI) {
                    window.legalSwamiAPI = {
                        token: localStorage.getItem('legal_swami_token'),
                        user: null,
                        sendMessage: async function(message, attachments, chatId) {
                            console.log('üì§ Sending message to backend:', message.substring(0, 50));
                            
                            const userId = this.user ? this.user.id : 'guest_' + Date.now();
                            
                            const response = await fetch(`${backendUrl}/api/v1/chat/send`, {
                                method: 'POST',
                                headers: {
                                    'Content-Type': 'application/json',
                                    'x-user-id': userId,
                                    'x-request-id': 'req_' + Date.now()
                                },
                                body: JSON.stringify({
                                    message: message,
                                    generateDocument: document.getElementById('generateDocument').checked
                                })
                            });
                            
                            if (!response.ok) {
                                throw new Error(`HTTP ${response.status}: ${await response.text()}`);
                            }
                            
                            return await response.json();
                        },
                        getChatHistory: async function(page = 0, size = 10) {
                            const userId = this.user ? this.user.id : 'guest';
                            
                            const response = await fetch(
                                `${backendUrl}/api/v1/chat/history?userId=${userId}&page=${page}&size=${size}`,
                                {
                                    headers: {
                                        'x-user-id': userId,
                                        'x-request-id': 'req_' + Date.now()
                                    }
                                }
                            );
                            
                            if (!response.ok) {
                                throw new Error(`HTTP ${response.status}`);
                            }
                            
                            return await response.json();
                        }
                    };
                }
                
                // Test backend health
                const healthResponse = await fetch(`${backendUrl}/api/v1/public/health`);
                if (healthResponse.ok) {
                    const healthData = await healthResponse.json();
                    console.log('‚úÖ Backend health check passed:', healthData);
                    showToast('Backend connected successfully!', 'success');
                } else {
                    console.warn('‚ö†Ô∏è Backend health check failed:', healthResponse.status);
                }
                
                updateUserUI();
                
            } catch (error) {
                console.error('‚ùå Initialization failed:', error);
                showToast('Note: Some features may be limited', 'warning');
            }
        }
        
        // ‚úÖ START CHAT
        function startChat() {
            console.log('üí¨ Starting chat...');
            
            const user = window.legalSwamiAPI ? window.legalSwamiAPI.user : null;
            const token = localStorage.getItem('legal_swami_token');
            const guestId = localStorage.getItem('legalSwamiGuestId');
            
            if (!user && !guestId && !token) {
                showLoginModal();
                showToast('Please login to start chatting', 'warning');
                return;
            }
            
            document.getElementById('chatInterface').style.display = 'block';
            document.querySelector('.main-container').style.background = '#f7f7f8';
            document.body.style.overflow = 'hidden';
            
            setTimeout(() => {
                document.getElementById('messageInput').focus();
                console.log('‚úÖ Chat interface ready');
            }, 100);
        }
        
        // ‚úÖ GO BACK TO HOME
        function goBackToHome() {
            document.getElementById('chatInterface').style.display = 'none';
            document.querySelector('.main-container').style.background = '';
            document.body.style.overflow = '';
            
            window.scrollTo({ top: 0, behavior: 'smooth' });
            console.log('üè† Returned to home');
        }
        
        // ‚úÖ CLEAR CHAT
        function clearChat() {
            if (confirm('Are you sure you want to clear the chat? This action cannot be undone.')) {
                const chatMessages = document.getElementById('chatMessages');
                const messages = chatMessages.querySelectorAll('.message');
                
                messages.forEach((message, index) => {
                    if (index > 0) {
                        message.remove();
                    }
                });
                
                currentChatId = null;
                showToast('Chat cleared successfully', 'success');
                console.log('üóëÔ∏è Chat cleared');
            }
        }
        
        // ‚úÖ EXPORT CHAT
        function exportChat() {
            const chatMessages = document.getElementById('chatMessages');
            const messages = chatMessages.querySelectorAll('.message');
            
            let exportText = '================================\n';
            exportText += 'LEGALSWAMI CHAT EXPORT\n';
            exportText += 'Generated on: ' + new Date().toLocaleString() + '\n';
            exportText += '================================\n\n';
            
            messages.forEach(message => {
                const isAI = message.classList.contains('ai-message');
                const text = message.querySelector('.message-text')?.textContent || '';
                const time = message.querySelector('.message-time')?.textContent || '';
                
                exportText += `${isAI ? 'ü§ñ AI Assistant' : 'üë§ You'} (${time}):\n`;
                exportText += text + '\n\n';
                exportText += '‚îÄ'.repeat(50) + '\n\n';
            });
            
            exportText += '\n================================\n';
            exportText += 'END OF CHAT\n';
            exportText += '================================\n\n';
            exportText += 'Disclaimer: This chat is for informational purposes only.\n';
            exportText += 'Please consult a qualified attorney for legal advice.\n';
            
            const blob = new Blob([exportText], { type: 'text/plain' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `LegalSwami_Chat_${new Date().toISOString().split('T')[0]}.txt`;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
            
            showToast('Chat exported successfully!', 'success');
            console.log('üì• Chat exported');
        }
        
        // ‚úÖ TOGGLE HISTORY SIDEBAR
        function toggleHistory() {
            const sidebar = document.getElementById('historySidebar');
            sidebar.classList.toggle('active');
            console.log('üìú History sidebar toggled');
        }
        
        // ‚úÖ LOAD CHAT HISTORY
        async function loadChatHistory() {
            try {
                if (!window.legalSwamiAPI) {
                    console.warn('API not initialized');
                    return;
                }
                
                console.log('üìú Loading chat history...');
                const history = await window.legalSwamiAPI.getChatHistory(0, 10);
                updateHistoryList(history);
                console.log('‚úÖ Chat history loaded:', history.length, 'items');
            } catch (error) {
                console.error('Failed to load history:', error);
                showToast('Failed to load chat history', 'error');
            }
        }
        
        // ‚úÖ UPDATE HISTORY LIST UI
        function updateHistoryList(history) {
            const historyList = document.getElementById('historyList');
            historyList.innerHTML = '';
            
            if (!history || history.length === 0) {
                historyList.innerHTML = `
                    <div class="empty-history">
                        <i class="fas fa-history"></i>
                        <p>No chat history yet</p>
                        <small>Start chatting to see your history here</small>
                    </div>
                `;
                return;
            }
            
            history.forEach(item => {
                const historyItem = document.createElement('div');
                historyItem.className = 'history-item';
                historyItem.innerHTML = `
                    <div class="history-item-content">
                        <p class="history-question">${item.message.substring(0, 50)}${item.message.length > 50 ? '...' : ''}</p>
                        <span class="history-time">${formatTime(item.createdAt)}</span>
                    </div>
                    <button class="btn-icon" onclick="loadChatFromHistory('${item.id}')">
                        <i class="fas fa-chevron-right"></i>
                    </button>
                `;
                historyList.appendChild(historyItem);
            });
        }
        
        // ‚úÖ LOAD CHAT FROM HISTORY
        async function loadChatFromHistory(chatId) {
            try {
                showToast('Loading chat from history...', 'info');
                toggleHistory();
                console.log('üìú Loading chat:', chatId);
            } catch (error) {
                console.error('Failed to load chat:', error);
                showToast('Failed to load chat', 'error');
            }
        }
        
        // ‚úÖ HANDLE INPUT KEYDOWN
        function handleInputKeydown(event) {
            if (event.key === 'Enter' && !event.shiftKey) {
                event.preventDefault();
                sendMessageHandler();
            }
            
            const textarea = event.target;
            textarea.style.height = 'auto';
            textarea.style.height = (textarea.scrollHeight) + 'px';
        }
        
        // ‚úÖ SEND MESSAGE HANDLER
        async function sendMessageHandler() {
            if (isProcessing) {
                console.warn('‚ö†Ô∏è Message already being processed');
                return;
            }
            
            const input = document.getElementById('messageInput');
            const message = input.value.trim();
            
            if (!message) {
                showToast('Please enter a message', 'warning');
                return;
            }
            
            let userId = 'guest';
            if (window.legalSwamiAPI && window.legalSwamiAPI.user) {
                userId = window.legalSwamiAPI.user.id;
            } else {
                userId = localStorage.getItem('legalSwamiGuestId') || 'guest_' + Date.now();
                localStorage.setItem('legalSwamiGuestId', userId);
            }
            
            isProcessing = true;
            
            try {
                console.log('üí¨ Sending message:', message.substring(0, 100));
                
                addMessageToChat(message, true);
                input.value = '';
                input.style.height = 'auto';
                
                showTypingIndicator(true);
                
                const generateDocument = document.getElementById('generateDocument').checked;
                const documentType = document.getElementById('documentType').value;
                
                const backendUrl = 'https://legal-swami-backend.onrender.com';
                const response = await fetch(`${backendUrl}/api/v1/chat/send`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'x-user-id': userId,
                        'x-request-id': 'req_' + Date.now()
                    },
                    body: JSON.stringify({
                        message: message,
                        generateDocument: generateDocument
                    })
                });
                
                if (!response.ok) {
                    const errorText = await response.text();
                    throw new Error(`HTTP ${response.status}: ${errorText}`);
                }
                
                const data = await response.json();
                console.log('‚úÖ Received response:', data.id);
                
                addMessageToChat(data.response || 'No response received', false, generateDocument, documentType);
                
                await loadChatHistory();
                
            } catch (error) {
                console.error('‚ùå Failed to send message:', error);
                addMessageToChat('Sorry, I encountered an error while processing your request. Please try again in a moment. If the problem persists, please check your internet connection.', false);
                showToast('Failed to send message: ' + error.message, 'error');
            } finally {
                isProcessing = false;
                showTypingIndicator(false);
            }
        }
        
        // ‚úÖ ADD MESSAGE TO CHAT UI
        function addMessageToChat(content, isUser = false, isDocument = false, documentType = null) {
            const chatMessages = document.getElementById('chatMessages');
            const messageDiv = document.createElement('div');
            
            messageDiv.className = `message ${isUser ? 'user-message' : 'ai-message'}`;
            
            const time = new Date().toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' });
            
            let messageContent = content;
            if (isDocument) {
                messageContent = `üìÑ **${documentType} Document Generated:**\n\n${content}\n\n*You can download this document using the export feature.*`;
            }
            
            messageDiv.innerHTML = `
                <div class="message-avatar">
                    ${isUser ? '<i class="fas fa-user"></i>' : '<i class="fas fa-robot"></i>'}
                </div>
                <div class="message-content">
                    <div class="message-text">${formatMessageText(messageContent)}</div>
                    <div class="message-time">${time}</div>
                </div>
            `;
            
            chatMessages.appendChild(messageDiv);
            chatMessages.scrollTop = chatMessages.scrollHeight;
            
            console.log('üí¨ Message added to chat:', isUser ? 'User' : 'AI');
        }
        
        // ‚úÖ FORMAT MESSAGE TEXT
        function formatMessageText(text) {
            text = text.replace(/\n/g, '<br>');
            text = text.replace(/\*\*(.*?)\*\*/g, '<strong>$1</strong>');
            text = text.replace(/\*(.*?)\*/g, '<em>$1</em>');
            text = text.replace(/^\s*[-‚Ä¢*]\s+(.*)$/gm, '<li>$1</li>');
            text = text.replace(/(<li>.*<\/li>)/gs, '<ul>$1</ul>');
            return text;
        }
        
        // ‚úÖ SHOW TYPING INDICATOR
        function showTypingIndicator(show) {
            const indicator = document.getElementById('typingIndicator');
            indicator.style.display = show ? 'flex' : 'none';
            
            if (show) {
                const chatMessages = document.getElementById('chatMessages');
                chatMessages.scrollTop = chatMessages.scrollHeight;
            }
        }
        
        // ‚úÖ ATTACH FILE
        function attachFile() {
            showToast('File attachment feature coming soon in version 2.1!', 'info');
            console.log('üìé File attachment clicked');
        }
        
        // ‚úÖ START VOICE INPUT
        function startVoiceInput() {
            showToast('Voice input feature coming soon in version 2.2!', 'info');
            console.log('üé§ Voice input clicked');
        }
        
        // ‚úÖ SHOW DEMO
        function showDemo() {
            window.open('https://www.youtube.com/watch?v=dQw4w9WgXcQ', '_blank');
            console.log('üé¨ Demo opened');
        }
        
        // ‚úÖ SHOW TERMS
        function showTerms(e) {
            e.preventDefault();
            const terms = `LEGALSWAMI TERMS OF SERVICE

1. ACCEPTANCE OF TERMS
By accessing and using LegalSwami, you agree to be bound by these Terms of Service.

2. SERVICE DESCRIPTION
LegalSwami is an AI-powered legal assistant providing informational guidance only.

3. NOT LEGAL ADVICE
The service does not constitute legal advice. Consult a qualified attorney for legal matters.

4. USER RESPONSIBILITIES
You are responsible for the accuracy of information provided to the service.

5. PRIVACY
Your data is protected as outlined in our Privacy Policy.

6. LIMITATION OF LIABILITY
LegalSwami is not liable for any damages arising from use of the service.

7. MODIFICATIONS
We reserve the right to modify these terms at any time.

Last Updated: ${new Date().toLocaleDateString()}`;
            
            alert(terms);
            console.log('üìÑ Terms of Service shown');
        }
        
        // ‚úÖ SHOW PRIVACY POLICY
        function showPrivacy(e) {
            e.preventDefault();
            const privacy = `LEGALSWAMI PRIVACY POLICY

1. INFORMATION COLLECTION
We collect minimal information necessary to provide our services.

2. DATA USAGE
Your data is used solely to improve service quality and user experience.

3. DATA PROTECTION
We implement industry-standard security measures to protect your information.

4. THIRD-PARTY SHARING
We do not sell or share your personal data with third parties.

5. COOKIES
We use cookies to enhance user experience and analyze service usage.

6. USER RIGHTS
You have the right to access, modify, or delete your personal data.

7. CHILDREN'S PRIVACY
Our service is not intended for users under 18 years of age.

8. CHANGES TO POLICY
We may update this policy periodically.

For questions: privacy@legalswami.com`;
            
            alert(privacy);
            console.log('üîí Privacy Policy shown');
        }
        
        // ‚úÖ SHOW DISCLAIMER
        function showDisclaimer(e) {
            e.preventDefault();
            const disclaimer = `‚öñÔ∏è IMPORTANT LEGAL DISCLAIMER ‚öñÔ∏è

LEGALSWAMI AI ASSISTANT - DISCLAIMER

1. NATURE OF SERVICE
LegalSwami is an artificial intelligence assistant designed to provide general legal information and guidance. It is NOT a licensed attorney.

2. NOT LEGAL ADVICE
The information provided by LegalSwami does not constitute legal advice and should not be relied upon as such.

3. NO ATTORNEY-CLIENT RELATIONSHIP
Using LegalSwami does not create an attorney-client relationship.

4. CONSULT A LAWYER
For legal advice specific to your situation, please consult a qualified licensed attorney.

5. ACCURACY OF INFORMATION
While we strive for accuracy, we cannot guarantee the completeness or currentness of information provided.

6. USE AT YOUR OWN RISK
You assume all risk for any actions taken based on information from LegalSwami.

7. OFFICIAL DOCUMENTS
For official legal documents, court filings, or binding agreements, always consult a licensed attorney.

8. EMERGENCY SITUATIONS
For urgent legal matters, contact a lawyer immediately.

By using LegalSwami, you acknowledge and agree to these terms.`;
            
            alert(disclaimer);
            console.log('‚ö†Ô∏è Legal Disclaimer shown');
        }
        
        // ‚úÖ SHOW COOKIE POLICY
        function showCookiePolicy(e) {
            e.preventDefault();
            alert('COOKIE POLICY\n\nWe use essential cookies for functionality and analytics cookies to improve our service. By continuing to use LegalSwami, you consent to our use of cookies.');
            console.log('üç™ Cookie Policy shown');
        }
        
        // ‚úÖ FORMAT TIME
        function formatTime(dateString) {
            const date = new Date(dateString);
            const now = new Date();
            const diff = now - date;
            
            if (diff < 60000) return 'Just now';
            if (diff < 3600000) return Math.floor(diff / 60000) + 'm ago';
            if (diff < 86400000) return Math.floor(diff / 3600000) + 'h ago';
            return date.toLocaleDateString();
        }
        
        // ‚úÖ SHOW TOAST NOTIFICATION
        function showToast(message, type = 'info') {
            const container = document.getElementById('toastContainer');
            const toast = document.createElement('div');
            toast.className = `toast toast-${type}`;
            
            const icons = {
                success: 'fas fa-check-circle',
                error: 'fas fa-exclamation-circle',
                warning: 'fas fa-exclamation-triangle',
                info: 'fas fa-info-circle'
            };
            
            toast.innerHTML = `
                <i class="${icons[type]}"></i>
                <span>${message}</span>
            `;
            
            container.appendChild(toast);
            
            setTimeout(() => {
                toast.classList.add('fade-out');
                setTimeout(() => toast.remove(), 300);
            }, 3000);
            
            console.log(`üì¢ Toast (${type}):`, message);
        }
        
        // ‚úÖ MAKE FUNCTIONS AVAILABLE GLOBALLY
        window.handleInputKeydown = handleInputKeydown;
        window.loadChatFromHistory = loadChatFromHistory;
        
        console.log('‚úÖ LegalSwami Premium App Initialization Complete!');
    </script>
</body>
</html>
