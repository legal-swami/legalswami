<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LegalSwami - Your AI Legal Assistant</title>
        
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&family=Roboto+Slab:wght@400;500;600;700&display=swap" rel="stylesheet">
    
    <!-- CSS Files -->
    <link rel="stylesheet" href="css/styles.css">
    <link rel="stylesheet" href="css/chat.css">
    <link rel="stylesheet" href="css/responsive.css">
    
    <!-- ‚úÖ GOOGLE CLIENT ID CONFIGURATION -->
    <meta name="google-client-id" 
          content="166511615962-bohur5q8d4i5hud6icr4185kcte9enk8.apps.googleusercontent.com">
    
    <!-- ‚úÖ SIMPLE FAVICON FIX -->
    <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>‚öñÔ∏è</text></svg>">
    
    <style>
        /* ‚úÖ FIXED MODAL STYLES */
        #loginModal {
            position: fixed !important;
            top: 0 !important;
            left: 0 !important;
            width: 100% !important;
            height: 100% !important;
            background: rgba(0, 0, 0, 0.85) !important;
            display: none !important;
            justify-content: center !important;
            align-items: center !important;
            z-index: 99999 !important;
            padding: 20px !important;
            opacity: 0 !important;
            transition: opacity 0.3s ease !important;
        }
        
        #loginModal.active {
            display: flex !important;
            opacity: 1 !important;
        }
        
        .modal-content {
            background: white !important;
            border-radius: 20px !important;
            width: 100% !important;
            max-width: 450px !important;
            overflow: hidden !important;
            box-shadow: 0 20px 60px rgba(0,0,0,0.5) !important;
            animation: modalAppear 0.4s ease forwards !important;
        }
        
        @keyframes modalAppear {
            from {
                transform: translateY(-30px) !important;
                opacity: 0 !important;
            }
            to {
                transform: translateY(0) !important;
                opacity: 1 !important;
            }
        }
        
        .modal-header {
            padding: 24px !important;
            background: linear-gradient(135deg, #2563eb, #7c3aed) !important;
            color: white !important;
            display: flex !important;
            justify-content: space-between !important;
            align-items: center !important;
        }
        
        .modal-header h3 {
            margin: 0 !important;
            font-size: 24px !important;
        }
        
        .btn-icon {
            background: transparent !important;
            border: none !important;
            color: white !important;
            font-size: 20px !important;
            cursor: pointer !important;
            padding: 8px !important;
            border-radius: 8px !important;
            transition: all 0.3s !important;
        }
        
        .btn-icon:hover {
            background: rgba(255,255,255,0.2) !important;
        }
        
        .modal-body {
            padding: 32px !important;
            text-align: center !important;
        }
        
        .login-illustration {
            font-size: 60px !important;
            color: #2563eb !important;
            margin-bottom: 20px !important;
        }
        
        .modal-body h4 {
            font-size: 20px !important;
            margin-bottom: 8px !important;
            color: #1e293b !important;
        }
        
        .modal-body p {
            color: #64748b !important;
            margin-bottom: 24px !important;
            font-size: 15px !important;
        }
        
        /* Google Sign-In Button Styles */
        .google-signin-btn {
            display: flex !important;
            align-items: center !important;
            justify-content: center !important;
            gap: 12px !important;
            width: 100% !important;
            padding: 14px !important;
            background: white !important;
            border: 2px solid #e2e8f0 !important;
            border-radius: 12px !important;
            color: #334155 !important;
            font-weight: 600 !important;
            font-size: 16px !important;
            cursor: pointer !important;
            transition: all 0.3s !important;
            margin: 24px 0 !important;
        }
        
        .google-signin-btn:hover {
            background: #f8fafc !important;
            border-color: #ea4335 !important;
            transform: translateY(-2px) !important;
            box-shadow: 0 4px 12px rgba(0,0,0,0.1) !important;
        }
        
        .google-signin-btn i {
            font-size: 18px !important;
            color: #ea4335 !important;
        }
        
        /* Demo Button Styles */
        .demo-login-btn {
            display: flex !important;
            align-items: center !important;
            justify-content: center !important;
            gap: 12px !important;
            width: 100% !important;
            padding: 14px !important;
            background: linear-gradient(135deg, #7c3aed, #2563eb) !important;
            border: none !important;
            border-radius: 12px !important;
            color: white !important;
            font-weight: 600 !important;
            font-size: 16px !important;
            cursor: pointer !important;
            transition: all 0.3s !important;
            margin: 12px 0 !important;
        }
        
        .demo-login-btn:hover {
            opacity: 0.9 !important;
            transform: translateY(-2px) !important;
            box-shadow: 0 4px 12px rgba(0,0,0,0.2) !important;
        }
        
        .login-info {
            margin-top: 24px !important;
            padding-top: 20px !important;
            border-top: 1px solid #e2e8f0 !important;
            text-align: left !important;
        }
        
        .login-info p {
            display: flex !important;
            align-items: center !important;
            gap: 10px !important;
            margin: 8px 0 !important;
            color: #64748b !important;
            font-size: 14px !important;
        }
        
        .login-info i {
            color: #10b981 !important;
        }
        
        /* Header Login Button */
        .btn-login {
            display: flex !important;
            align-items: center !important;
            gap: 8px !important;
            padding: 10px 20px !important;
            background: white !important;
            border: 2px solid #2563eb !important;
            border-radius: 8px !important;
            color: #2563eb !important;
            font-weight: 600 !important;
            font-size: 14px !important;
            cursor: pointer !important;
            transition: all 0.3s !important;
        }
        
        .btn-login:hover {
            background: #2563eb !important;
            color: white !important;
            transform: translateY(-2px) !important;
            box-shadow: 0 4px 12px rgba(37, 99, 235, 0.2) !important;
        }
        
        /* User Profile Styles */
        .user-profile {
            display: flex !important;
            align-items: center !important;
            gap: 12px !important;
            padding: 8px 16px !important;
            background: rgba(255,255,255,0.9) !important;
            border-radius: 12px !important;
            border: 2px solid #e2e8f0 !important;
        }
        
        .user-avatar {
            width: 40px !important;
            height: 40px !important;
            background: linear-gradient(135deg, #2563eb, #7c3aed) !important;
            border-radius: 8px !important;
            display: flex !important;
            align-items: center !important;
            justify-content: center !important;
            color: white !important;
            font-size: 18px !important;
        }
        
        .user-info {
            display: flex !important;
            flex-direction: column !important;
        }
        
        .user-name {
            font-weight: 600 !important;
            color: #1e293b !important;
            font-size: 14px !important;
        }
        
        .user-email {
            font-size: 12px !important;
            color: #64748b !important;
        }
        
        .btn-logout {
            background: transparent !important;
            border: none !important;
            color: #64748b !important;
            font-size: 16px !important;
            cursor: pointer !important;
            padding: 8px !important;
            border-radius: 6px !important;
            transition: all 0.3s !important;
        }
        
        .btn-logout:hover {
            background: #f8fafc !important;
            color: #ef4444 !important;
        }
        
        /* Loading Screen */
        .loading-screen {
            position: fixed !important;
            top: 0 !important;
            left: 0 !important;
            width: 100% !important;
            height: 100% !important;
            background: var(--primary-color) !important;
            display: flex !important;
            justify-content: center !important;
            align-items: center !important;
            z-index: 99999 !important;
        }
        
        /* Toast Styles */
        .toast-container {
            position: fixed !important;
            top: 20px !important;
            right: 20px !important;
            z-index: 100000 !important;
        }
        
        /* Force show modal during testing */
        .force-show-modal {
            position: fixed !important;
            top: 0 !important;
            left: 0 !important;
            width: 100% !important;
            height: 100% !important;
            background: rgba(0,0,0,0.8) !important;
            display: flex !important;
            justify-content: center !important;
            align-items: center !important;
            z-index: 999999 !important;
        }
    </style>
</head>
<body>
    <!-- Loading Screen -->
    <div id="loadingScreen" class="loading-screen">
        <div class="loading-content">
            <div class="loading-spinner">
                <i class="fas fa-balance-scale fa-spin"></i>
            </div>
            <h2>Initializing LegalSwami</h2>
            <p>Loading AI legal assistant...</p>
        </div>
    </div>

    <!-- ‚úÖ LOGIN MODAL - FIXED -->
    <div id="loginModal" class="modal" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; z-index: 99999;">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Welcome to LegalSwami</h3>
                <button id="closeLoginModal" class="btn-icon">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            
            <div class="modal-body">
                <div class="login-illustration">
                    <i class="fas fa-balance-scale"></i>
                </div>
                
                <h4>Login to Continue</h4>
                <p>Secure login to access all features</p>
                
                <!-- Google Sign-In Container -->
                <div id="googleSignInContainer" style="width: 100%; margin: 24px 0; min-height: 44px; display: none;">
                    <!-- Google button will be rendered here -->
                </div>
                
                <!-- Custom Google Button -->
                <button id="customGoogleBtn" class="google-signin-btn">
                    <i class="fab fa-google"></i>
                    Sign in with Google
                </button>
                
                <!-- Demo Login Button -->
                <button id="demoLoginBtn" class="demo-login-btn">
                    <i class="fas fa-user"></i> Try Demo Login
                </button>
                
                <div class="login-info">
                    <p><i class="fas fa-lock"></i> Your data is encrypted and secure</p>
                    <p><i class="fas fa-shield-alt"></i> We never share your personal information</p>
                </div>
            </div>
        </div>
    </div>

    <!-- Main Container -->
    <div class="main-container">
        <!-- Header -->
        <header class="main-header">
            <div class="header-container">
                <!-- Logo -->
                <div class="logo-section">
                    <div class="logo">
                        <i class="fas fa-balance-scale"></i>
                        <h1>Legal<span>Swami</span></h1>
                    </div>
                    <p class="tagline">Your AI Legal Assistant</p>
                </div>

                <!-- Navigation -->
                <nav class="nav-links">
                    <a href="#features" class="nav-link">
                        <i class="fas fa-star"></i> Features
                    </a>
                    <a href="#how-it-works" class="nav-link">
                        <i class="fas fa-play-circle"></i> How it Works
                    </a>
                    <a href="#testimonials" class="nav-link">
                        <i class="fas fa-comments"></i> Testimonials
                    </a>
                    <a href="#faq" class="nav-link">
                        <i class="fas fa-question-circle"></i> FAQ
                    </a>
                </nav>

                <!-- User Section -->
                <div class="user-section">
                    <!-- Login Button -->
                    <button id="headerLoginBtn" class="btn-login">
                        <i class="fas fa-sign-in-alt"></i> Login with Google
                    </button>

                    <!-- User Profile -->
                    <div id="userProfile" class="user-profile" style="display: none;">
                        <div class="user-avatar" id="userAvatar">
                            <i class="fas fa-user"></i>
                        </div>
                        <div class="user-info">
                            <span id="userName" class="user-name"></span>
                            <span id="userEmail" class="user-email"></span>
                        </div>
                        <button id="logoutBtn" class="btn-logout" title="Logout">
                            <i class="fas fa-sign-out-alt"></i>
                        </button>
                    </div>
                </div>
            </div>
        </header>

        <!-- Rest of your HTML remains exactly the same... -->
        <!-- Hero Section -->
        <section class="hero-section">
            <div class="hero-content">
                <div class="hero-text">
                    <h1 class="hero-title">
                        Get <span class="highlight">Legal Advice</span> Instantly with AI
                    </h1>
                    <p class="hero-subtitle">
                        LegalSwami is your 24/7 AI legal assistant. Ask legal questions, 
                        generate documents, and get instant guidance on various legal matters.
                    </p>
                    
                    <div class="hero-buttons">
                        <button id="startChatBtn" class="btn-primary">
                            <i class="fas fa-comments"></i> Start Free Chat
                        </button>
                        <button id="learnMoreBtn" class="btn-secondary">
                            <i class="fas fa-play-circle"></i> See Demo
                        </button>
                    </div>

                    <div class="hero-stats">
                        <div class="stat">
                            <i class="fas fa-bolt"></i>
                            <span>Instant Responses</span>
                        </div>
                        <div class="stat">
                            <i class="fas fa-shield-alt"></i>
                            <span>100% Secure</span>
                        </div>
                        <div class="stat">
                            <i class="fas fa-clock"></i>
                            <span>24/7 Available</span>
                        </div>
                    </div>
                </div>

                <div class="hero-image">
                    <div class="ai-illustration">
                        <i class="fas fa-robot"></i>
                        <div class="pulse-effect"></div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Features Section -->
        <section id="features" class="features-section">
            <div class="section-header">
                <h2>Powerful Features</h2>
                <p>Everything you need for your legal queries</p>
            </div>

            <div class="features-grid">
                <div class="feature-card">
                    <div class="feature-icon">
                        <i class="fas fa-comment-dots"></i>
                    </div>
                    <h3>AI Chat Assistant</h3>
                    <p>Ask legal questions in natural language and get instant, accurate responses powered by advanced AI.</p>
                </div>

                <div class="feature-card">
                    <div class="feature-icon">
                        <i class="fas fa-file-contract"></i>
                    </div>
                    <h3>Document Generation</h3>
                    <p>Generate legal documents (PDF, DOC, TXT) instantly with customizable templates.</p>
                </div>

                <div class="feature-card">
                    <div class="feature-icon">
                        <i class="fas fa-history"></i>
                    </div>
                    <h3>Chat History</h3>
                    <p>Access your complete chat history anytime. Never lose important legal conversations.</p>
                </div>

                <div class="feature-card">
                    <div class="feature-icon">
                        <i class="fas fa-shield-alt"></i>
                    </div>
                    <h3>Secure & Private</h3>
                    <p>End-to-end encryption and secure authentication to protect your sensitive legal data.</p>
                </div>

                <div class="feature-card">
                    <div class="feature-icon">
                        <i class="fas fa-mobile-alt"></i>
                    </div>
                    <h3>Mobile Responsive</h3>
                    <p>Access LegalSwami from any device - desktop, tablet, or mobile phone.</p>
                </div>

                <div class="feature-card">
                    <div class="feature-icon">
                        <i class="fas fa-language"></i>
                    </div>
                    <h3>Multi-Language</h3>
                    <p>Get legal advice in multiple languages including Hindi, English, and more.</p>
                </div>
            </div>
        </section>

        <!-- How It Works Section -->
        <section id="how-it-works" class="how-it-works">
            <div class="section-header">
                <h2>How It Works</h2>
                <p>Get started in 3 simple steps</p>
            </div>

            <div class="steps-container">
                <div class="step">
                    <div class="step-number">1</div>
                    <div class="step-content">
                        <h3>Sign In</h3>
                        <p>Login securely with your Google account in one click.</p>
                    </div>
                </div>

                <div class="step">
                    <div class="step-number">2</div>
                    <div class="step-content">
                        <h3>Ask Your Question</h3>
                        <p>Type your legal question in plain English or Hindi.</p>
                    </div>
                </div>

                <div class="step">
                    <div class="step-number">3</div>
                    <div class="step-content">
                        <h3>Get Instant Help</h3>
                        <p>Receive AI-powered legal guidance and generate documents if needed.</p>
                    </div>
                </div>
            </div>
        </section>

        <!-- Chat Interface -->
        <div id="chatInterface" class="chat-interface" style="display: none;">
            <!-- Chat interface code remains the same -->
        </div>

        <!-- Testimonials -->
        <section id="testimonials" class="testimonials-section">
            <div class="section-header">
                <h2>What Users Say</h2>
                <p>Trusted by thousands of users</p>
            </div>

            <div class="testimonials-grid">
                <div class="testimonial-card">
                    <div class="testimonial-content">
                        <p>"LegalSwami helped me draft a rental agreement within minutes. Saved me hundreds of dollars!"</p>
                    </div>
                    <div class="testimonial-author">
                        <div class="author-avatar">
                            <i class="fas fa-user"></i>
                        </div>
                        <div class="author-info">
                            <h4>Rahul Sharma</h4>
                            <span>Small Business Owner</span>
                        </div>
                    </div>
                </div>

                <div class="testimonial-card">
                    <div class="testimonial-content">
                        <p>"As a law student, this is an incredible tool for quick legal research and understanding complex concepts."</p>
                    </div>
                    <div class="testimonial-author">
                        <div class="author-avatar">
                            <i class="fas fa-user"></i>
                        </div>
                        <div class="author-info">
                            <h4>Priya Patel</h4>
                            <span>Law Student</span>
                        </div>
                    </div>
                </div>

                <div class="testimonial-card">
                    <div class="testimonial-content">
                        <p>"The document generation feature is amazing. Got my legal notice ready in 2 minutes!"</p>
                    </div>
                    <div class="testimonial-author">
                        <div class="author-avatar">
                            <i class="fas fa-user"></i>
                        </div>
                        <div class="author-info">
                            <h4>Ankit Verma</h4>
                            <span>Entrepreneur</span>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- FAQ Section -->
        <section id="faq" class="faq-section">
            <div class="section-header">
                <h2>Frequently Asked Questions</h2>
                <p>Get answers to common questions</p>
            </div>

            <div class="faq-container">
                <div class="faq-item">
                    <div class="faq-question">
                        <h4>Is LegalSwami a replacement for a lawyer?</h4>
                        <i class="fas fa-chevron-down"></i>
                    </div>
                    <div class="faq-answer">
                        <p>No, LegalSwami is an AI assistant designed to provide legal information and guidance. For critical legal matters, you should always consult a qualified attorney.</p>
                    </div>
                </div>

                <div class="faq-item">
                    <div class="faq-question">
                        <h4>Is my data secure?</h4>
                        <i class="fas fa-chevron-down"></i>
                    </div>
                    <div class="faq-answer">
                        <p>Yes, we use end-to-end encryption and secure authentication. Your conversations are private and we never share your data with third parties.</p>
                    </div>
                </div>

                <div class="faq-item">
                    <div class="faq-question">
                        <h4>Can I generate legal documents?</h4>
                        <i class="fas fa-chevron-down"></i>
                    </div>
                    <div class="faq-answer">
                        <p>Yes! You can generate various legal documents including agreements, notices, and letters in PDF, DOC, and TXT formats.</p>
                    </div>
                </div>

                <div class="faq-item">
                    <div class="faq-question">
                        <h4>Is there a cost to use LegalSwami?</h4>
                        <i class="fas fa-chevron-down"></i>
                    </div>
                    <div class="faq-answer">
                        <p>Currently, LegalSwami is free to use. We may introduce premium features in the future with clear communication to our users.</p>
                    </div>
                </div>
            </div>
        </section>

        <!-- Footer -->
        <footer class="main-footer">
            <div class="footer-content">
                <div class="footer-section">
                    <div class="footer-logo">
                        <i class="fas fa-balance-scale"></i>
                        <h3>Legal<span>Swami</span></h3>
                    </div>
                    <p>Your AI-powered legal assistant available 24/7.</p>
                    <div class="social-links">
                        <a href="#"><i class="fab fa-twitter"></i></a>
                        <a href="#"><i class="fab fa-linkedin"></i></a>
                        <a href="#"><i class="fab fa-github"></i></a>
                    </div>
                </div>

                <div class="footer-section">
                    <h4>Quick Links</h4>
                    <ul>
                        <li><a href="#features">Features</a></li>
                        <li><a href="#how-it-works">How it Works</a></li>
                        <li><a href="#testimonials">Testimonials</a></li>
                        <li><a href="#faq">FAQ</a></li>
                    </ul>
                </div>

                <div class="footer-section">
                    <h4>Legal</h4>
                    <ul>
                        <li><a href="#" id="termsLink">Terms of Service</a></li>
                        <li><a href="#" id="privacyLink">Privacy Policy</a></li>
                        <li><a href="#" id="disclaimerLink">Legal Disclaimer</a></li>
                    </ul>
                </div>

                <div class="footer-section">
                    <h4>Contact</h4>
                    <ul>
                        <li><i class="fas fa-envelope"></i> support@legalswami.com</li>
                        <li><i class="fas fa-phone"></i> +91 9876543210</li>
                        <li><i class="fas fa-map-marker-alt"></i> India</li>
                    </ul>
                </div>
            </div>

            <div class="footer-bottom">
                <p>&copy; 2024 LegalSwami. All rights reserved.</p>
                <p class="disclaimer">
                    <i class="fas fa-exclamation-triangle"></i>
                    LegalSwami is an AI assistant, not a licensed attorney. Use information at your own discretion.
                </p>
            </div>
        </footer>
    </div>

    <!-- Toast Notifications -->
    <div id="toastContainer" class="toast-container"></div>
    
    <!-- ‚úÖ GOOGLE IDENTITY SERVICES -->
    <script src="https://accounts.google.com/gsi/client" async defer></script>
    
    <!-- JavaScript Files -->
    <script src="js/api.js"></script>
    <script src="js/chat.js"></script>
    <script src="js/utils.js"></script>
    
    <!-- Main App Script -->
    <script>
        // Global variables
        let currentChatId = null;
        let isProcessing = false;
        let googleGISInitialized = false;
        
        // DOM Content Loaded
        document.addEventListener('DOMContentLoaded', function() {
            console.log('üöÄ LegalSwami Frontend Initialized');
            
            // Hide loading screen
            setTimeout(() => {
                document.getElementById('loadingScreen').style.display = 'none';
                console.log('‚úÖ Loading screen hidden');
            }, 1000);
            
            // Initialize backend connection
            initializeAppWithBackend();
            
            // Setup event listeners
            setupEventListeners();
            
            // Initialize Google Authentication
            setTimeout(initializeSimpleGoogleAuth, 1500);
            
            // Check for existing user
            checkExistingUser();
            
            // ‚úÖ TEST MODAL - Show modal for 5 seconds on load (for testing only)
            setTimeout(() => {
                console.log('üß™ Testing modal display...');
                showLoginModal();
                
                // Auto hide after 5 seconds for testing
                setTimeout(() => {
                    if (document.getElementById('loginModal').classList.contains('active')) {
                        hideLoginModal();
                        console.log('‚úÖ Test modal closed');
                    }
                }, 5000);
            }, 2000);
        });
        
        // ‚úÖ FIXED MODAL FUNCTIONS
        function showLoginModal() {
            console.log('üîê Showing login modal...');
            
            const modal = document.getElementById('loginModal');
            
            // Remove any conflicting styles
            modal.style.display = 'flex';
            modal.style.opacity = '0';
            
            // Force reflow
            modal.offsetHeight;
            
            // Add active class for animation
            setTimeout(() => {
                modal.classList.add('active');
                modal.style.opacity = '1';
            }, 10);
            
            // Render Google button
            setTimeout(renderGoogleSignInButton, 100);
            
            console.log('‚úÖ Modal should be visible');
            console.log('Modal display:', modal.style.display);
            console.log('Modal classes:', modal.className);
        }
        
        function hideLoginModal() {
            console.log('üîê Hiding login modal...');
            
            const modal = document.getElementById('loginModal');
            modal.classList.remove('active');
            modal.style.opacity = '0';
            
            setTimeout(() => {
                modal.style.display = 'none';
            }, 300);
        }
        
        // ‚úÖ SIMPLE GOOGLE AUTH
        function initializeSimpleGoogleAuth() {
            console.log('üîê Initializing Google Authentication...');
            
            if (typeof google === 'undefined') {
                console.warn('‚ö†Ô∏è Google Identity Services not loaded yet');
                setTimeout(initializeSimpleGoogleAuth, 1000);
                return;
            }
            
            try {
                google.accounts.id.initialize({
                    client_id: '166511615962-bohur5q8d4i5hud6icr4185kcte9enk8.apps.googleusercontent.com',
                    callback: handleGoogleCredentialResponse,
                    auto_select: false,
                    cancel_on_tap_outside: false,
                    context: 'signin'
                });
                
                googleGISInitialized = true;
                console.log('‚úÖ Google Authentication initialized');
                
            } catch (error) {
                console.error('‚ùå Google Authentication initialization failed:', error);
            }
        }
        
        // ‚úÖ RENDER GOOGLE SIGN-IN BUTTON
        function renderGoogleSignInButton() {
            console.log('üîê Rendering Google Sign-In button...');
            
            const container = document.getElementById('googleSignInContainer');
            const customBtn = document.getElementById('customGoogleBtn');
            
            if (!container || !googleGISInitialized) {
                console.warn('‚ö†Ô∏è Cannot render Google button');
                if (customBtn) customBtn.style.display = 'flex';
                return;
            }
            
            try {
                container.innerHTML = '';
                
                google.accounts.id.renderButton(
                    container,
                    {
                        type: 'standard',
                        theme: 'outline',
                        size: 'large',
                        text: 'signin_with',
                        shape: 'rectangular',
                        logo_alignment: 'left',
                        width: container.offsetWidth
                    }
                );
                
                container.style.display = 'block';
                if (customBtn) customBtn.style.display = 'none';
                
                console.log('‚úÖ Google Sign-In button rendered');
                
            } catch (error) {
                console.error('‚ùå Failed to render Google button:', error);
                if (customBtn) customBtn.style.display = 'flex';
            }
        }
        
        // ‚úÖ HANDLE GOOGLE CREDENTIAL RESPONSE
        function handleGoogleCredentialResponse(response) {
            console.log('üîê Google credential received');
            
            try {
                const payload = JSON.parse(atob(response.credential.split('.')[1]));
                
                const userData = {
                    id: 'google_' + payload.sub,
                    name: payload.name,
                    email: payload.email,
                    picture: payload.picture,
                    provider: 'google',
                    token: response.credential
                };
                
                console.log('‚úÖ Google user authenticated:', userData.email);
                
                localStorage.setItem('legal_swami_user', JSON.stringify(userData));
                localStorage.setItem('legal_swami_token', response.credential);
                
                updateUserUI();
                hideLoginModal();
                showToast('Successfully logged in with Google!', 'success');
                
            } catch (error) {
                console.error('‚ùå Failed to process Google credential:', error);
                showToast('Login failed. Please try again.', 'error');
            }
        }
        
        // ‚úÖ SETUP EVENT LISTENERS
        function setupEventListeners() {
            console.log('üîß Setting up event listeners');
            
            // Header login button
            document.getElementById('headerLoginBtn').addEventListener('click', function(e) {
                e.preventDefault();
                e.stopPropagation();
                console.log('üñ±Ô∏è Header login button clicked');
                showLoginModal();
            });
            
            // Close modal button
            document.getElementById('closeLoginModal').addEventListener('click', hideLoginModal);
            
            // Demo login button
            document.getElementById('demoLoginBtn').addEventListener('click', handleDemoLogin);
            
            // Custom Google button
            document.getElementById('customGoogleBtn').addEventListener('click', handleCustomGoogleLogin);
            
            // Logout button
            document.getElementById('logoutBtn').addEventListener('click', handleLogout);
            
            // Start chat button
            document.getElementById('startChatBtn').addEventListener('click', startChat);
            
            // Close modal when clicking outside
            document.getElementById('loginModal').addEventListener('click', function(e) {
                if (e.target === this) {
                    hideLoginModal();
                }
            });
            
            console.log('‚úÖ All event listeners set up');
        }
        
        // ‚úÖ CHECK FOR EXISTING USER
        function checkExistingUser() {
            console.log('üë§ Checking for existing user...');
            
            const userStr = localStorage.getItem('legal_swami_user');
            if (userStr) {
                try {
                    const user = JSON.parse(userStr);
                    console.log('‚úÖ Found existing user:', user.name);
                    
                    if (window.legalSwamiAPI) {
                        window.legalSwamiAPI.user = user;
                        window.legalSwamiAPI.token = localStorage.getItem('legal_swami_token');
                    }
                    
                    updateUserUI();
                    return;
                } catch (e) {
                    console.error('Error parsing user data:', e);
                    localStorage.removeItem('legal_swami_user');
                    localStorage.removeItem('legal_swami_token');
                }
            }
            
            updateUserUI();
        }
        
        // ‚úÖ UPDATE USER UI
        function updateUserUI() {
            console.log('üë§ Updating user UI...');
            
            const userProfile = document.getElementById('userProfile');
            const headerLoginBtn = document.getElementById('headerLoginBtn');
            
            if (!userProfile || !headerLoginBtn) return;
            
            const userStr = localStorage.getItem('legal_swami_user');
            
            if (userStr) {
                try {
                    const user = JSON.parse(userStr);
                    
                    headerLoginBtn.style.display = 'none';
                    userProfile.style.display = 'flex';
                    
                    document.getElementById('userName').textContent = user.name || 'User';
                    document.getElementById('userEmail').textContent = user.email || '';
                    
                    const avatar = document.getElementById('userAvatar');
                    if (user.picture) {
                        avatar.innerHTML = `<img src="${user.picture}" alt="${user.name}" style="width: 100%; height: 100%; border-radius: 8px; object-fit: cover;">`;
                    }
                    
                } catch (e) {
                    console.error('Error parsing user:', e);
                }
            } else {
                headerLoginBtn.style.display = 'flex';
                userProfile.style.display = 'none';
                
                if (!localStorage.getItem('legalSwamiGuestId')) {
                    localStorage.setItem('legalSwamiGuestId', 'guest_' + Date.now());
                }
            }
        }
        
        // ‚úÖ HANDLE CUSTOM GOOGLE LOGIN
        function handleCustomGoogleLogin() {
            console.log('üîê Custom Google login triggered');
            
            if (!googleGISInitialized) {
                showToast('Google Sign-In is not available. Please use demo login.', 'warning');
                handleDemoLogin();
                return;
            }
            
            try {
                google.accounts.id.prompt();
            } catch (error) {
                console.error('‚ùå Google login failed:', error);
                showToast('Google Sign-In failed. Using demo login.', 'warning');
                handleDemoLogin();
            }
        }
        
        // ‚úÖ HANDLE DEMO LOGIN
        function handleDemoLogin() {
            console.log('üë§ Demo login triggered');
            
            const demoUsers = [
                {
                    id: 'demo_user_1',
                    name: 'Demo User',
                    email: 'demo.user@example.com',
                    role: 'client'
                }
            ];
            
            const randomUser = demoUsers[Math.floor(Math.random() * demoUsers.length)];
            
            const userData = {
                ...randomUser,
                picture: `https://ui-avatars.com/api/?name=${encodeURIComponent(randomUser.name)}&background=7c3aed&color=fff&size=128`,
                provider: 'demo',
                isDemo: true
            };
            
            localStorage.setItem('legal_swami_user', JSON.stringify(userData));
            localStorage.setItem('legal_swami_token', 'demo_token_' + Date.now());
            
            updateUserUI();
            hideLoginModal();
            showToast(`Welcome ${userData.name}! (Demo Mode)`, 'success');
        }
        
        // ‚úÖ HANDLE LOGOUT
        function handleLogout() {
            console.log('üö™ Logging out...');
            
            localStorage.removeItem('legal_swami_token');
            localStorage.removeItem('legal_swami_user');
            
            updateUserUI();
            showToast('Logged out successfully', 'success');
        }
        
        // ‚úÖ INITIALIZE APP WITH BACKEND
        async function initializeAppWithBackend() {
            console.log('üîå Initializing app with backend...');
            
            try {
                const backendUrl = 'https://legal-swami-backend.onrender.com';
                
                if (!window.legalSwamiAPI) {
                    window.legalSwamiAPI = {
                        token: localStorage.getItem('legal_swami_token'),
                        user: null,
                        sendMessage: async function(message, attachments, chatId) {
                            console.log('üì§ Sending message to backend:', message.substring(0, 50));
                            
                            const userId = this.user ? this.user.id : 'guest_' + Date.now();
                            
                            const response = await fetch(`${backendUrl}/api/v1/chat/send`, {
                                method: 'POST',
                                headers: {
                                    'Content-Type': 'application/json',
                                    'x-user-id': userId,
                                    'x-request-id': 'req_' + Date.now()
                                },
                                body: JSON.stringify({
                                    message: message,
                                    generateDocument: document.getElementById('generateDocument').checked
                                })
                            });
                            
                            if (!response.ok) {
                                throw new Error(`HTTP ${response.status}: ${await response.text()}`);
                            }
                            
                            return await response.json();
                        }
                    };
                }
                
                const healthResponse = await fetch(`${backendUrl}/api/v1/public/health`);
                if (healthResponse.ok) {
                    const healthData = await healthResponse.json();
                    console.log('‚úÖ Backend health check passed:', healthData);
                    showToast('Backend connected successfully!', 'success');
                } else {
                    console.warn('‚ö†Ô∏è Backend health check failed:', healthResponse.status);
                }
                
            } catch (error) {
                console.error('‚ùå Initialization failed:', error);
                showToast('Note: Some features may be limited', 'warning');
            }
        }
        
        // ‚úÖ START CHAT
        function startChat() {
            console.log('üí¨ Starting chat...');
            
            const user = window.legalSwamiAPI ? window.legalSwamiAPI.user : null;
            const token = localStorage.getItem('legal_swami_token');
            
            if (!user && !token) {
                showLoginModal();
                showToast('Please login to start chatting', 'warning');
                return;
            }
            
            showToast('Chat feature coming soon!', 'info');
        }
        
        // ‚úÖ SHOW TOAST NOTIFICATION
        function showToast(message, type = 'info') {
            const container = document.getElementById('toastContainer');
            if (!container) return;
            
            const toast = document.createElement('div');
            toast.className = `toast toast-${type}`;
            
            const icons = {
                success: 'fas fa-check-circle',
                error: 'fas fa-exclamation-circle',
                warning: 'fas fa-exclamation-triangle',
                info: 'fas fa-info-circle'
            };
            
            toast.innerHTML = `
                <i class="${icons[type] || icons.info}"></i>
                <span>${message}</span>
            `;
            
            container.appendChild(toast);
            
            setTimeout(() => {
                toast.remove();
            }, 3000);
            
            console.log(`üì¢ Toast: ${message}`);
        }
        
        console.log('‚úÖ LegalSwami App Initialization Complete!');
    </script>
</body>
</html>
