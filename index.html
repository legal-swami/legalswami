<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>LegalSwami | AI-Powered Legal Assistant & Document Generator</title>
    
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800;900&family=Playfair+Display:wght@400;500;600;700&display=swap" rel="stylesheet">
    
    <!-- jsPDF Library -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    
    <!-- Favicon -->
    <link rel="icon" type="image/x-icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>⚖️</text></svg>">
    
    <!-- Theme Color -->
    <meta name="theme-color" content="#0f172a">
    
    <!-- Apple Mobile Web App Capable -->
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    
    <!-- Open Graph / Social Media -->
    <meta property="og:title" content="LegalSwami - AI Legal Assistant">
    <meta property="og:description" content="Get instant legal advice, generate documents, and understand laws with AI">
    
    <!-- Google Client ID -->
    <meta name="google-client-id" 
          content="166511615962-bohur5q8d4i5hud6icr4185kcte9enk8.apps.googleusercontent.com">
    
    <style>
/* ============================================= */
/* LEGALSWAMI - COMPLETE PROFESSIONAL LEGAL UI */
/* ============================================= */

:root {
    /* Courtroom Color Scheme */
    --court-dark-blue: #1a365d;
    --court-blue: #2d3748;
    --court-gold: #d4af37;
    --court-maroon: #8b0000;
    --court-ivory: #fffff0;
    --court-parchment: #f5f5dc;
    --court-mahogany: #420d09;
    
    /* Legal Professional Colors */
    --primary: #1e40af;
    --primary-dark: #1e3a8a;
    --primary-light: #3b82f6;
    --secondary: #7c3aed;
    --accent: #dc2626;
    --success: #059669;
    --warning: #d97706;
    --error: #dc2626;
    --info: #0ea5e9;
    
    /* Dark Mode */
    --dark-bg: #0f172a;
    --dark-surface: #1e293b;
    --dark-surface-light: #334155;
    --dark-border: #475569;
    --dark-text: #f1f5f9;
    --dark-text-secondary: #94a3b8;
    --dark-text-tertiary: #64748b;
    
    /* Light Mode */
    --light-bg: #ffffff;
    --light-surface: #f8fafc;
    --light-surface-light: #f1f5f9;
    --light-border: #e2e8f0;
    --light-text: #1e293b;
    --light-text-secondary: #475569;
    --light-text-tertiary: #64748b;
    
    /* Legal Document Colors */
    --legal-red: #b91c1c;
    --legal-gold: #ca8a04;
    --legal-seal: rgba(212, 175, 55, 0.1);
    --legal-stamp: rgba(139, 0, 0, 0.05);
    --legal-highlight: rgba(255, 215, 0, 0.1);
}

/* ============================================= */
/* RESET & BASE STYLES */
/* ============================================= */

* {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
}

body {
    font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, sans-serif;
    background: var(--dark-bg);
    color: var(--dark-text);
    line-height: 1.6;
    min-height: 100vh;
    overflow-x: hidden;
    transition: background 0.3s ease;
}

body.light-mode {
    background: var(--light-bg);
    color: var(--light-text);
}

/* ============================================= */
/* PREMIUM NAVIGATION - LEGAL STYLE */
/* ============================================= */

.premium-navbar {
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    background: rgba(15, 23, 42, 0.95);
    backdrop-filter: blur(10px);
    border-bottom: 2px solid var(--court-gold);
    z-index: 1000;
    height: 70px;
}

.light-mode .premium-navbar {
    background: rgba(255, 255, 255, 0.95);
    border-bottom-color: var(--court-gold);
}

.nav-container {
    max-width: 1400px;
    margin: 0 auto;
    padding: 0 20px;
    height: 100%;
    display: flex;
    align-items: center;
    justify-content: space-between;
}

.nav-logo {
    display: flex;
    align-items: center;
    gap: 12px;
    text-decoration: none;
}

.logo-icon {
    width: 42px;
    height: 42px;
    background: linear-gradient(135deg, var(--court-gold) 0%, var(--court-maroon) 100%);
    border-radius: 8px;
    display: flex;
    align-items: center;
    justify-content: center;
    color: white;
    font-size: 1.25rem;
    position: relative;
    overflow: hidden;
}

.logo-icon::after {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: radial-gradient(circle at 30% 30%, rgba(255, 255, 255, 0.3) 0%, transparent 70%);
}

.logo-text {
    display: flex;
    flex-direction: column;
}

.logo-title {
    font-family: 'Playfair Display', serif;
    font-size: 1.5rem;
    font-weight: 700;
    background: linear-gradient(135deg, var(--court-gold) 0%, var(--primary-light) 100%);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
}

.logo-subtitle {
    font-size: 0.75rem;
    color: var(--dark-text-secondary);
    letter-spacing: 0.1em;
    text-transform: uppercase;
}

.light-mode .logo-subtitle {
    color: var(--light-text-secondary);
}

.nav-menu {
    display: flex;
    gap: 2rem;
    align-items: center;
}

.nav-link {
    display: flex;
    align-items: center;
    gap: 8px;
    color: var(--dark-text-secondary);
    text-decoration: none;
    font-weight: 500;
    padding: 0.5rem 0;
    position: relative;
    transition: color 0.3s;
    font-size: 0.9375rem;
}

.nav-link i {
    font-size: 1rem;
}

.nav-link:hover {
    color: var(--court-gold);
}

.nav-link.active {
    color: var(--court-gold);
}

.nav-link.active::after {
    content: '';
    position: absolute;
    bottom: -2px;
    left: 0;
    right: 0;
    height: 2px;
    background: var(--court-gold);
    border-radius: 1px;
}

.light-mode .nav-link {
    color: var(--light-text-secondary);
}

.nav-actions {
    display: flex;
    gap: 12px;
    align-items: center;
}

.header-btn {
    background: rgba(255, 255, 255, 0.1);
    color: white;
    border: 1px solid rgba(255, 255, 255, 0.2);
    border-radius: 6px;
    padding: 0.5rem 0.875rem;
    cursor: pointer;
    font-size: 0.875rem;
    font-weight: 500;
    transition: all 0.2s;
    display: flex;
    align-items: center;
    gap: 6px;
    min-height: 36px;
    backdrop-filter: blur(10px);
    text-decoration: none;
}

.header-btn:hover {
    background: rgba(255, 255, 255, 0.2);
    transform: translateY(-1px);
    border-color: var(--court-gold);
}

.header-btn.google-login {
    background: linear-gradient(135deg, #4285F4 0%, #34A853 100%);
    border: none;
}

.header-btn.google-login:hover {
    background: linear-gradient(135deg, #3367D6 0%, #2E8B57 100%);
}

.mobile-toggle {
    display: none;
    background: none;
    border: none;
    color: var(--dark-text);
    font-size: 1.5rem;
    cursor: pointer;
    padding: 0.5rem;
    border-radius: 4px;
    transition: background-color 0.3s;
}

.mobile-toggle:hover {
    background: var(--dark-surface);
}

.light-mode .mobile-toggle {
    color: var(--light-text);
}

.light-mode .mobile-toggle:hover {
    background: var(--light-surface);
}

/* ============================================= */
/* CHAT INTERFACE - PROFESSIONAL LEGAL STYLE */
/* ============================================= */

#chatInterface {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100vh;
    background: var(--dark-bg);
    z-index: 9999;
    display: none;
    flex-direction: column;
    opacity: 0;
    visibility: hidden;
    transition: opacity 0.3s ease, visibility 0.3s;
    overflow: hidden;
}

#chatInterface.active {
    display: flex;
    visibility: visible;
    opacity: 1;
}

#chatInterface .container {
    height: 100vh;
    padding: 0;
    background: var(--dark-bg);
}

#chatInterface .chat-container {
    display: flex;
    flex-direction: column;
    height: 100vh;
    width: 100%;
    background: var(--dark-bg);
    position: relative;
}

/* Chat Header - Legal Court Style */
#chatInterface header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 0 1rem;
    background: linear-gradient(135deg, var(--court-dark-blue) 0%, var(--court-blue) 100%);
    border-bottom: 3px solid var(--court-gold);
    height: 70px;
    flex-shrink: 0;
    position: relative;
    z-index: 100;
}

#chatInterface header::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    height: 4px;
    background: linear-gradient(90deg, 
        var(--court-gold) 0%, 
        var(--court-maroon) 50%, 
        var(--court-gold) 100%);
}

#chatInterface .logo {
    display: flex;
    align-items: center;
    gap: 12px;
}

#chatInterface .logo-icon {
    width: 36px;
    height: 36px;
    background: linear-gradient(135deg, var(--court-gold) 0%, var(--primary) 100%);
    border-radius: 6px;
    display: flex;
    align-items: center;
    justify-content: center;
    color: white;
    font-size: 1rem;
    position: relative;
    overflow: hidden;
}

#chatInterface .logo-icon::after {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: radial-gradient(circle at 30% 30%, rgba(255, 255, 255, 0.3) 0%, transparent 70%);
}

#chatInterface .logo h1 {
    font-family: 'Playfair Display', serif;
    font-size: 1.25rem;
    font-weight: 600;
    background: linear-gradient(135deg, #fff 0%, var(--court-gold) 100%);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
}

#chatInterface .header-actions {
    display: flex;
    gap: 8px;
    align-items: center;
}

#chatHeaderLoginBtn {
    background: linear-gradient(135deg, #4285F4 0%, #34A853 100%);
}

#chatHeaderLoginBtn:hover {
    background: linear-gradient(135deg, #3367D6 0%, #2E8B57 100%);
}

.status-indicator {
    display: flex;
    align-items: center;
    gap: 8px;
    padding: 0.5rem 0.875rem;
    background: rgba(16, 185, 129, 0.15);
    border: 1px solid rgba(16, 185, 129, 0.3);
    border-radius: 6px;
    font-size: 0.875rem;
    font-weight: 500;
    color: #10b981;
    backdrop-filter: blur(10px);
}

.status-dot {
    width: 8px;
    height: 8px;
    background-color: #10b981;
    border-radius: 50%;
    animation: pulse 2s infinite;
}

@keyframes pulse {
    0%, 100% { 
        opacity: 1; 
        box-shadow: 0 0 0 0 rgba(16, 185, 129, 0.7);
    }
    50% { 
        opacity: 0.7; 
        box-shadow: 0 0 0 8px rgba(16, 185, 129, 0);
    }
}

.theme-toggle {
    background: rgba(255, 255, 255, 0.1);
    border: 1px solid rgba(255, 255, 255, 0.2);
    border-radius: 6px;
    width: 36px;
    height: 36px;
    display: flex;
    align-items: center;
    justify-content: center;
    cursor: pointer;
    transition: all 0.3s;
    backdrop-filter: blur(10px);
}

.theme-toggle:hover {
    transform: rotate(15deg);
    border-color: var(--court-gold);
}

/* Chat Main Content - Courtroom Layout */
#chatInterface .main-content {
    display: flex;
    flex: 1;
    height: calc(100vh - 70px);
    background: var(--dark-surface);
    overflow: hidden;
    position: relative;
}

/* Chat Sidebar - Case File Style */
#chatInterface .sidebar {
    width: 280px;
    background: linear-gradient(180deg, var(--court-dark-blue) 0%, var(--dark-surface) 100%);
    border-right: 2px solid var(--court-gold);
    display: flex;
    flex-direction: column;
    flex-shrink: 0;
    position: relative;
    z-index: 90;
    height: 100%;
    overflow: hidden;
    box-shadow: 4px 0 20px rgba(0, 0, 0, 0.3);
}

#chatInterface .sidebar::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: url("data:image/svg+xml,%3Csvg width='100' height='100' viewBox='0 0 100 100' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M11 18c3.866 0 7-3.134 7-7s-3.134-7-7-7-7 3.134-7 7 3.134 7 7 7zm48 25c3.866 0 7-3.134 7-7s-3.134-7-7-7-7 3.134-7 7 3.134 7 7 7zm-43-7c1.657 0 3-1.343 3-3s-1.343-3-3-3-3 1.343-3 3 1.343 3 3 3zm63 31c1.657 0 3-1.343 3-3s-1.343-3-3-3-3 1.343-3 3 1.343 3 3 3zM34 90c1.657 0 3-1.343 3-3s-1.343-3-3-3-3 1.343-3 3 1.343 3 3 3zm56-76c1.657 0 3-1.343 3-3s-1.343-3-3-3-3 1.343-3 3 1.343 3 3 3zM12 86c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm28-65c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm23-11c2.76 0 5-2.24 5-5s-2.24-5-5-5-5 2.24-5 5 2.24 5 5 5zm-6 60c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm29 22c2.76 0 5-2.24 5-5s-2.24-5-5-5-5 2.24-5 5 2.24 5 5 5zM32 63c2.76 0 5-2.24 5-5s-2.24-5-5-5-5 2.24-5 5 2.24 5 5 5zm57-13c2.76 0 5-2.24 5-5s-2.24-5-5-5-5 2.24-5 5 2.24 5 5 5zm-9-21c1.105 0 2-.895 2-2s-.895-2-2-2-2 .895-2 2 .895 2 2 2zM60 91c1.105 0 2-.895 2-2s-.895-2-2-2-2 .895-2 2 .895 2 2 2zM35 41c1.105 0 2-.895 2-2s-.895-2-2-2-2 .895-2 2 .895 2 2 2zM12 60c1.105 0 2-.895 2-2s-.895-2-2-2-2 .895-2 2 .895 2 2 2z' fill='%23d4af37' fill-opacity='0.03' fill-rule='evenodd'/%3E%3C/svg%3E");
    opacity: 0.3;
    pointer-events: none;
}

#chatInterface .sidebar-tabs {
    display: flex;
    border-bottom: 2px solid var(--court-gold);
    background: var(--court-dark-blue);
    height: 55px;
    flex-shrink: 0;
}

.sidebar-tab {
    flex: 1;
    padding: 1rem 0.5rem;
    background: transparent;
    border: none;
    color: var(--dark-text-secondary);
    font-size: 0.875rem;
    font-weight: 500;
    cursor: pointer;
    transition: all 0.3s;
    text-align: center;
    position: relative;
    overflow: hidden;
}

.sidebar-tab::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    height: 2px;
    background: var(--court-gold);
    transform: translateY(-100%);
    transition: transform 0.3s;
}

.sidebar-tab:hover {
    color: var(--court-gold);
    background: rgba(212, 175, 55, 0.1);
}

.sidebar-tab.active {
    color: var(--court-gold);
    background: rgba(212, 175, 55, 0.15);
}

.sidebar-tab.active::before {
    transform: translateY(0);
}

.tab-content {
    flex: 1;
    overflow-y: auto;
    display: none;
    height: calc(100% - 55px);
    padding: 0 !important; /* FIX: Remove padding to fix scrollbar */
}

.tab-content.active {
    display: flex;
    flex-direction: column;
}

/* FIXED: Chat Messages Area with proper scrollbar */
#chatInterface .chat-messages {
    flex: 1;
    overflow-y: auto;
    padding: 1.5rem;
    display: flex;
    flex-direction: column;
    gap: 1.5rem;
    background: var(--dark-surface);
    position: relative;
    z-index: 10;
    min-height: 0;
    height: calc(100% - 140px); /* Adjust for input area height */
}

#chatMessages {
    flex: 1;
    overflow-y: auto;
    display: flex;
    flex-direction: column;
    gap: 1.5rem;
    padding-bottom: 1rem;
    max-height: 100%;
    padding-right: 10px; /* Add space for scrollbar */
}

/* FIXED: Proper scrollbar for chat - visible from start */
#chatMessages::-webkit-scrollbar {
    width: 8px;
}

#chatMessages::-webkit-scrollbar-track {
    background: rgba(212, 175, 55, 0.1);
    border-radius: 4px;
    margin: 5px 0;
}

#chatMessages::-webkit-scrollbar-thumb {
    background: var(--court-gold);
    border-radius: 4px;
    border: 2px solid rgba(212, 175, 55, 0.1);
}

#chatMessages::-webkit-scrollbar-thumb:hover {
    background: var(--court-maroon);
}

/* Message styles */
.message {
    display: flex;
    gap: 1rem;
    max-width: 100%;
    padding: 1.25rem;
    animation: fadeIn 0.4s ease;
    border-radius: 12px;
    position: relative;
    backdrop-filter: blur(10px);
}

@keyframes fadeIn {
    from { 
        opacity: 0; 
        transform: translateY(20px); 
    }
    to { 
        opacity: 1; 
        transform: translateY(0); 
    }
}

.user-message {
    background: linear-gradient(135deg, rgba(30, 64, 175, 0.15) 0%, rgba(30, 64, 175, 0.3) 100%);
    border: 1px solid rgba(30, 64, 175, 0.3);
    margin-left: 3rem;
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
}

.ai-message {
    background: linear-gradient(135deg, rgba(30, 41, 59, 0.15) 0%, rgba(30, 41, 59, 0.3) 100%);
    border: 1px solid rgba(212, 175, 55, 0.2);
    margin-right: 3rem;
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
}

.ai-message::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    width: 4px;
    height: 100%;
    background: linear-gradient(180deg, var(--court-gold) 0%, var(--court-maroon) 100%);
    border-radius: 12px 0 0 12px;
}

.avatar {
    width: 40px;
    height: 40px;
    border-radius: 8px;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 1rem;
    flex-shrink: 0;
    margin-top: 4px;
    position: relative;
    overflow: hidden;
}

.user-message .avatar {
    background: linear-gradient(135deg, var(--primary) 0%, var(--primary-dark) 100%);
    box-shadow: 0 4px 12px rgba(30, 64, 175, 0.3);
}

.ai-message .avatar {
    background: linear-gradient(135deg, var(--court-gold) 0%, var(--court-maroon) 100%);
    box-shadow: 0 4px 12px rgba(212, 175, 55, 0.3);
}

.avatar::after {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: radial-gradient(circle at 30% 30%, rgba(255, 255, 255, 0.4) 0%, transparent 70%);
}

.message-content {
    flex: 1;
    position: relative;
    min-width: 0;
}

.message-text {
    padding: 0;
    border-radius: 0;
    font-size: 0.9375rem;
    line-height: 1.7;
    word-wrap: break-word;
    overflow-wrap: break-word;
    color: var(--dark-text);
}

.user-message .message-text {
    color: var(--dark-text);
}

.ai-message .message-text {
    color: var(--dark-text);
}

.ai-message .message-text strong {
    color: var(--court-gold);
}

/* Welcome Message */
.welcome-message {
    text-align: center;
    max-width: 700px;
    margin: 2rem auto;
    padding: 2rem;
    background: linear-gradient(135deg, rgba(30, 64, 175, 0.1) 0%, rgba(212, 175, 55, 0.1) 100%);
    border: 2px solid var(--court-gold);
    border-radius: 16px;
    position: relative;
    overflow: hidden;
    box-shadow: 0 8px 32px rgba(0, 0, 0, 0.2);
}

.welcome-message::before {
    content: '⚖️';
    position: absolute;
    top: -20px;
    left: 50%;
    transform: translateX(-50%);
    font-size: 4rem;
    opacity: 0.1;
}

.welcome-message h2 {
    font-family: 'Playfair Display', serif;
    font-size: 2rem;
    margin-bottom: 1rem;
    color: var(--court-gold);
    position: relative;
}

.welcome-message p {
    margin-bottom: 1rem;
    color: var(--dark-text-secondary);
    font-size: 1rem;
    line-height: 1.6;
}

.welcome-message .legal-notice {
    background: rgba(212, 175, 55, 0.1);
    border: 1px solid var(--court-gold);
    border-radius: 8px;
    padding: 1rem;
    margin: 1.5rem 0;
    text-align: left;
}

.welcome-message .legal-notice h4 {
    color: var(--court-gold);
    margin-bottom: 0.5rem;
    display: flex;
    align-items: center;
    gap: 8px;
}

.draft-templates {
    display: grid;
    grid-template-columns: repeat(2, 1fr);
    gap: 1rem;
    margin-top: 2rem;
}

.draft-template {
    background: linear-gradient(135deg, var(--dark-surface) 0%, rgba(30, 64, 175, 0.1) 100%);
    padding: 1.25rem;
    border-radius: 12px;
    cursor: pointer;
    transition: all 0.3s;
    border: 1px solid var(--dark-border);
    text-align: left;
    position: relative;
    overflow: hidden;
}

.draft-template:hover {
    background: linear-gradient(135deg, var(--dark-surface-light) 0%, rgba(30, 64, 175, 0.2) 100%);
    transform: translateY(-3px);
    border-color: var(--court-gold);
    box-shadow: 0 8px 24px rgba(0, 0, 0, 0.2);
}

.draft-template i {
    font-size: 1.5rem;
    color: var(--court-gold);
    margin-bottom: 0.75rem;
}

.draft-template h4 {
    font-size: 1rem;
    margin-bottom: 0.5rem;
    color: var(--dark-text);
}

.draft-template p {
    font-size: 0.8125rem;
    color: var(--dark-text-secondary);
    margin: 0;
}

.welcome-features {
    display: grid;
    grid-template-columns: repeat(3, 1fr);
    gap: 1.5rem;
    margin-top: 2rem;
}

.welcome-features .feature {
    text-align: center;
    padding: 1.5rem;
    background: var(--dark-surface);
    border-radius: 12px;
    border: 1px solid var(--dark-border);
    transition: all 0.3s;
}

.welcome-features .feature:hover {
    transform: translateY(-3px);
    border-color: var(--court-gold);
    box-shadow: 0 8px 24px rgba(0, 0, 0, 0.1);
}

.welcome-features .feature i {
    font-size: 2rem;
    color: var(--court-gold);
    margin-bottom: 1rem;
}

.welcome-features .feature h4 {
    font-size: 1rem;
    margin-bottom: 0.5rem;
    color: var(--dark-text);
}

.welcome-features .feature p {
    font-size: 0.8125rem;
    color: var(--dark-text-secondary);
    margin: 0;
    line-height: 1.5;
}

/* Chat Input Area - Legal Pad Style */
.input-container {
    padding: 1rem;
    background: linear-gradient(180deg, var(--dark-surface) 0%, var(--dark-bg) 100%);
    border-top: 2px solid var(--court-gold);
    flex-shrink: 0;
    position: relative;
    z-index: 100;
    box-shadow: 0 -4px 20px rgba(0, 0, 0, 0.2);
    height: 140px; /* Fixed height for input area */
}

.input-area {
    max-width: 800px;
    margin: 0 auto;
    position: relative;
    width: 100%;
}

.input-area textarea {
    width: 100%;
    padding: 1rem 7rem 1rem 1.25rem;
    background: linear-gradient(135deg, var(--court-parchment) 0%, var(--dark-surface) 100%);
    border: 2px solid var(--court-gold);
    border-radius: 12px;
    color: var(--dark-text) !important;
    font-size: 0.9375rem;
    resize: none;
    min-height: 56px;
    max-height: 100px;
    transition: all 0.3s;
    line-height: 1.5;
    font-family: inherit;
    outline: none;
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
    opacity: 1 !important;
    visibility: visible !important;
}

.input-area textarea:focus {
    border-color: var(--primary-light);
    box-shadow: 0 0 0 3px rgba(30, 64, 175, 0.3);
    background: linear-gradient(135deg, var(--court-parchment) 0%, var(--dark-surface-light) 100%);
}

.input-buttons {
    position: absolute;
    right: 12px;
    top: 50%;
    transform: translateY(-50%);
    display: flex;
    gap: 8px;
}

.emoji-picker-btn,
.attachment-btn,
.input-microphone-btn,
.send-button {
    background: rgba(30, 64, 175, 0.1);
    border: 1px solid rgba(30, 64, 175, 0.3);
    color: var(--dark-text);
    cursor: pointer;
    padding: 8px;
    border-radius: 8px;
    transition: all 0.3s;
    display: flex;
    align-items: center;
    justify-content: center;
    backdrop-filter: blur(10px);
}

.emoji-picker-btn:hover,
.attachment-btn:hover,
.input-microphone-btn:hover {
    background: rgba(30, 64, 175, 0.2);
    border-color: var(--court-gold);
    transform: translateY(-1px);
}

.send-button {
    background: linear-gradient(135deg, var(--court-gold) 0%, var(--court-maroon) 100%);
    color: white;
    padding: 8px 20px;
    font-weight: 600;
    border: none;
    box-shadow: 0 4px 12px rgba(212, 175, 55, 0.3);
}

.send-button:hover:not(:disabled) {
    transform: translateY(-2px);
    box-shadow: 0 6px 20px rgba(212, 175, 55, 0.4);
}

.send-button:disabled {
    background: var(--dark-border);
    cursor: not-allowed;
    opacity: 0.5;
    transform: none !important;
    box-shadow: none !important;
}

/* Light Mode Adjustments */
.light-mode #chatInterface {
    background: var(--light-bg);
}

.light-mode #chatInterface .container {
    background: var(--light-bg);
}

.light-mode #chatInterface .chat-container {
    background: var(--light-bg);
}

.light-mode #chatInterface header {
    background: linear-gradient(135deg, #2d3748 0%, #4a5568 100%);
}

.light-mode .user-message {
    background: linear-gradient(135deg, rgba(30, 64, 175, 0.08) 0%, rgba(30, 64, 175, 0.15) 100%);
    border-color: rgba(30, 64, 175, 0.2);
}

.light-mode .ai-message {
    background: linear-gradient(135deg, rgba(212, 175, 55, 0.08) 0%, rgba(212, 175, 55, 0.15) 100%);
    border-color: rgba(212, 175, 55, 0.2);
}

.light-mode .welcome-message {
    background: linear-gradient(135deg, rgba(30, 64, 175, 0.05) 0%, rgba(212, 175, 55, 0.05) 100%);
}

.light-mode .draft-template {
    background: linear-gradient(135deg, var(--light-surface) 0%, rgba(30, 64, 175, 0.05) 100%);
    border-color: var(--light-border);
}

.light-mode .draft-template:hover {
    background: linear-gradient(135deg, var(--light-surface-light) 0%, rgba(30, 64, 175, 0.1) 100%);
}

.light-mode .welcome-features .feature {
    background: var(--light-surface);
    border-color: var(--light-border);
}

.light-mode .input-area textarea {
    background: linear-gradient(135deg, var(--court-parchment) 0%, var(--light-surface) 100%);
    color: var(--light-text) !important;
}

/* ============================================= */
/* MODALS & OVERLAYS */
/* ============================================= */

.modal-overlay {
    display: none;
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: rgba(0, 0, 0, 0.8);
    z-index: 2000;
    align-items: center;
    justify-content: center;
    padding: 20px;
    backdrop-filter: blur(10px);
}

.modal-overlay.active {
    display: flex;
}

.modal {
    background: linear-gradient(135deg, var(--dark-surface) 0%, var(--court-dark-blue) 100%);
    border-radius: 20px;
    padding: 2.5rem;
    max-width: 500px;
    width: 100%;
    border: 2px solid var(--court-gold);
    max-height: 90vh;
    overflow-y: auto;
    box-shadow: 0 20px 60px rgba(0, 0, 0, 0.5);
    position: relative;
    overflow: hidden;
}

.modal::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    height: 4px;
    background: linear-gradient(90deg, var(--court-gold) 0%, var(--court-maroon) 100%);
}

.modal-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 2rem;
    padding-bottom: 1.5rem;
    border-bottom: 1px solid rgba(255, 255, 255, 0.1);
}

.modal-header h2 {
    font-family: 'Playfair Display', serif;
    font-size: 1.75rem;
    color: var(--court-gold);
    display: flex;
    align-items: center;
    gap: 12px;
}

.modal-close {
    background: rgba(255, 255, 255, 0.1);
    border: 1px solid rgba(255, 255, 255, 0.2);
    color: var(--dark-text);
    font-size: 1.5rem;
    cursor: pointer;
    padding: 0.5rem;
    border-radius: 8px;
    transition: all 0.3s;
    display: flex;
    align-items: center;
    justify-content: center;
    width: 44px;
    height: 44px;
}

.modal-close:hover {
    background: rgba(255, 255, 255, 0.2);
    border-color: var(--court-gold);
    transform: rotate(90deg);
}

.download-options {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
    gap: 1.25rem;
    margin-top: 2rem;
}

.download-option {
    background: linear-gradient(135deg, rgba(30, 64, 175, 0.1) 0%, transparent 100%);
    border-radius: 16px;
    padding: 2rem;
    text-align: center;
    cursor: pointer;
    transition: all 0.4s;
    border: 1px solid rgba(30, 64, 175, 0.2);
    position: relative;
    overflow: hidden;
}

.download-option:hover {
    transform: translateY(-5px);
    box-shadow: 0 15px 35px rgba(0, 0, 0, 0.3);
    border-color: var(--court-gold);
}

.download-option i {
    font-size: 3rem;
    margin-bottom: 1rem;
    color: var(--court-gold);
}

.download-option h3 {
    font-size: 1.125rem;
    margin-bottom: 0.5rem;
    color: var(--dark-text);
}

.download-option p {
    color: var(--dark-text-secondary);
    font-size: 0.875rem;
    margin: 0;
}

/* Login Modal Styles */
.login-content {
    text-align: center;
}

.login-content p {
    margin-bottom: 2rem;
    color: var(--dark-text-secondary);
    line-height: 1.6;
}

.google-signin-btn {
    width: 100%;
    padding: 0.75rem;
    background: linear-gradient(135deg, #4285F4 0%, #34A853 100%);
    color: white;
    border: none;
    border-radius: 12px;
    font-size: 1rem;
    font-weight: 600;
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 10px;
    transition: all 0.3s;
    margin-bottom: 1.5rem;
}

.google-signin-btn:hover {
    background: linear-gradient(135deg, #3367D6 0%, #2E8B57 100%);
    transform: translateY(-2px);
    box-shadow: 0 8px 25px rgba(66, 133, 244, 0.3);
}

.demo-login-btn {
    width: 100%;
    padding: 0.75rem;
    background: linear-gradient(135deg, var(--court-gold) 0%, var(--court-maroon) 100%);
    color: white;
    border: none;
    border-radius: 12px;
    font-size: 1rem;
    font-weight: 600;
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 10px;
    transition: all 0.3s;
}

.demo-login-btn:hover {
    transform: translateY(-2px);
    box-shadow: 0 8px 25px rgba(212, 175, 55, 0.3);
}

.login-divider {
    display: flex;
    align-items: center;
    margin: 1.5rem 0;
    color: var(--dark-text-secondary);
    font-size: 0.875rem;
}

.login-divider::before,
.login-divider::after {
    content: '';
    flex: 1;
    height: 1px;
    background: rgba(255, 255, 255, 0.1);
}

.login-divider span {
    padding: 0 1rem;
}

/* ============================================= */
/* MESSAGE ACTIONS - LEGAL TOOLS */
/* ============================================= */

.message-actions {
    display: flex;
    gap: 0.75rem;
    margin-top: 1rem;
    flex-wrap: wrap;
}

.action-btn {
    background: linear-gradient(135deg, rgba(30, 64, 175, 0.1) 0%, transparent 100%);
    color: var(--dark-text-secondary);
    border: 1px solid rgba(30, 64, 175, 0.2);
    border-radius: 8px;
    padding: 0.5rem 0.875rem;
    cursor: pointer;
    font-size: 0.8125rem;
    transition: all 0.3s;
    display: flex;
    align-items: center;
    gap: 6px;
    min-height: 36px;
    font-weight: 500;
    backdrop-filter: blur(10px);
}

.action-btn:hover {
    background: linear-gradient(135deg, rgba(30, 64, 175, 0.2) 0%, transparent 100%);
    border-color: var(--court-gold);
    transform: translateY(-1px);
}

.action-btn.copy:hover {
    background: linear-gradient(135deg, rgba(30, 64, 175, 0.3) 0%, rgba(30, 64, 175, 0.6) 100%);
    color: white;
}

.action-btn.like:hover {
    background: linear-gradient(135deg, rgba(5, 150, 105, 0.3) 0%, rgba(5, 150, 105, 0.6) 100%);
    color: white;
}

.action-btn.save:hover {
    background: linear-gradient(135deg, rgba(212, 175, 55, 0.3) 0%, rgba(212, 175, 55, 0.6) 100%);
    color: white;
}

/* ============================================= */
/* SCROLL TO BOTTOM BUTTON */
/* ============================================= */

.scroll-to-bottom-btn {
    position: absolute;
    bottom: 160px;
    right: 30px;
    width: 44px;
    height: 44px;
    background: linear-gradient(135deg, var(--court-gold) 0%, var(--court-maroon) 100%);
    border: 2px solid var(--court-gold);
    border-radius: 50%;
    color: white;
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    transition: all 0.3s;
    z-index: 900;
    box-shadow: 0 6px 20px rgba(0, 0, 0, 0.3);
    opacity: 0;
    transform: translateY(20px) scale(0.9);
    backdrop-filter: blur(10px);
}

.scroll-to-bottom-btn.visible {
    opacity: 1;
    transform: translateY(0) scale(1);
}

.scroll-to-bottom-btn:hover {
    transform: translateY(-2px) scale(1.05);
    box-shadow: 0 8px 25px rgba(0, 0, 0, 0.4);
}

/* ============================================= */
/* RESPONSIVE DESIGN */
/* ============================================= */

@media (max-width: 992px) {
    .nav-menu {
        display: none;
    }
    
    .mobile-toggle {
        display: block;
    }
    
    /* Mobile sidebar */
    #chatInterface .sidebar {
        position: fixed;
        top: 0;
        left: 0;
        bottom: 0;
        width: 85vw;
        max-width: 300px;
        z-index: 100;
        transform: translateX(-100%);
        transition: transform 0.4s cubic-bezier(0.4, 0, 0.2, 1);
        box-shadow: 10px 0 50px rgba(0, 0, 0, 0.5);
    }
    
    #chatInterface .sidebar.active {
        transform: translateX(0);
    }
    
    .sidebar-toggle {
        display: flex;
    }
    
    .hide-on-mobile {
        display: none !important;
    }
    
    #chatInterface .chat-messages {
        height: calc(100% - 160px); /* Adjust for mobile input area */
    }
}

@media (max-width: 768px) {
    .draft-templates {
        grid-template-columns: 1fr;
    }
    
    .welcome-features {
        grid-template-columns: 1fr;
    }
    
    .scroll-to-bottom-btn {
        bottom: 170px;
        right: 20px;
    }
}

/* ============================================= */
/* UTILITY CLASSES */
/* ============================================= */

.hide-on-mobile {
    display: none;
}

@media (min-width: 993px) {
    .hide-on-mobile {
        display: flex;
    }
    
    .show-on-mobile {
        display: none;
    }
}

/* Scrollbar Styling */
::-webkit-scrollbar {
    width: 10px;
    height: 10px;
}

::-webkit-scrollbar-track {
    background: var(--dark-bg);
    border-radius: 5px;
}

::-webkit-scrollbar-thumb {
    background: linear-gradient(135deg, var(--court-gold) 0%, var(--court-maroon) 100%);
    border-radius: 5px;
    border: 2px solid var(--dark-bg);
}

::-webkit-scrollbar-thumb:hover {
    background: linear-gradient(135deg, var(--court-maroon) 0%, var(--court-gold) 100%);
}

.light-mode ::-webkit-scrollbar-track {
    background: var(--light-bg);
}

.light-mode ::-webkit-scrollbar-thumb {
    border-color: var(--light-bg);
}

/* Toast Notifications */
.toast {
    position: fixed;
    bottom: 20px;
    right: 20px;
    background: linear-gradient(135deg, var(--dark-surface) 0%, var(--court-dark-blue) 100%);
    color: var(--dark-text);
    padding: 1rem 1.25rem;
    border-radius: 12px;
    border: 1px solid var(--court-gold);
    box-shadow: 0 10px 30px rgba(0, 0, 0, 0.4);
    display: flex;
    align-items: center;
    gap: 12px;
    transform: translateY(100px);
    opacity: 0;
    transition: all 0.4s cubic-bezier(0.68, -0.55, 0.265, 1.55);
    z-index: 1000;
    max-width: 350px;
    backdrop-filter: blur(10px);
}

.toast.show {
    transform: translateY(0);
    opacity: 1;
}

.toast.success i {
    color: var(--success);
}

.toast.error i {
    color: var(--error);
}

.toast.warning i {
    color: var(--warning);
}

.toast.info i {
    color: var(--info);
}

/* Typing animation */
.typing-dots {
    display: inline-flex;
    align-items: center;
    height: 17px;
}
.typing-dots span {
    width: 8px;
    height: 8px;
    margin: 0 2px;
    background: var(--court-gold);
    border-radius: 50%;
    display: block;
    opacity: 0.4;
}
.typing-dots span:nth-child(1) {
    animation: typing-dot 1.5s infinite;
}
.typing-dots span:nth-child(2) {
    animation: typing-dot 1.5s infinite 0.2s;
}
.typing-dots span:nth-child(3) {
    animation: typing-dot 1.5s infinite 0.4s;
}
@keyframes typing-dot {
    0%, 60%, 100% { opacity: 0.4; transform: scale(0.8); }
    30% { opacity: 1; transform: scale(1); }
}
    </style>
</head>
<body>
    <!-- Premium Loading Screen -->
    <div id="loadingScreen" class="loading-screen">
        <div class="loading-content">
            <div class="loading-spinner">
                <i class="fas fa-gavel"></i>
            </div>
            <h2 class="legal-heading" style="background: linear-gradient(135deg, var(--court-gold) 0%, var(--court-maroon) 100%); -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text; margin-bottom: 1rem;">LegalSwami</h2>
            <p class="legal-caption">Initializing AI Legal Assistant...</p>
            <div class="progress-bar">
                <div class="progress-fill"></div>
            </div>
        </div>
    </div>

    <!-- Main Container -->
    <div class="main-container">
        <!-- Premium Navigation Bar -->
        <nav class="premium-navbar">
            <div class="nav-container">
                <!-- Logo -->
                <a href="#home" class="nav-logo">
                    <div class="logo-icon">
                        <i class="fas fa-gavel"></i>
                    </div>
                    <div class="logo-text">
                        <h1 class="logo-title">LegalSwami</h1>
                        <p class="logo-subtitle">AI Legal Assistant</p>
                    </div>
                </a>

                <!-- Desktop Navigation -->
                <div class="nav-menu">
                    <a href="#home" class="nav-link active">
                        <i class="fas fa-home"></i>
                        <span>Home</span>
                    </a>
                    <a href="#features" class="nav-link">
                        <i class="fas fa-star"></i>
                        <span>Features</span>
                    </a>
                    <a href="#documents" class="nav-link">
                        <i class="fas fa-file-contract"></i>
                        <span>Documents</span>
                    </a>
                    <a href="#legalDatabase" class="nav-link">
                        <i class="fas fa-database"></i>
                        <span>Legal Database</span>
                    </a>
                    <a href="#lawyerDirectory" class="nav-link">
                        <i class="fas fa-user-tie"></i>
                        <span>Find Lawyers</span>
                    </a>
                    <a href="#pricing" class="nav-link">
                        <i class="fas fa-tag"></i>
                        <span>Pricing</span>
                    </a>
                </div>

                <!-- User Actions -->
                <div class="nav-actions">
                    <!-- Login Button -->
                    <button id="headerLoginBtn" class="header-btn">
                        <i class="fab fa-google"></i>
                        <span class="hide-on-mobile">Sign in with Google</span>
                    </button>
                    
                    <!-- Mobile Menu Toggle -->
                    <button class="mobile-toggle" id="mobileToggle">
                        <i class="fas fa-bars"></i>
                    </button>
                </div>
            </div>
        </nav>

        <!-- Mobile Menu -->
        <div class="mobile-menu-overlay" id="mobileMenu">
            <div class="mobile-menu-container">
                <div class="mobile-menu-header">
                    <div class="logo-icon">
                        <i class="fas fa-gavel"></i>
                    </div>
                    <button class="mobile-close" id="mobileClose">
                        <i class="fas fa-times"></i>
                    </button>
                </div>
                <div class="mobile-menu-links">
                    <a href="#home" class="mobile-link active">
                        <i class="fas fa-home"></i>
                        <span>Home</span>
                    </a>
                    <a href="#features" class="mobile-link">
                        <i class="fas fa-star"></i>
                        <span>Features</span>
                    </a>
                    <a href="#documents" class="mobile-link">
                        <i class="fas fa-file-contract"></i>
                        <span>Documents</span>
                    </a>
                    <a href="#legalDatabase" class="mobile-link">
                        <i class="fas fa-database"></i>
                        <span>Legal Database</span>
                    </a>
                    <a href="#lawyerDirectory" class="mobile-link">
                        <i class="fas fa-user-tie"></i>
                        <span>Find Lawyers</span>
                    </a>
                    <a href="#legalGuides" class="mobile-link">
                        <i class="fas fa-book"></i>
                        <span>Legal Guides</span>
                    </a>
                    <a href="#pricing" class="mobile-link">
                        <i class="fas fa-tag"></i>
                        <span>Pricing</span>
                    </a>
                    <a href="#chat" class="mobile-link" id="mobileStartChat">
                        <i class="fas fa-comments"></i>
                        <span>Start Chat</span>
                    </a>
                </div>
            </div>
        </div>

        <!-- Hero Section -->
        <section id="home" class="hero-section">
            <div class="hero-container container">
                <!-- Animated Background Elements -->
                <div class="hero-bg-elements">
                    <div class="floating-element" style="top: 20%; left: 10%;">
                        <i class="fas fa-balance-scale"></i>
                    </div>
                    <div class="floating-element" style="top: 60%; right: 15%;">
                        <i class="fas fa-gavel"></i>
                    </div>
                    <div class="floating-element" style="bottom: 20%; left: 20%;">
                        <i class="fas fa-scale-balanced"></i>
                    </div>
                </div>
                
                <div class="hero-content">
                    <div class="hero-badge">
                        <span class="badge-text">
                            <i class="fas fa-bolt"></i>
                            AI-POWERED LEGAL ASSISTANT
                        </span>
                    </div>
                    
                    <h1 class="hero-title">
                        Get <span style="background: linear-gradient(135deg, var(--court-gold) 0%, #fff 100%); -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text;">Instant Legal Help</span><br>
                        From Your AI Assistant
                    </h1>
                    
                    <p class="hero-subtitle">
                        LegalSwami provides 24/7 AI-powered legal guidance, document generation, 
                        and legal research assistance. Get instant answers to your legal questions 
                        in simple, understandable language.
                    </p>
                    
                    <div class="hero-stats">
                        <div class="stat-item">
                            <div class="stat-number">10,000+</div>
                            <div class="stat-label">Legal Documents Generated</div>
                        </div>
                        <div class="stat-item">
                            <div class="stat-number">50,000+</div>
                            <div class="stat-label">Legal Questions Answered</div>
                        </div>
                        <div class="stat-item">
                            <div class="stat-number">99.8%</div>
                            <div class="stat-label">User Satisfaction Rate</div>
                        </div>
                    </div>
                    
                    <div class="hero-actions">
                        <button id="startChatBtn" class="btn-hero-primary">
                            <i class="fas fa-comments"></i>
                            <span>Start Free Chat Now</span>
                        </button>
                        
                        <button id="watchDemo" class="btn-hero-secondary">
                            <i class="fas fa-play-circle"></i>
                            <span>Watch Demo Video</span>
                        </button>
                    </div>
                    
                    <div class="hero-trust">
                        <div class="trust-label">Trusted by</div>
                        <div class="trust-badges">
                            <div class="trust-badge">
                                <i class="fas fa-university"></i>
                                <span>Law Firms</span>
                            </div>
                            <div class="trust-badge">
                                <i class="fas fa-graduation-cap"></i>
                                <span>Law Students</span>
                            </div>
                            <div class="trust-badge">
                                <i class="fas fa-briefcase"></i>
                                <span>Businesses</span>
                            </div>
                            <div class="trust-badge">
                                <i class="fas fa-users"></i>
                                <span>Individuals</span>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="hero-illustration">
                    <div class="ai-assistant-card">
                        <div class="assistant-avatar">
                            <i class="fas fa-robot"></i>
                        </div>
                        <h3 class="assistant-title">AI Legal Assistant</h3>
                        <p class="assistant-subtitle">Available 24/7</p>
                        
                        <div class="assistant-features">
                            <div class="feature">
                                <i class="fas fa-check-circle"></i>
                                <span>Instant Responses</span>
                            </div>
                            <div class="feature">
                                <i class="fas fa-check-circle"></i>
                                <span>Multi-Language</span>
                            </div>
                            <div class="feature">
                                <i class="fas fa-check-circle"></i>
                                <span>Document Generation</span>
                            </div>
                        </div>
                        
                        <button class="btn-assistant" id="heroAssistantBtn">
                            <i class="fas fa-comment-alt"></i>
                            Ask Legal Question
                        </button>
                    </div>
                </div>
            </div>
            
            <!-- Scroll Indicator -->
            <div class="scroll-indicator">
                <div class="mouse">
                    <div class="wheel"></div>
                </div>
                <div class="arrow">
                    <i class="fas fa-chevron-down"></i>
                </div>
            </div>
        </section>

        <!-- Features Section -->
        <section id="features" class="features-section">
            <div class="container">
                <div class="section-header">
                    <h2 class="section-title">
                        <span style="background: linear-gradient(135deg, var(--court-gold) 0%, #fff 100%); -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text;">Powerful Features</span> for All Your Legal Needs
                    </h2>
                    <p class="section-subtitle">
                        Everything you need in one comprehensive legal assistant
                    </p>
                </div>
                
                <div class="features-grid">
                    <!-- Feature 1 -->
                    <div class="feature-card">
                        <div class="feature-icon">
                            <i class="fas fa-comments"></i>
                        </div>
                        <h3 class="feature-title">AI Chat Assistant</h3>
                        <p class="feature-description">
                            Ask legal questions in natural language and get instant, accurate responses powered by advanced AI.
                        </p>
                        <div class="feature-tags">
                            <span class="tag">24/7 Available</span>
                            <span class="tag">Multi-Language</span>
                        </div>
                    </div>
                    
                    <!-- Feature 2 -->
                    <div class="feature-card">
                        <div class="feature-icon">
                            <i class="fas fa-file-contract"></i>
                        </div>
                        <h3 class="feature-title">Smart Document Generation</h3>
                        <p class="feature-description">
                            Generate legal documents instantly in PDF, DOC, and TXT formats with customizable templates.
                        </p>
                        <div class="feature-tags">
                            <span class="tag">100+ Templates</span>
                            <span class="tag">Customizable</span>
                        </div>
                    </div>
                    
                    <!-- Feature 3 -->
                    <div class="feature-card">
                        <div class="feature-icon">
                            <i class="fas fa-shield-alt"></i>
                        </div>
                        <h3 class="feature-title">Bank-Level Security</h3>
                        <p class="feature-description">
                            End-to-end encryption and secure authentication to protect your sensitive legal data.
                        </p>
                        <div class="feature-tags">
                            <span class="tag">AES-256</span>
                            <span class="tag">GDPR Compliant</span>
                        </div>
                    </div>
                    
                    <!-- Feature 4 -->
                    <div class="feature-card">
                        <div class="feature-icon">
                            <i class="fas fa-history"></i>
                        </div>
                        <h3 class="feature-title">Complete Chat History</h3>
                        <p class="feature-description">
                            Access your complete chat history anytime. Export conversations as documents for record keeping.
                        </p>
                        <div class="feature-tags">
                            <span class="tag">Unlimited History</span>
                            <span class="tag">Export Options</span>
                        </div>
                    </div>
                    
                    <!-- Feature 5 -->
                    <div class="feature-card">
                        <div class="feature-icon">
                            <i class="fas fa-mobile-alt"></i>
                        </div>
                        <h3 class="feature-title">Mobile Responsive</h3>
                        <p class="feature-description">
                            Access LegalSwami from any device - desktop, tablet, or mobile phone with native-like experience.
                        </p>
                        <div class="feature-tags">
                            <span class="tag">PWA Support</span>
                            <span class="tag">Offline Mode</span>
                        </div>
                    </div>
                    
                    <!-- Feature 6 -->
                    <div class="feature-card">
                        <div class="feature-icon">
                            <i class="fas fa-language"></i>
                        </div>
                        <h3 class="feature-title">Multi-Language Support</h3>
                        <p class="feature-description">
                            Get legal advice in multiple languages including Hindi, English, Marathi, Gujarati, and more.
                        </p>
                        <div class="feature-tags">
                            <span class="tag">10+ Languages</span>
                            <span class="tag">Real-time Translation</span>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Legal Database Section -->
        <section id="legalDatabase" class="database-section">
            <div class="container">
                <div class="section-header">
                    <h2 class="section-title">
                        <span style="background: linear-gradient(135deg, var(--court-gold) 0%, #fff 100%); -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text;">Legal Database</span> & Research Tools
                    </h2>
                    <p class="section-subtitle">
                        Access comprehensive legal resources and research materials
                    </p>
                </div>
                
                <div class="database-grid">
                    <!-- Legal Acts Database -->
                    <div class="database-card">
                        <div class="database-icon">
                            <i class="fas fa-book"></i>
                        </div>
                        <h3 class="database-title">Acts & Statutes</h3>
                        <ul class="database-list">
                            <li><i class="fas fa-search"></i> IPC (Indian Penal Code)</li>
                            <li><i class="fas fa-search"></i> CrPC (Criminal Procedure Code)</li>
                            <li><i class="fas fa-search"></i> CPC (Civil Procedure Code)</li>
                            <li><i class="fas fa-search"></i> Constitution of India</li>
                            <li><i class="fas fa-search"></i> Consumer Protection Act</li>
                        </ul>
                        <button class="btn-database">
                            <i class="fas fa-search"></i>
                            Search Acts
                        </button>
                    </div>
                    
                    <!-- Case Laws Database -->
                    <div class="database-card">
                        <div class="database-icon">
                            <i class="fas fa-gavel"></i>
                        </div>
                        <h3 class="database-title">Case Laws Database</h3>
                        <ul class="database-list">
                            <li><i class="fas fa-balance-scale"></i> Supreme Court Judgments</li>
                            <li><i class="fas fa-balance-scale"></i> High Court Judgments</li>
                            <li><i class="fas fa-balance-scale"></i> Landmark Cases</li>
                            <li><i class="fas fa-balance-scale"></i> Recent Judgments</li>
                            <li><i class="fas fa-balance-scale"></i> Case Citations</li>
                        </ul>
                        <button class="btn-database">
                            <i class="fas fa-gavel"></i>
                            Search Case Laws
                        </button>
                    </div>
                    
                    <!-- Legal Calculator -->
                    <div class="database-card">
                        <div class="database-icon">
                            <i class="fas fa-calculator"></i>
                        </div>
                        <h3 class="database-title">Legal Calculators</h3>
                        <ul class="database-list">
                            <li><i class="fas fa-calculator"></i> Court Fee Calculator</li>
                            <li><i class="fas fa-calculator"></i> Stamp Duty Calculator</li>
                            <li><i class="fas fa-calculator"></i> Compensation Calculator</li>
                            <li><i class="fas fa-calculator"></i> Interest Calculator</li>
                            <li><i class="fas fa-calculator"></i> Tax Calculator</li>
                        </ul>
                        <button class="btn-database">
                            <i class="fas fa-calculator"></i>
                            Open Calculator
                        </button>
                    </div>
                </div>
            </div>
        </section>

        <!-- Document Types Section -->
        <section id="documents" class="documents-section">
            <div class="container">
                <div class="section-header">
                    <h2 class="section-title">
                        Generate <span style="background: linear-gradient(135deg, var(--court-gold) 0%, #fff 100%); -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text;">Legal Documents</span> Instantly
                    </h2>
                    <p class="section-subtitle">
                        Professional legal documents at your fingertips
                    </p>
                </div>
                
                <div class="documents-grid">
                    <!-- Document Category 1 -->
                    <div class="document-category">
                        <div class="category-icon">
                            <i class="fas fa-handshake"></i>
                        </div>
                        <h3 class="category-title">Agreements & Contracts</h3>
                        <ul class="document-list">
                            <li><i class="fas fa-check-circle"></i> Rental Agreement</li>
                            <li><i class="fas fa-check-circle"></i> Non-Disclosure Agreement</li>
                            <li><i class="fas fa-check-circle"></i> Employment Contract</li>
                            <li><i class="fas fa-check-circle"></i> Service Agreement</li>
                            <li><i class="fas fa-check-circle"></i> Partnership Agreement</li>
                        </ul>
                        <button class="btn-generate">
                            <i class="fas fa-magic"></i>
                            Generate Now
                        </button>
                    </div>
                    
                    <!-- Document Category 2 -->
                    <div class="document-category">
                        <div class="category-icon">
                            <i class="fas fa-balance-scale"></i>
                        </div>
                        <h3 class="category-title">Legal Notices & Letters</h3>
                        <ul class="document-list">
                            <li><i class="fas fa-check-circle"></i> Legal Notice</li>
                            <li><i class="fas fa-check-circle"></i> Cease & Desist Notice</li>
                            <li><i class="fas fa-check-circle"></i> Demand Letter</li>
                            <li><i class="fas fa-check-circle"></i> Notice to Quit</li>
                            <li><i class="fas fa-check-circle"></i> Consumer Complaint</li>
                        </ul>
                        <button class="btn-generate">
                            <i class="fas fa-magic"></i>
                            Generate Now
                        </button>
                    </div>
                    
                    <!-- Document Category 3 -->
                    <div class="document-category">
                        <div class="category-icon">
                            <i class="fas fa-user-tie"></i>
                        </div>
                        <h3 class="category-title">Personal & Family</h3>
                        <ul class="document-list">
                            <li><i class="fas fa-check-circle"></i> Will & Testament</li>
                            <li><i class="fas fa-check-circle"></i> Power of Attorney</li>
                            <li><i class="fas fa-check-circle"></i> Affidavit</li>
                            <li><i class="fas fa-check-circle"></i> Gift Deed</li>
                            <li><i class="fas fa-check-circle"></i> Divorce Papers</li>
                        </ul>
                        <button class="btn-generate">
                            <i class="fas fa-magic"></i>
                            Generate Now
                        </button>
                    </div>
                </div>
            </div>
        </section>

        <!-- Lawyer Directory Section -->
        <section id="lawyerDirectory" class="lawyer-section">
            <div class="container">
                <div class="section-header">
                    <h2 class="section-title">
                        Find <span style="background: linear-gradient(135deg, var(--court-gold) 0%, #fff 100%); -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text;">Qualified Lawyers</span>
                    </h2>
                    <p class="section-subtitle">
                        Connect with experienced legal professionals
                    </p>
                </div>
                
                <div class="lawyer-search">
                    <div class="search-container">
                        <i class="fas fa-search"></i>
                        <input type="text" id="lawyerSearch" placeholder="Search by specialization, location, or name...">
                        <button class="btn-search" id="lawyerSearchBtn">
                            <i class="fas fa-search"></i>
                            Search
                        </button>
                    </div>
                    
                    <div class="specialization-filters">
                        <button class="filter-btn active" data-specialization="all">All</button>
                        <button class="filter-btn" data-specialization="criminal">Criminal</button>
                        <button class="filter-btn" data-specialization="civil">Civil</button>
                        <button class="filter-btn" data-specialization="corporate">Corporate</button>
                        <button class="filter-btn" data-specialization="family">Family</button>
                        <button class="filter-btn" data-specialization="property">Property</button>
                    </div>
                </div>
                
                <div class="lawyers-grid" id="lawyersGrid">
                    <!-- Lawyers will be dynamically loaded here -->
                    <div class="lawyer-card" data-specialization="criminal">
                        <div class="lawyer-avatar">
                            <i class="fas fa-user-tie"></i>
                        </div>
                        <h3 class="lawyer-name">Adv. Rajesh Kumar</h3>
                        <p class="lawyer-specialization">Criminal Law Expert</p>
                        <p class="lawyer-experience">15+ Years Experience</p>
                        <button class="btn-consult">
                            <i class="fas fa-comments"></i> Consult Now
                        </button>
                    </div>
                    
                    <div class="lawyer-card" data-specialization="corporate">
                        <div class="lawyer-avatar">
                            <i class="fas fa-user-tie"></i>
                        </div>
                        <h3 class="lawyer-name">Adv. Priya Sharma</h3>
                        <p class="lawyer-specialization">Corporate Law Expert</p>
                        <p class="lawyer-experience">12+ Years Experience</p>
                        <button class="btn-consult">
                            <i class="fas fa-comments"></i> Consult Now
                        </button>
                    </div>
                    
                    <div class="lawyer-card" data-specialization="family">
                        <div class="lawyer-avatar">
                            <i class="fas fa-user-tie"></i>
                        </div>
                        <h3 class="lawyer-name">Adv. Amit Patel</h3>
                        <p class="lawyer-specialization">Family Law Expert</p>
                        <p class="lawyer-experience">10+ Years Experience</p>
                        <button class="btn-consult">
                            <i class="fas fa-comments"></i> Consult Now
                        </button>
                    </div>
                    
                    <div class="lawyer-card" data-specialization="property">
                        <div class="lawyer-avatar">
                            <i class="fas fa-user-tie"></i>
                        </div>
                        <h3 class="lawyer-name">Adv. Neha Singh</h3>
                        <p class="lawyer-specialization">Property Law Expert</p>
                        <p class="lawyer-experience">8+ Years Experience</p>
                        <button class="btn-consult">
                            <i class="fas fa-comments"></i> Consult Now
                        </button>
                    </div>
                    
                    <div class="lawyer-card" data-specialization="civil">
                        <div class="lawyer-avatar">
                            <i class="fas fa-user-tie"></i>
                        </div>
                        <h3 class="lawyer-name">Adv. Vikram Singh</h3>
                        <p class="lawyer-specialization">Civil Law Expert</p>
                        <p class="lawyer-experience">14+ Years Experience</p>
                        <button class="btn-consult">
                            <i class="fas fa-comments"></i> Consult Now
                        </button>
                    </div>
                    
                    <div class="lawyer-card" data-specialization="criminal">
                        <div class="lawyer-avatar">
                            <i class="fas fa-user-tie"></i>
                        </div>
                        <h3 class="lawyer-name">Adv. Sanjay Gupta</h3>
                        <p class="lawyer-specialization">Criminal Law Expert</p>
                        <p class="lawyer-experience">18+ Years Experience</p>
                        <button class="btn-consult">
                            <i class="fas fa-comments"></i> Consult Now
                        </button>
                    </div>
                </div>
            </div>
        </section>

        <!-- Legal Procedure Guides Section -->
        <section id="legalGuides" class="guides-section">
            <div class="container">
                <div class="section-header">
                    <h2 class="section-title">
                        <span style="background: linear-gradient(135deg, var(--court-gold) 0%, #fff 100%); -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text;">Step-by-Step</span> Legal Guides
                    </h2>
                    <p class="section-subtitle">
                        Understand legal procedures with easy-to-follow guides
                    </p>
                </div>
                
                <div class="guides-grid">
                    <div class="guide-card">
                        <div class="guide-icon">
                            <i class="fas fa-user-plus"></i>
                        </div>
                        <h3 class="guide-title">How to File a Case</h3>
                        <p class="guide-description">
                            Complete step-by-step guide for filing different types of cases in Indian courts.
                        </p>
                        <div class="guide-steps">
                            <span class="step">1. Document Preparation</span>
                            <span class="step">2. Court Selection</span>
                            <span class="step">3. Fee Payment</span>
                            <span class="step">4. Case Number</span>
                        </div>
                        <button class="btn-guide">
                            <i class="fas fa-book-open"></i>
                            View Guide
                        </button>
                    </div>
                    
                    <div class="guide-card">
                        <div class="guide-icon">
                            <i class="fas fa-file-contract"></i>
                        </div>
                        <h3 class="guide-title">Document Registration Process</h3>
                        <p class="guide-description">
                            Learn how to register legal documents with proper procedures and fees.
                        </p>
                        <div class="guide-steps">
                            <span class="step">1. Stamp Duty</span>
                            <span class="step">2. Witness Arrangement</span>
                            <span class="step">3. Registration Office</span>
                            <span class="step">4. Final Registration</span>
                        </div>
                        <button class="btn-guide">
                            <i class="fas fa-book-open"></i>
                            View Guide
                        </button>
                    </div>
                    
                    <div class="guide-card">
                        <div class="guide-icon">
                            <i class="fas fa-balance-scale"></i>
                        </div>
                        <h3 class="guide-title">Consumer Complaint Process</h3>
                        <p class="guide-description">
                            Guide to filing consumer complaints with proper documentation and procedures.
                        </p>
                        <div class="guide-steps">
                            <span class="step">1. Complaint Drafting</span>
                            <span class="step">2. Evidence Collection</span>
                            <span class="step">3. Forum Selection</span>
                            <span class="step">4. Hearing Process</span>
                        </div>
                        <button class="btn-guide">
                            <i class="fas fa-book-open"></i>
                            View Guide
                        </button>
                    </div>
                </div>
            </div>
        </section>

        <!-- Testimonials Section -->
        <section id="testimonials" class="testimonials-section">
            <div class="container">
                <div class="section-header">
                    <h2 class="section-title">
                        Trusted by <span style="background: linear-gradient(135deg, var(--court-gold) 0%, #fff 100%); -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text;">Thousands</span> of Users
                    </h2>
                    <p class="section-subtitle">
                        See what our users have to say about LegalSwami
                    </p>
                </div>
                
                <div class="testimonials-carousel">
                    <!-- Testimonial 1 -->
                    <div class="testimonial-card">
                        <div class="testimonial-rating">
                            <i class="fas fa-star"></i>
                            <i class="fas fa-star"></i>
                            <i class="fas fa-star"></i>
                            <i class="fas fa-star"></i>
                            <i class="fas fa-star"></i>
                        </div>
                        <p class="testimonial-text">
                            "LegalSwami helped me draft a professional rental agreement in minutes. The AI understood exactly what I needed and generated a perfect document. Saved me ₹5000 in lawyer fees!"
                        </p>
                        <div class="testimonial-author">
                            <div class="author-avatar">
                                <img src="https://randomuser.me/api/portraits/men/32.jpg" alt="Rahul Sharma">
                            </div>
                            <div class="author-info">
                                <h4 class="author-name">Rahul Sharma</h4>
                                <p class="author-title">Small Business Owner</p>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Testimonial 2 -->
                    <div class="testimonial-card">
                        <div class="testimonial-rating">
                            <i class="fas fa-star"></i>
                            <i class="fas fa-star"></i>
                            <i class="fas fa-star"></i>
                            <i class="fas fa-star"></i>
                            <i class="fas fa-star-half-alt"></i>
                        </div>
                        <p class="testimonial-text">
                            "As a law student, LegalSwami is a game-changer! It helps me understand complex legal concepts and provides excellent research assistance. Like having a personal tutor 24/7."
                        </p>
                        <div class="testimonial-author">
                            <div class="author-avatar">
                                <img src="https://randomuser.me/api/portraits/women/44.jpg" alt="Priya Patel">
                            </div>
                            <div class="author-info">
                                <h4 class="author-name">Priya Patel</h4>
                                <p class="author-title">Law Student, NLU Delhi</p>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Testimonial 3 -->
                    <div class="testimonial-card">
                        <div class="testimonial-rating">
                            <i class="fas fa-star"></i>
                            <i class="fas fa-star"></i>
                            <i class="fas fa-star"></i>
                            <i class="fas fa-star"></i>
                            <i class="fas fa-star"></i>
                        </div>
                        <p class="testimonial-text">
                            "The document generation feature saved our startup thousands! We needed multiple NDAs and service agreements. LegalSwami generated perfect documents in minutes. Incredible tool!"
                        </p>
                        <div class="testimonial-author">
                            <div class="author-avatar">
                                <img src="https://randomuser.me/api/portraits/men/67.jpg" alt="Ankit Verma">
                            </div>
                            <div class="author-info">
                                <h4 class="author-name">Ankit Verma</h4>
                                <p class="author-title">Tech Entrepreneur</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Pricing Section -->
        <section id="pricing" class="pricing-section">
            <div class="container">
                <div class="section-header">
                    <h2 class="section-title">
                        Simple, <span style="background: linear-gradient(135deg, var(--court-gold) 0%, #fff 100%); -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text;">Transparent</span> Pricing
                    </h2>
                    <p class="section-subtitle">
                        Choose the perfect plan for your legal needs
                    </p>
                </div>
                
                <div class="pricing-cards">
                    <!-- Free Plan -->
                    <div class="pricing-card">
                        <div class="pricing-badge">FREE</div>
                        <h3 class="pricing-title">Basic</h3>
                        <div class="pricing-price">
                            <span class="currency">₹</span>
                            <span class="amount">0</span>
                            <span class="period">/month</span>
                        </div>
                        <p class="pricing-description">Perfect for trying out LegalSwami</p>
                        
                        <ul class="pricing-features">
                            <li><i class="fas fa-check-circle"></i> 10 AI Chat Messages/Day</li>
                            <li><i class="fas fa-check-circle"></i> 3 Document Generations/Month</li>
                            <li><i class="fas fa-check-circle"></i> Basic Legal Questions</li>
                            <li><i class="fas fa-times-circle"></i> No Priority Support</li>
                            <li><i class="fas fa-times-circle"></i> No Document History</li>
                        </ul>
                        
                        <button class="btn-pricing" id="freePlanBtn">
                            Get Started Free
                        </button>
                    </div>
                    
                    <!-- Pro Plan -->
                    <div class="pricing-card premium-plan">
                        <div class="pricing-badge popular">POPULAR</div>
                        <h3 class="pricing-title">Professional</h3>
                        <div class="pricing-price">
                            <span class="currency">₹</span>
                            <span class="amount">499</span>
                            <span class="period">/month</span>
                        </div>
                        <p class="pricing-description">Perfect for professionals & businesses</p>
                        
                        <ul class="pricing-features">
                            <li><i class="fas fa-check-circle"></i> Unlimited AI Chat Messages</li>
                            <li><i class="fas fa-check-circle"></i> 50 Document Generations/Month</li>
                            <li><i class="fas fa-check-circle"></i> All Document Templates</li>
                            <li><i class="fas fa-check-circle"></i> Priority Support</li>
                            <li><i class="fas fa-check-circle"></i> Complete Chat History</li>
                        </ul>
                        
                        <button class="btn-pricing" id="proPlanBtn">
                            <i class="fas fa-crown"></i>
                            Get Professional
                        </button>
                    </div>
                    
                    <!-- Business Plan -->
                    <div class="pricing-card">
                        <div class="pricing-badge">BUSINESS</div>
                        <h3 class="pricing-title">Enterprise</h3>
                        <div class="pricing-price">
                            <span class="currency">₹</span>
                            <span class="amount">1,499</span>
                            <span class="period">/month</span>
                        </div>
                        <p class="pricing-description">For law firms & large organizations</p>
                        
                        <ul class="pricing-features">
                            <li><i class="fas fa-check-circle"></i> Everything in Professional</li>
                            <li><i class="fas fa-check-circle"></i> Unlimited Document Generation</li>
                            <li><i class="fas fa-check-circle"></i> Team Collaboration</li>
                            <li><i class="fas fa-check-circle"></i> Custom Templates</li>
                            <li><i class="fas fa-check-circle"></i> Dedicated Account Manager</li>
                        </ul>
                        
                        <button class="btn-pricing" id="enterprisePlanBtn">
                            Contact Sales
                        </button>
                    </div>
                </div>
                
                <!-- Google Login Button - FIX: Added next to pricing -->
                <div style="text-align: center; margin-top: 2rem;">
                    <button class="google-signin-btn" id="pricingGoogleBtn">
                        <i class="fab fa-google"></i>
                        Sign in with Google to Subscribe
                    </button>
                </div>
            </div>
        </section>

        <!-- CTA Section -->
        <section class="cta-section">
            <div class="container">
                <div class="cta-content">
                    <h2 class="cta-title">
                        Ready to Experience <br>
                        AI-Powered Legal Assistance?
                    </h2>
                    <p class="cta-description">
                        Join thousands of satisfied users who trust LegalSwami for their legal needs. 
                        No credit card required to get started.
                    </p>
                    
                    <div class="cta-actions">
                        <button id="ctaStartChat" class="btn-cta-primary">
                            <i class="fas fa-rocket"></i>
                            Start Free Chat Now
                        </button>
                        
                        <button id="ctaScheduleDemo" class="btn-cta-secondary">
                            <i class="fas fa-calendar"></i>
                            Schedule Demo
                        </button>
                    </div>
                    
                    <div class="cta-guarantee">
                        <div class="guarantee-item">
                            <i class="fas fa-shield-alt"></i>
                            <span>100% Secure & Private</span>
                        </div>
                        <div class="guarantee-item">
                            <i class="fas fa-clock"></i>
                            <span>Available 24/7</span>
                        </div>
                        <div class="guarantee-item">
                            <i class="fas fa-headset"></i>
                            <span>Priority Support</span>
                        </div>
                    </div>
                </div>
            </div>
        </section>
        
        <!-- CHATGPT-LIKE CHAT INTERFACE -->
        <div id="chatInterface" class="chat-interface">
            <div class="container">
                <div class="chat-container">
                    <header>
                        <div class="logo">
                            <button class="sidebar-toggle show-on-mobile" id="sidebarToggle">
                                <i class="fas fa-bars"></i>
                            </button>
                            <div class="logo-icon">
                                <i class="fas fa-scale-balanced"></i>
                            </div>
                            <h1>LegalSwami</h1>
                        </div>
                        
                        <div class="header-actions">
                            <button id="backToHomeBtn" class="header-btn hide-on-mobile">
                                <i class="fas fa-home"></i>
                                <span>Back to Home</span>
                            </button>
                            
                            <div class="status-indicator hide-on-mobile">
                                <div class="status-dot"></div>
                                <span>AI Assistant Ready</span>
                            </div>
                            
                            <!-- FIX: Added Google Login button in chat header -->
                            <button id="chatHeaderLoginBtn" class="header-btn google-login">
                                <i class="fab fa-google"></i>
                                <span class="hide-on-mobile">Sign in</span>
                            </button>
                            
                            <button class="header-btn voice-search-btn" id="voiceSearchBtn" title="Voice Search">
                                <i class="fas fa-microphone"></i>
                            </button>
                            <button class="header-btn theme-toggle" id="themeToggle" title="Toggle Theme">
                                <i class="fas fa-sun"></i>
                            </button>
                            <button class="header-btn" id="clearChatBtn">
                                <i class="fas fa-broom"></i>
                                <span class="hide-on-mobile">Clear Chat</span>
                            </button>
                            <button class="header-btn" id="downloadCurrentBtn">
                                <i class="fas fa-download"></i>
                                <span class="hide-on-mobile">Download Chat</span>
                            </button>
                            <button class="header-btn" id="suggestionsBtn">
                                <i class="fas fa-lightbulb"></i>
                                <span class="hide-on-mobile">Suggestions</span>
                            </button>
                        </div>
                    </header>
                    
                    <div class="main-content">
                        <!-- Down Arrow Button (Scroll to Bottom) -->
                        <button class="scroll-to-bottom-btn" id="scrollToBottomBtn" title="Scroll to bottom">
                            <i class="fas fa-chevron-down"></i>
                        </button>
                        
                        <aside class="sidebar" id="sidebar">
                            <!-- Sidebar Tabs -->
                            <div class="sidebar-tabs">
                                <button class="sidebar-tab active" data-tab="legal-topics">
                                    <i class="fas fa-book"></i>
                                    <span class="hide-on-mobile">Legal Topics</span>
                                </button>
                                <button class="sidebar-tab" data-tab="chat-history">
                                    <i class="fas fa-history"></i>
                                    <span class="hide-on-mobile">Chat History</span>
                                </button>
                            </div>
                            
                            <!-- Legal Topics Tab Content -->
                            <div class="tab-content active" id="legal-topics-content">
                                <div class="sidebar-header">
                                    <h2><i class="fas fa-book"></i> Legal Topics</h2>
                                </div>
                                
                                <div class="sidebar-section">
                                    <h3><i class="fas fa-gavel"></i> Common Legal Areas</h3>
                                    <div class="topic-list">
                                        <button class="topic-item" data-topic="contract">
                                            <i class="fas fa-file-contract"></i>
                                            <span>Contract Law</span>
                                            <span class="topic-badge">Advanced</span>
                                        </button>
                                        <button class="topic-item" data-topic="employment">
                                            <i class="fas fa-briefcase"></i>
                                            <span>Employment Law</span>
                                            <span class="topic-badge">Popular</span>
                                        </button>
                                        <button class="topic-item" data-topic="intellectual">
                                            <i class="fas fa-lightbulb"></i>
                                            <span>Intellectual Property</span>
                                            <span class="topic-badge">Specialized</span>
                                        </button>
                                        <button class="topic-item" data-topic="realestate">
                                            <i class="fas fa-house"></i>
                                            <span>Real Estate Law</span>
                                            <span class="topic-badge">Common</span>
                                        </button>
                                        <button class="topic-item" data-topic="family">
                                            <i class="fas fa-heart"></i>
                                            <span>Family Law</span>
                                            <span class="topic-badge">Sensitive</span>
                                        </button>
                                        <button class="topic-item" data-topic="criminal">
                                            <i class="fas fa-gavel"></i>
                                            <span>Criminal Law</span>
                                            <span class="topic-badge">Critical</span>
                                        </button>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- Chat History Tab Content -->
                            <div class="tab-content" id="chat-history-content">
                                <div class="history-header">
                                    <h2><i class="fas fa-history"></i> Chat History</h2>
                                    <button class="new-chat-btn" id="newChatBtn">
                                        <i class="fas fa-plus"></i>
                                        <span class="hide-on-mobile">New Chat</span>
                                    </button>
                                </div>
                                
                                <div class="history-list" id="historyList">
                                    <div class="empty-history">
                                        <i class="fas fa-comments"></i>
                                        <p>No chat history yet</p>
                                        <p style="font-size: 0.8125rem; margin-top: 0.5rem;">Start a conversation to see it here</p>
                                    </div>
                                </div>
                            </div>
                        </aside>
                        
                        <main id="chatContent">
                            <div class="chat-messages">
                                <div id="chatMessages">
                                    <!-- Welcome Message will be added dynamically -->
                                </div>
                            </div>
                            
                            <div class="input-container">
                                <div class="input-area">
                                    <textarea 
                                        id="userInput" 
                                        placeholder="Ask any legal question or attach files (images, PDF, TXT)... (Press Enter for new line, Ctrl+Enter to send)"
                                        rows="1"
                                    ></textarea>
                                    
                                    <div class="input-buttons">
                                        <!-- Emoji Picker Button -->
                                        <button class="emoji-picker-btn" id="emojiPickerBtn" title="Insert emoji">
                                            <i class="far fa-smile"></i>
                                        </button>
                                        
                                        <!-- Attachment Button -->
                                        <button class="attachment-btn" id="attachmentBtn" title="Attach files (images, PDF, TXT)">
                                            <i class="fas fa-paperclip"></i>
                                        </button>
                                        
                                        <!-- Voice Input Button -->
                                        <button class="input-microphone-btn" id="inputMicrophoneBtn" title="Voice input">
                                            <i class="fas fa-microphone"></i>
                                        </button>
                                        
                                        <!-- Send/Stop Button -->
                                        <button class="send-button" id="sendButton">
                                            <i class="fas fa-paper-plane"></i> <span class="hide-on-mobile">Send</span>
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </main>
                    </div>
                    
                    <!-- Download Modal -->
                    <div class="modal-overlay" id="downloadModal">
                        <div class="modal">
                            <div class="modal-header">
                                <h2><i class="fas fa-download"></i> Download Chat</h2>
                                <button class="modal-close" id="closeDownloadModal">
                                    <i class="fas fa-times"></i>
                                </button>
                            </div>
                            <div class="modal-content">
                                <p>Select the format you want to download your chat in:</p>
                                
                                <div class="download-options">
                                    <div class="download-option" data-format="doc">
                                        <i class="fas fa-file-word"></i>
                                        <h3>Word Document</h3>
                                        <p>.doc format</p>
                                    </div>
                                    <div class="download-option" data-format="pdf">
                                        <i class="fas fa-file-pdf"></i>
                                        <h3>PDF Document</h3>
                                        <p>.pdf format</p>
                                    </div>
                                    <div class="download-option" data-format="txt">
                                        <i class="fas fa-file-alt"></i>
                                        <h3>Text File</h3>
                                        <p>.txt format</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Login Modal -->
                    <div class="modal-overlay" id="loginModal">
                        <div class="modal">
                            <div class="modal-header">
                                <h2><i class="fas fa-user-circle"></i> Sign In</h2>
                                <button class="modal-close" id="closeLoginModal">
                                    <i class="fas fa-times"></i>
                                </button>
                            </div>
                            <div class="modal-content">
                                <div class="login-content">
                                    <p>Sign in to access all features including unlimited chat messages, document generation, and chat history.</p>
                                    
                                    <button class="google-signin-btn" id="modalGoogleBtn">
                                        <i class="fab fa-google"></i>
                                        Sign in with Google
                                    </button>
                                    
                                    <div class="login-divider">
                                        <span>or continue as guest</span>
                                    </div>
                                    
                                    <button class="demo-login-btn" id="demoLoginBtn">
                                        <i class="fas fa-user-clock"></i>
                                        Continue as Guest
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Toast Notifications -->
                    <div class="toast" id="toast">
                        <i class="fas fa-check-circle"></i>
                        <span id="toast-message">Message sent successfully</span>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Footer -->
        <footer class="premium-footer">
            <div class="container">
                <div class="footer-content">
                    <!-- Company Info -->
                    <div class="footer-section">
                        <div class="footer-logo">
                            <div class="logo-icon">
                                <i class="fas fa-gavel"></i>
                            </div>
                            <div class="logo-text">
                                <h3 class="logo-title">LegalSwami</h3>
                                <p class="logo-subtitle">AI Legal Assistant</p>
                            </div>
                        </div>
                        <p class="footer-description">
                            Making legal assistance accessible to everyone with AI-powered technology.
                        </p>
                        <div class="social-links">
                            <a href="#" class="social-link">
                                <i class="fab fa-twitter"></i>
                            </a>
                            <a href="#" class="social-link">
                                <i class="fab fa-linkedin"></i>
                            </a>
                            <a href="#" class="social-link">
                                <i class="fab fa-github"></i>
                            </a>
                            <a href="#" class="social-link">
                                <i class="fab fa-youtube"></i>
                            </a>
                        </div>
                    </div>
                    
                    <!-- Quick Links -->
                    <div class="footer-section">
                        <h4 class="footer-heading">Quick Links</h4>
                        <ul class="footer-links">
                            <li><a href="#home">Home</a></li>
                            <li><a href="#features">Features</a></li>
                            <li><a href="#documents">Documents</a></li>
                            <li><a href="#legalDatabase">Legal Database</a></li>
                            <li><a href="#lawyerDirectory">Find Lawyers</a></li>
                            <li><a href="#legalGuides">Legal Guides</a></li>
                            <li><a href="#testimonials">Testimonials</a></li>
                            <li><a href="#pricing">Pricing</a></li>
                        </ul>
                    </div>
                    
                    <!-- Legal -->
                    <div class="footer-section">
                        <h4 class="footer-heading">Legal</h4>
                        <ul class="footer-links">
                            <li><a href="#" id="termsLink">Terms of Service</a></li>
                            <li><a href="#" id="privacyLink">Privacy Policy</a></li>
                            <li><a href="#" id="disclaimerLink">Legal Disclaimer</a></li>
                            <li><a href="#" id="cookieLink">Cookie Policy</a></li>
                        </ul>
                    </div>
                    
                    <!-- Contact -->
                    <div class="footer-section">
                        <h4 class="footer-heading">Contact Us</h4>
                        <ul class="footer-contact">
                            <li>
                                <i class="fas fa-envelope"></i>
                                <a href="mailto:support@legalswami.com">support@legalswami.com</a>
                            </li>
                            <li>
                                <i class="fas fa-phone"></i>
                                <a href="tel:+919876543210">+91 9876543210</a>
                            </li>
                            <li>
                                <i class="fas fa-map-marker-alt"></i>
                                <span>Mumbai, India</span>
                            </li>
                        </ul>
                    </div>
                </div>
                
                <div class="footer-bottom">
                    <p class="copyright">
                        &copy; 2024 LegalSwami. All rights reserved.
                    </p>
                    <div class="disclaimer">
                        <i class="fas fa-exclamation-triangle"></i>
                        LegalSwami provides AI-powered legal assistance. It is not a substitute for professional legal advice.
                    </div>
                </div>
            </div>
        </footer>

        <!-- Back to Top -->
        <button id="backToTop" class="back-to-top">
            <i class="fas fa-chevron-up"></i>
        </button>
    </div>
    
    <!-- Google Identity Services -->
    <script src="https://accounts.google.com/gsi/client" async defer></script>

    <!-- Main App Script -->
    <script>
// =============================================
// LEGALSWAMI - COMPLETE UPDATED SCRIPT
// =============================================

// Global variables
let chatHistory = [];
let currentChatId = null;
let conversationHistory = [];
let isListening = false;
let recognition = null;
let isLightMode = false;
let chatInitialized = false;
let currentUser = null;
let isLoggedIn = false;
let userToken = null;

// Welcome message HTML
const WELCOME_MESSAGE_HTML = `
    <div class="welcome-message">
        <h2>Welcome to LegalSwami</h2>
        <p>Your AI-powered legal assistant for accurate, comprehensive legal information and guidance.</p>
        
        <div class="legal-notice">
            <h4><i class="fas fa-exclamation-triangle"></i> Important Legal Notice</h4>
            <p style="font-size: 0.875rem; margin: 0; line-height: 1.5;">
                LegalSwami provides AI-generated legal information for educational purposes only. 
                This is not legal advice and does not establish an attorney-client relationship. 
                Always consult with a qualified attorney for legal advice specific to your situation.
            </p>
        </div>
        
        <p style="color: var(--court-gold); margin-top: 15px; font-size: 0.875rem;">
            <i class="fas fa-language"></i> Supports multiple Indian languages including Hindi, Marathi, Gujarati, and more!
        </p>
        
        <div style="margin-top: 1.5rem;">
            <h3 style="color: var(--court-gold); margin-bottom: 0.875rem; font-size: 1rem;">Ready-to-Use Legal Documents:</h3>
            <div class="draft-templates">
                <div class="draft-template" data-template="nda">
                    <i class="fas fa-file-signature"></i>
                    <h4>Non-Disclosure Agreement</h4>
                    <p>Confidentiality agreement template</p>
                </div>
                <div class="draft-template" data-template="employment">
                    <i class="fas fa-briefcase"></i>
                    <h4>Employment Contract</h4>
                    <p>Employee agreement template</p>
                </div>
                <div class="draft-template" data-template="rental">
                    <i class="fas fa-house"></i>
                    <h4>Rental Agreement</h4>
                    <p>Tenancy agreement template</p>
                </div>
                <div class="draft-template" data-template="loan">
                    <i class="fas fa-money-bill-wave"></i>
                    <h4>Loan Agreement</h4>
                    <p>Money lending agreement</p>
                </div>
            </div>
        </div>
        
        <div class="welcome-features">
            <div class="feature">
                <i class="fas fa-bolt"></i>
                <h4>Instant Responses</h4>
                <p>Get immediate legal insights powered by advanced AI</p>
            </div>
            <div class="feature">
                <i class="fas fa-shield-alt"></i>
                <h4>Confidential & Secure</h4>
                <p>Your conversations are private and encrypted</p>
            </div>
            <div class="feature">
                <i class="fas fa-language"></i>
                <h4>Multi-Language</h4>
                <p>Responds in same language as your query</p>
            </div>
        </div>
    </div>
`;

// =============================================
// CHAT FUNCTIONS
// =============================================

function openChat() {
    console.log("🚀 Opening chat...");
    
    // Add chat-active class to body
    document.body.classList.add('chat-active');
    
    // Show chat interface
    const chatInterface = document.getElementById('chatInterface');
    if (chatInterface) {
        chatInterface.style.display = 'flex';
        chatInterface.classList.add('active');
        
        // Force reflow
        chatInterface.offsetHeight;
        
        setTimeout(() => {
            chatInterface.style.opacity = '1';
            chatInterface.style.visibility = 'visible';
        }, 10);
    }
    
    // Initialize chat if not already
    if (!chatInitialized) {
        setTimeout(() => {
            initializeChatApp();
            chatInitialized = true;
            console.log("✅ Chat initialized");
        }, 100);
    }
    
    // Focus on input
    setTimeout(() => {
        const userInput = document.getElementById('userInput');
        if (userInput) {
            userInput.focus();
        }
    }, 300);
    
    // Scroll to bottom
    setTimeout(() => {
        scrollToBottom();
    }, 500);
}

function closeChat() {
    console.log("🔙 Closing chat...");
    
    // Remove body class
    document.body.classList.remove('chat-active');
    
    // Hide chat interface
    const chatInterface = document.getElementById('chatInterface');
    if (chatInterface) {
        chatInterface.classList.remove('active');
        chatInterface.style.opacity = '0';
        chatInterface.style.visibility = 'hidden';
        
        setTimeout(() => {
            chatInterface.style.display = 'none';
        }, 300);
    }
}

// =============================================
// SCROLL FUNCTIONS
// =============================================

function scrollToBottom() {
    const chatMessages = document.getElementById('chatMessages');
    if (chatMessages) {
        chatMessages.scrollTop = chatMessages.scrollHeight;
        hideScrollToBottomButton();
    }
}

function checkScrollPosition() {
    const chatMessages = document.getElementById('chatMessages');
    const scrollToBottomBtn = document.getElementById('scrollToBottomBtn');
    
    if (chatMessages && scrollToBottomBtn) {
        const isAtBottom = chatMessages.scrollHeight - chatMessages.scrollTop - chatMessages.clientHeight < 100;
        
        if (isAtBottom) {
            scrollToBottomBtn.classList.remove('visible');
        } else {
            scrollToBottomBtn.classList.add('visible');
        }
    }
}

function hideScrollToBottomButton() {
    const scrollToBottomBtn = document.getElementById('scrollToBottomBtn');
    if (scrollToBottomBtn) {
        scrollToBottomBtn.classList.remove('visible');
    }
}

// =============================================
// INITIALIZATION FUNCTIONS
// =============================================

function initializeAppForGuest() {
    console.log("👤 Initializing in guest mode...");
    
    // Load user preferences
    loadThemePreference();
    loadUserChatHistory();
    
    // Set guest user
    currentUser = {
        id: 'guest_' + Date.now(),
        name: 'Guest User',
        email: 'guest@legalswami.com',
        isGuest: true,
        picture: null
    };
    isLoggedIn = false;
    
    updateUserUI();
    showToast('Welcome to LegalSwami! Start your free legal consultation now.', 'info');
}

function updateUserUI() {
    // Update theme toggle icon
    const themeIcon = document.querySelector('.theme-toggle i');
    if (themeIcon) {
        themeIcon.className = isLightMode ? 'fas fa-moon' : 'fas fa-sun';
    }
    
    // Update login buttons
    const headerLoginBtn = document.getElementById('headerLoginBtn');
    const chatHeaderLoginBtn = document.getElementById('chatHeaderLoginBtn');
    
    if (isLoggedIn && currentUser) {
        // Hide login buttons, show user info
        if (headerLoginBtn) headerLoginBtn.style.display = 'none';
        if (chatHeaderLoginBtn) chatHeaderLoginBtn.style.display = 'none';
    } else {
        // Show login buttons
        if (headerLoginBtn) headerLoginBtn.style.display = 'flex';
        if (chatHeaderLoginBtn) chatHeaderLoginBtn.style.display = 'flex';
    }
}

// =============================================
// CHAT HISTORY FUNCTIONS
// =============================================

function loadUserChatHistory() {
    try {
        const userId = currentUser ? currentUser.id : 'guest';
        const savedHistory = localStorage.getItem(`legalSwamiChatHistory_${userId}`);
        if (savedHistory) {
            chatHistory = JSON.parse(savedHistory);
        }
        
        const savedChatId = localStorage.getItem(`legalSwamiCurrentChatId_${userId}`);
        if (savedChatId) {
            currentChatId = savedChatId;
            const currentChat = chatHistory.find(chat => chat.id === currentChatId);
            if (currentChat) {
                conversationHistory = [...currentChat.messages];
            }
        }
    } catch (error) {
        console.error('Error loading chat history:', error);
        chatHistory = [];
    }
}

function saveUserChatHistory() {
    try {
        const userId = currentUser ? currentUser.id : 'guest';
        localStorage.setItem(`legalSwamiChatHistory_${userId}`, JSON.stringify(chatHistory));
        localStorage.setItem(`legalSwamiCurrentChatId_${userId}`, currentChatId);
    } catch (error) {
        console.error('Error saving chat history:', error);
    }
}

// =============================================
// MAIN CHAT APP INITIALIZATION
// =============================================

function initializeChatApp() {
    console.log("🤖 Initializing chat app...");
    
    try {
        const chatMessages = document.getElementById('chatMessages');
        const userInput = document.getElementById('userInput');
        const sendButton = document.getElementById('sendButton');
        const clearChatBtn = document.getElementById('clearChatBtn');
        const downloadCurrentBtn = document.getElementById('downloadCurrentBtn');
        const suggestionsBtn = document.getElementById('suggestionsBtn');
        const voiceSearchBtn = document.getElementById('voiceSearchBtn');
        const inputMicrophoneBtn = document.getElementById('inputMicrophoneBtn');
        const themeToggle = document.getElementById('themeToggle');
        const topicItems = document.querySelectorAll('.topic-item');
        const sidebarTabs = document.querySelectorAll('.sidebar-tab');
        const newChatBtn = document.getElementById('newChatBtn');
        const backToHomeBtn = document.getElementById('backToHomeBtn');
        const emojiPickerBtn = document.getElementById('emojiPickerBtn');
        const scrollToBottomBtn = document.getElementById('scrollToBottomBtn');
        const sidebarToggle = document.getElementById('sidebarToggle');
        const chatHeaderLoginBtn = document.getElementById('chatHeaderLoginBtn');
        const closeLoginModal = document.getElementById('closeLoginModal');
        const modalGoogleBtn = document.getElementById('modalGoogleBtn');
        const demoLoginBtn = document.getElementById('demoLoginBtn');

        // Load or create chat
        if (!currentChatId || conversationHistory.length === 0) {
            createNewChat();
        } else {
            loadCurrentChatMessages();
        }

        // Send button click
        if (sendButton) {
            sendButton.addEventListener('click', sendMessage);
        }
        
        // User input keydown
        if (userInput) {
            userInput.addEventListener('keydown', function(e) {
                if (e.key === 'Enter' && e.ctrlKey) {
                    e.preventDefault();
                    sendMessage();
                }
                
                if (e.key === 'Enter' && !e.ctrlKey && !e.shiftKey) {
                    // Allow new lines with Shift+Enter
                    if (this.value.trim()) {
                        e.preventDefault();
                        sendMessage();
                    }
                }
                
                setTimeout(() => {
                    this.style.height = 'auto';
                    this.style.height = Math.min(this.scrollHeight, 100) + 'px';
                }, 10);
            });
            
            userInput.addEventListener('input', function() {
                this.style.height = 'auto';
                this.style.height = Math.min(this.scrollHeight, 100) + 'px';
                sendButton.disabled = this.value.trim() === '';
            });
        }

        // Voice recognition setup
        if ('webkitSpeechRecognition' in window || 'SpeechRecognition' in window) {
            const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;
            recognition = new SpeechRecognition();
            recognition.continuous = false;
            recognition.interimResults = true;
            recognition.lang = 'en-IN,hi-IN,mr-IN,gu-IN,ta-IN';
            
            recognition.onstart = function() {
                isListening = true;
                showToast('Listening... Speak now 🎤', 'info');
                if (voiceSearchBtn) voiceSearchBtn.classList.add('listening');
                if (inputMicrophoneBtn) inputMicrophoneBtn.classList.add('listening');
            };
            
            recognition.onresult = function(event) {
                const transcript = event.results[0][0].transcript;
                if (event.results[0].isFinal && userInput) {
                    userInput.value = transcript;
                    userInput.style.height = Math.min(userInput.scrollHeight, 100) + 'px';
                    if (sendButton) sendButton.disabled = false;
                }
            };
            
            recognition.onerror = function(event) {
                console.error('Speech recognition error:', event.error);
                isListening = false;
                showToast('Voice recognition failed. Please try again. ❌', 'error');
                if (voiceSearchBtn) voiceSearchBtn.classList.remove('listening');
                if (inputMicrophoneBtn) inputMicrophoneBtn.classList.remove('listening');
            };
            
            recognition.onend = function() {
                isListening = false;
                if (voiceSearchBtn) voiceSearchBtn.classList.remove('listening');
                if (inputMicrophoneBtn) inputMicrophoneBtn.classList.remove('listening');
            };
            
            if (voiceSearchBtn) {
                voiceSearchBtn.addEventListener('click', function() {
                    if (isListening) {
                        recognition.stop();
                    } else {
                        recognition.start();
                    }
                });
            }
            
            if (inputMicrophoneBtn) {
                inputMicrophoneBtn.addEventListener('click', function() {
                    if (isListening) {
                        recognition.stop();
                    } else {
                        recognition.start();
                    }
                });
            }
        } else {
            if (voiceSearchBtn) voiceSearchBtn.style.display = 'none';
            if (inputMicrophoneBtn) inputMicrophoneBtn.style.display = 'none';
        }

        // Theme toggle
        if (themeToggle) {
            themeToggle.addEventListener('click', function() {
                const themeIcon = this.querySelector('i');
                if (isLightMode) {
                    document.body.classList.remove('light-mode');
                    if (themeIcon) themeIcon.className = 'fas fa-sun';
                    localStorage.setItem('legalSwamiTheme', 'dark');
                    isLightMode = false;
                } else {
                    document.body.classList.add('light-mode');
                    if (themeIcon) themeIcon.className = 'fas fa-moon';
                    localStorage.setItem('legalSwamiTheme', 'light');
                    isLightMode = true;
                }
            });
        }
        
        // Sidebar toggle for mobile
        if (sidebarToggle) {
            sidebarToggle.addEventListener('click', function() {
                const sidebar = document.getElementById('sidebar');
                if (sidebar) {
                    sidebar.classList.toggle('active');
                }
            });
        }
        
        // Sidebar tab switching
        sidebarTabs.forEach(tab => {
            tab.addEventListener('click', function() {
                const tabId = this.dataset.tab;
                sidebarTabs.forEach(t => t.classList.remove('active'));
                this.classList.add('active');
                
                document.querySelectorAll('.tab-content').forEach(content => {
                    content.classList.remove('active');
                });
                
                const tabContent = document.getElementById(`${tabId}-content`);
                if (tabContent) tabContent.classList.add('active');
                
                if (tabId === 'chat-history') {
                    loadHistoryList();
                }
            });
        });
        
        // New chat button
        if (newChatBtn) newChatBtn.addEventListener('click', createNewChat);
        
        // Clear chat button
        if (clearChatBtn) {
            clearChatBtn.addEventListener('click', function() {
                if (confirm('Are you sure you want to clear the current chat? This action cannot be undone.')) {
                    const chatMessages = document.getElementById('chatMessages');
                    if (chatMessages) chatMessages.innerHTML = '';
                    conversationHistory = [];
                    createNewChat();
                    showToast('Current chat cleared 🗑️', 'success');
                }
            });
        }
        
        // Download chat button
        if (downloadCurrentBtn) {
            downloadCurrentBtn.addEventListener('click', function() {
                if (conversationHistory.length === 0) {
                    showToast('No chat content to download 📄', 'warning');
                    return;
                }
                const downloadModal = document.getElementById('downloadModal');
                if (downloadModal) downloadModal.classList.add('active');
            });
        }
        
        // Suggestions button
        if (suggestionsBtn) {
            suggestionsBtn.addEventListener('click', function() {
                const suggestions = [
                    "Create a non-disclosure agreement draft 📝",
                    "I need an employment contract template 💼",
                    "Generate a rental agreement for me 🏠",
                    "Draft a loan agreement document 💰",
                    "What are the essential elements of a valid contract? ⚖️"
                ];
                
                addMessageToChat(
                    `<h3 style="color: var(--court-gold); margin-bottom: 1rem;">Suggested Questions:</h3>
                    <div style="display: flex; flex-direction: column; gap: 0.5rem;">
                        ${suggestions.map(q => `
                            <div style="cursor: pointer; padding: 0.75rem; background: rgba(212, 175, 55, 0.1); border: 1px solid rgba(212, 175, 55, 0.2); border-radius: 8px; transition: all 0.3s;" 
                                onmouseover="this.style.background='rgba(212, 175, 55, 0.2)'; this.style.transform='translateX(5px)'" 
                                onmouseout="this.style.background='rgba(212, 175, 55, 0.1)'; this.style.transform='translateX(0)'"
                                onclick="document.getElementById('userInput').value = '${q}'; document.getElementById('userInput').focus(); document.getElementById('userInput').style.height = Math.min(document.getElementById('userInput').scrollHeight, 100) + 'px'; document.getElementById('sendButton').disabled = false;">
                                ${q}
                            </div>
                        `).join('')}
                    </div>
                    <p style="margin-top: 1rem; color: var(--dark-text-secondary); font-size: 0.875rem;">Click any question to add it to the input field. 👆</p>`,
                    false
                );
            });
        }
        
        // Topic click handlers
        topicItems.forEach(item => {
            item.addEventListener('click', function() {
                const topic = this.dataset.topic;
                const topicName = this.querySelector('span').textContent;
                const questions = {
                    'contract': 'What are the essential elements of a valid contract under Indian law? ⚖️',
                    'employment': 'What are the rights of employees regarding workplace harassment in India? 💼',
                    'intellectual': 'How does copyright protection work for software in India? 🧠',
                    'realestate': 'What documents are required for property registration in India? 🏠',
                    'family': 'What are the grounds for divorce under Hindu Marriage Act? 👨‍👩‍👧',
                    'criminal': 'What is the difference between bailable and non-bailable offenses? ⚖️'
                };
                if (userInput) {
                    userInput.value = questions[topic] || `Tell me about ${topicName.toLowerCase()} in Indian law. ⚖️`;
                    userInput.focus();
                    userInput.style.height = Math.min(userInput.scrollHeight, 100) + 'px';
                }
                if (sendButton) sendButton.disabled = false;
                showToast(`${topicName} topic selected 📂`, 'success');
            });
        });
        
        // Back to home button
        if (backToHomeBtn) {
            backToHomeBtn.addEventListener('click', closeChat);
        }
        
        // Chat header login button
        if (chatHeaderLoginBtn) {
            chatHeaderLoginBtn.addEventListener('click', function() {
                const loginModal = document.getElementById('loginModal');
                if (loginModal) loginModal.classList.add('active');
            });
        }
        
        // Login modal close button
        if (closeLoginModal) {
            closeLoginModal.addEventListener('click', function() {
                const loginModal = document.getElementById('loginModal');
                if (loginModal) loginModal.classList.remove('active');
            });
        }
        
        // Modal Google login button
        if (modalGoogleBtn) {
            modalGoogleBtn.addEventListener('click', handleGoogleLogin);
        }
        
        // Demo login button
        if (demoLoginBtn) {
            demoLoginBtn.addEventListener('click', handleDemoLogin);
        }
        
        // Emoji picker button
        if (emojiPickerBtn) {
            emojiPickerBtn.addEventListener('click', function() {
                const userInput = document.getElementById('userInput');
                if (userInput) {
                    const emojis = ['⚖️', '📝', '🔍', '💼', '🏠', '💰', '👨‍👩‍👧', '⚡', '📚', '🔐', '👨‍⚖️', '🏛️', '📄', '✍️', '✅'];
                    const emoji = emojis[Math.floor(Math.random() * emojis.length)];
                    const cursorPos = userInput.selectionStart;
                    const textBefore = userInput.value.substring(0, cursorPos);
                    const textAfter = userInput.value.substring(cursorPos);
                    userInput.value = textBefore + emoji + textAfter;
                    userInput.focus();
                    userInput.selectionStart = cursorPos + emoji.length;
                    userInput.selectionEnd = cursorPos + emoji.length;
                    userInput.style.height = Math.min(userInput.scrollHeight, 100) + 'px';
                    if (sendButton) sendButton.disabled = false;
                }
            });
        }
        
        // Scroll to bottom button
        if (scrollToBottomBtn) {
            scrollToBottomBtn.addEventListener('click', scrollToBottom);
        }
        
        // Chat messages scroll event
        if (chatMessages) {
            chatMessages.addEventListener('scroll', checkScrollPosition);
        }
        
        // Download modal close
        const closeDownloadModal = document.getElementById('closeDownloadModal');
        if (closeDownloadModal) {
            closeDownloadModal.addEventListener('click', function() {
                const downloadModal = document.getElementById('downloadModal');
                if (downloadModal) downloadModal.classList.remove('active');
            });
        }
        
        // Download options
        const downloadOptions = document.querySelectorAll('.download-option');
        downloadOptions.forEach(option => {
            option.addEventListener('click', function() {
                const format = this.dataset.format;
                downloadChat(format);
                const downloadModal = document.getElementById('downloadModal');
                if (downloadModal) downloadModal.classList.remove('active');
            });
        });
        
        // Draft template click handlers
        document.addEventListener('click', function(e) {
            if (e.target.closest('.draft-template')) {
                const template = e.target.closest('.draft-template').dataset.template;
                const templateNames = {
                    'nda': 'Non-Disclosure Agreement',
                    'employment': 'Employment Contract',
                    'rental': 'Rental Agreement',
                    'loan': 'Loan Agreement'
                };
                
                if (userInput) {
                    userInput.value = `Generate a ${templateNames[template]} template for me.`;
                    userInput.focus();
                    userInput.style.height = Math.min(userInput.scrollHeight, 100) + 'px';
                    if (sendButton) sendButton.disabled = false;
                    showToast(`${templateNames[template]} selected! Click Send to generate.`, 'success');
                }
            }
        });
        
        // Focus input on load
        setTimeout(() => {
            if (userInput) userInput.focus();
        }, 300);
        
        console.log("✅ Chat app initialized successfully");
        chatInitialized = true;
        
    } catch (error) {
        console.error("❌ Error initializing chat app:", error);
    }
}

function loadThemePreference() {
    const savedTheme = localStorage.getItem('legalSwamiTheme');
    if (savedTheme === 'light') {
        document.body.classList.add('light-mode');
        const themeIcon = document.querySelector('.theme-toggle i');
        if (themeIcon) themeIcon.className = 'fas fa-moon';
        isLightMode = true;
    }
}

// =============================================
// CHAT MESSAGE FUNCTIONS
// =============================================

function loadCurrentChatMessages() {
    const chatMessages = document.getElementById('chatMessages');
    if (!chatMessages) return;
    
    chatMessages.innerHTML = '';
    
    if (conversationHistory.length === 0) {
        const welcomeContainer = document.createElement('div');
        welcomeContainer.innerHTML = WELCOME_MESSAGE_HTML;
        chatMessages.appendChild(welcomeContainer);
        return;
    }
    
    conversationHistory.forEach(msg => {
        addMessageToChat(msg.content, msg.role === 'user', true);
    });
    
    setTimeout(() => {
        scrollToBottom();
    }, 100);
}

function createNewChat() {
    currentChatId = 'chat_' + Date.now() + '_' + Math.random().toString(36).substr(2, 9);
    conversationHistory = [];
    
    const chatMessages = document.getElementById('chatMessages');
    if (chatMessages) {
        const welcomeContainer = document.createElement('div');
        welcomeContainer.innerHTML = WELCOME_MESSAGE_HTML;
        chatMessages.innerHTML = '';
        chatMessages.appendChild(welcomeContainer);
    }
    
    // Close sidebar on mobile
    const sidebar = document.getElementById('sidebar');
    if (sidebar && window.innerWidth <= 992) {
        sidebar.classList.remove('active');
    }
    
    showToast('New chat started 💬', 'success');
    setTimeout(() => {
        scrollToBottom();
    }, 100);
}

function addMessageToChat(content, isUser, fromHistory = false) {
    const chatMessages = document.getElementById('chatMessages');
    
    // Remove welcome message if this is a new user message
    if (!fromHistory && isUser && chatMessages) {
        const welcomeMessage = document.querySelector('.welcome-message');
        if (welcomeMessage) {
            welcomeMessage.remove();
        }
    }
    
    const messageDiv = document.createElement('div');
    messageDiv.className = `message ${isUser ? 'user-message' : 'ai-message'}`;
    const messageId = 'msg_' + Date.now() + '_' + Math.random().toString(36).substr(2, 9);
    messageDiv.id = messageId;
    
    const avatar = document.createElement('div');
    avatar.className = 'avatar';
    if (isUser) {
        if (currentUser && currentUser.picture) {
            avatar.innerHTML = `<img src="${currentUser.picture}" alt="${currentUser.name}" style="width: 100%; height: 100%; border-radius: 8px;">`;
        } else {
            avatar.innerHTML = '<i class="fas fa-user"></i>';
        }
    } else {
        avatar.innerHTML = '<i class="fas fa-scale-balanced"></i>';
    }
    
    const messageContent = document.createElement('div');
    messageContent.className = 'message-content';
    
    const messageText = document.createElement('div');
    messageText.className = 'message-text';
    messageText.innerHTML = content.replace(/\n/g, '<br>');
    
    messageContent.appendChild(messageText);
    
    // Add action buttons for AI messages
    if (!isUser && !fromHistory) {
        const messageActions = document.createElement('div');
        messageActions.className = 'message-actions';
        messageActions.innerHTML = `
            <button class="action-btn copy" onclick="copyMessage(this)" title="Copy response">
                <i class="fas fa-copy"></i> Copy
            </button>
            <button class="action-btn like" onclick="likeMessage(this)" title="Mark as helpful">
                <i class="far fa-thumbs-up"></i> Helpful
            </button>
            <button class="action-btn save" onclick="saveMessage(this)" title="Save to library">
                <i class="far fa-bookmark"></i> Save
            </button>
        `;
        messageContent.appendChild(messageActions);
    }
    
    messageDiv.appendChild(avatar);
    messageDiv.appendChild(messageContent);
    
    if (chatMessages) {
        chatMessages.appendChild(messageDiv);
        
        // Scroll to bottom
        setTimeout(() => {
            chatMessages.scrollTop = chatMessages.scrollHeight;
            checkScrollPosition();
        }, 100);
    }
    
    return messageId;
}

function sendMessage() {
    const userInput = document.getElementById('userInput');
    const sendButton = document.getElementById('sendButton');
    
    if (!userInput || !sendButton) return;
    
    const message = userInput.value.trim();
    
    if (!message) {
        showToast('Please enter a message 📝', 'warning');
        return;
    }
    
    if (isListening && recognition) {
        recognition.stop();
    }
    
    const messageId = addMessageToChat(message, true);
    userInput.value = '';
    userInput.style.height = '56px';
    sendButton.disabled = true;
    
    // Add user message to history
    const userMessage = {
        role: 'user',
        content: message,
        timestamp: new Date().toISOString()
    };
    conversationHistory.push(userMessage);
    
    // Show typing indicator
    const typingIndicator = addMessageToChat('<div style="display: flex; align-items: center; gap: 10px;"><div class="typing-dots"><span></span><span></span><span></span></div>Analyzing your legal query...</div>', false);
    
    // Simulate AI response after delay
    setTimeout(() => {
        // Remove typing indicator
        const typingElement = document.getElementById(typingIndicator);
        if (typingElement) typingElement.remove();
        
        // Generate response
        const aiResponse = generateAIResponse(message);
        const aiMessageId = addMessageToChat(aiResponse, false);
        
        // Add AI message to history
        const aiMessage = {
            role: 'assistant',
            content: aiResponse,
            timestamp: new Date().toISOString()
        };
        conversationHistory.push(aiMessage);
        
        // Save chat
        saveCurrentChat();
        
    }, 1500 + Math.random() * 1000);
}

function generateAIResponse(message) {
    const lowerMessage = message.toLowerCase();
    
    // Contract Law Responses
    if (lowerMessage.includes('contract') || lowerMessage.includes('agreement')) {
        return `**Contract Law Information** ⚖️

### Essential Elements of a Valid Contract in India:
1. **Offer and Acceptance** - Clear proposal and unconditional acceptance
2. **Intention to Create Legal Relations** - Parties must intend legal consequences
3. **Lawful Consideration** - Something of value exchanged
4. **Capacity of Parties** - Parties must be competent (18+ years, sound mind)
5. **Free Consent** - Without coercion, undue influence, fraud, misrepresentation, or mistake
6. **Lawful Object** - Purpose must not be illegal, immoral, or opposed to public policy
7. **Certainty and Possibility of Performance** - Terms must be clear and performance possible

### Key Statutes:
- Indian Contract Act, 1872
- Specific Relief Act, 1963
- Sale of Goods Act, 1930

### Sample Clause for Reference:
> "The parties hereby agree to the terms outlined herein, which shall be governed by and construed in accordance with the laws of India. Any disputes arising under this agreement shall be subject to the exclusive jurisdiction of the courts in [City, State]."

⚠️ **Important Notice**: This information is for educational purposes only. Always consult with a qualified attorney for contract drafting and legal advice specific to your situation.`;
    }
    
    // General Legal Responses
    const generalResponses = [
        `**Legal Guidance Based on Your Query** 📚

Based on Indian law, I can provide you with the following information:

### **Key Principles to Consider:**
1. **Document Everything** - Maintain written records of all communications and agreements
2. **Understand Relevant Statutes** - Different laws apply based on the subject matter
3. **Consider Jurisdiction** - Laws vary by state; ensure you're following local regulations
4. **Be Aware of Limitation Periods** - Legal actions have specific time limits (typically 3 years for civil matters)
5. **Preserve Evidence** - Keep all relevant documents, emails, and records

### **Common Legal Resources:**
- **Bare Acts**: Official texts of legislation
- **Case Laws**: Judicial interpretations and precedents
- **Legal Commentaries**: Expert analysis of laws
- **Government Portals**: Official websites for forms and procedures

### **Important Disclaimer:**
⚠️ **This is AI-generated information for educational purposes only. It is not legal advice and does not establish an attorney-client relationship.**

### **Next Steps:**
1. Consult with a qualified attorney for personalized advice
2. Review all documents with legal counsel
3. Consider mediation/arbitration for dispute resolution
4. Stay informed about legal updates relevant to your situation

**Remember**: Legal matters can be complex. Professional legal advice is essential for making informed decisions.`,

        `**Understanding Your Legal Query** 🔍

I understand you're asking about legal matters. Here's some general guidance that may be helpful:

### **Basic Legal Framework in India:**
• **Constitution of India** - Supreme law of the land
• **Central Acts** - Apply nationwide (IPC, CrPC, Evidence Act, etc.)
• **State Laws** - Vary by state (property, rent, agricultural laws)
• **Subsidiary Legislation** - Rules, regulations, and notifications
• **Judicial Precedents** - Binding decisions from higher courts

### **Practical Considerations:**
• **Cost-Benefit Analysis** - Consider time, money, and emotional costs
• **Alternative Dispute Resolution** - Mediation and arbitration can be faster and cheaper
• **Legal Aid** - Available for those who cannot afford representation
• **Pro Bono Services** - Many lawyers offer free services for deserving cases

### **Document Preparation Tips:**
✓ Use clear, unambiguous language
✓ Include all relevant dates and amounts
✓ Specify governing law and jurisdiction
✓ Include dispute resolution mechanisms
✓ Have documents witnessed and properly executed

### **Warning Signs to Watch For:**
❌ Vague or ambiguous terms
❌ Missing essential clauses
❌ Unfair or one-sided provisions
❌ Lack of termination clauses
❌ Inadequate dispute resolution mechanisms

### **Professional Assistance:**
Always consult with a licensed attorney who specializes in the relevant area of law. They can provide advice tailored to your specific circumstances and jurisdiction.`
    ];
    
    return generalResponses[Math.floor(Math.random() * generalResponses.length)];
}

function saveCurrentChat() {
    if (!currentChatId || conversationHistory.length === 0) return;
    
    let title = 'New Chat';
    let preview = 'No messages yet';
    
    if (conversationHistory.length > 0) {
        const firstUserMessage = conversationHistory.find(msg => msg.role === 'user');
        if (firstUserMessage) {
            title = firstUserMessage.content.substring(0, 30);
            if (firstUserMessage.content.length > 30) {
                title += '...';
            }
        }
        
        const lastMessage = conversationHistory[conversationHistory.length - 1];
        if (lastMessage) {
            preview = lastMessage.content.substring(0, 60).replace(/[#*`]/g, '');
            if (lastMessage.content.length > 60) {
                preview += '...';
            }
        }
    }
    
    const chatData = {
        id: currentChatId,
        title: title,
        preview: preview,
        date: new Date().toISOString(),
        messages: [...conversationHistory]
    };
    
    const chatIndex = chatHistory.findIndex(chat => chat.id === currentChatId);
    if (chatIndex !== -1) {
        chatHistory[chatIndex] = chatData;
    } else {
        chatHistory.unshift(chatData);
        
        // Keep only last 50 chats
        if (chatHistory.length > 50) {
            chatHistory = chatHistory.slice(0, 50);
        }
    }
    
    saveUserChatHistory();
}

function loadHistoryList() {
    const historyList = document.getElementById('historyList');
    if (!historyList) return;
    
    if (chatHistory.length === 0) {
        historyList.innerHTML = `
            <div class="empty-history">
                <i class="fas fa-comments"></i>
                <p>No chat history yet</p>
                <p style="font-size: 0.75rem; margin-top: 0.4rem;">Start a conversation to see it here</p>
            </div>
        `;
        return;
    }
    
    let html = '';
    chatHistory.forEach(chat => {
        const isActive = chat.id === currentChatId;
        const date = new Date(chat.date);
        const formattedDate = date.toLocaleDateString('en-IN', { 
            day: 'numeric', 
            month: 'short', 
            year: 'numeric' 
        }) + ' • ' + date.toLocaleTimeString('en-IN', { 
            hour: '2-digit', 
            minute: '2-digit' 
        });
        
        html += `
            <div class="history-item ${isActive ? 'active' : ''}" data-chat-id="${chat.id}">
                <div class="history-title">${chat.title}</div>
                <div class="history-preview">${chat.preview}</div>
                <div class="history-date"><i class="far fa-clock"></i> ${formattedDate}</div>
            </div>
        `;
    });
    
    historyList.innerHTML = html;
    
    // Add click handlers
    document.querySelectorAll('.history-item').forEach(item => {
        item.addEventListener('click', function() {
            const chatId = this.dataset.chatId;
            loadChatFromHistory(chatId);
            
            // Close sidebar on mobile
            const sidebar = document.getElementById('sidebar');
            if (sidebar && window.innerWidth <= 992) {
                sidebar.classList.remove('active');
            }
        });
    });
}

function loadChatFromHistory(chatId) {
    const chat = chatHistory.find(c => c.id === chatId);
    if (!chat) return;
    
    currentChatId = chatId;
    conversationHistory = [...chat.messages];
    
    const chatMessages = document.getElementById('chatMessages');
    if (chatMessages) {
        chatMessages.innerHTML = '';
        chat.messages.forEach(msg => {
            addMessageToChat(msg.content, msg.role === 'user', true);
        });
    }
    
    loadHistoryList();
    showToast('Chat loaded from history 📚', 'success');
    setTimeout(() => {
        scrollToBottom();
    }, 100);
}

function downloadChat(format) {
    let content = `LEGALSWAMI - CHAT HISTORY\n`;
    content += `Generated: ${new Date().toLocaleString('en-IN')}\n`;
    content += `========================================\n\n`;
    
    conversationHistory.forEach((msg, index) => {
        const role = msg.role === 'user' ? 'YOU' : 'LEGALSWAMI AI';
        const time = msg.timestamp ? new Date(msg.timestamp).toLocaleTimeString('en-IN', { 
            hour: '2-digit', 
            minute: '2-digit' 
        }) : new Date().toLocaleTimeString('en-IN', { 
            hour: '2-digit', 
            minute: '2-digit' 
        });
        
        content += `${role} (${time}):\n`;
        content += '─'.repeat(50) + '\n';
        
        // Clean HTML tags and format text
        const cleanText = msg.content
            .replace(/<br>/g, '\n')
            .replace(/<\/?[^>]+(>|$)/g, '')
            .replace(/\*\*(.*?)\*\*/g, '$1')
            .replace(/\*([^*]+)\*/g, '$1')
            .replace(/`([^`]+)`/g, '$1')
            .replace(/#+/g, '')
            .replace(/⚠️/g, '[IMPORTANT]')
            .replace(/⚖️/g, '[LAW]')
            .replace(/🔍/g, '[NOTE]')
            .replace(/📚/g, '[REFERENCE]')
            .replace(/⚡/g, '[TIP]')
            .replace(/🔐/g, '[CONFIDENTIAL]')
            .replace(/💼/g, '[BUSINESS]')
            .replace(/🏠/g, '[PROPERTY]')
            .replace(/💰/g, '[FINANCIAL]');
        
        content += cleanText + '\n\n';
        content += '═'.repeat(60) + '\n\n';
    });
    
    content += `\n\nDISCLAIMER:\n`;
    content += `This chat history is generated by LegalSwami AI Legal Assistant.\n`;
    content += `The information provided is for educational purposes only and not legal advice.\n`;
    content += `Always consult with a qualified attorney for legal matters.\n`;
    content += `\nGenerated by: LegalSwami (https://legalswami.com)\n`;
    
    const fileName = `LegalSwami-Chat-${formatDateForFilename(new Date())}`;
    
    if (format === 'txt') {
        downloadAsTXT(content, fileName);
    } else if (format === 'pdf') {
        try {
            downloadAsPDF(content, fileName);
        } catch (error) {
            console.error('PDF generation error:', error);
            downloadAsTXT(content, fileName);
            showToast('PDF generation failed. Text file downloaded instead.', 'warning');
        }
    } else if (format === 'doc') {
        downloadAsDOC(content, fileName);
    }
}

function downloadAsTXT(content, filename) {
    const blob = new Blob([content], { type: 'text/plain;charset=utf-8' });
    const url = URL.createObjectURL(blob);
    const a = document.createElement('a');
    a.href = url;
    a.download = `${filename}.txt`;
    document.body.appendChild(a);
    a.click();
    document.body.removeChild(a);
    URL.revokeObjectURL(url);
    showToast('Text file downloaded successfully 📥', 'success');
}

function downloadAsPDF(content, filename) {
    try {
        const { jsPDF } = window.jspdf;
        const doc = new jsPDF();
        
        // Set document properties
        doc.setProperties({
            title: 'LegalSwami Chat History',
            subject: 'AI Legal Assistant Conversation',
            author: 'LegalSwami AI',
            keywords: 'legal, ai, assistant, chat, history',
            creator: 'LegalSwami'
        });
        
        // Add header
        doc.setFontSize(16);
        doc.setFont('helvetica', 'bold');
        doc.setTextColor(30, 64, 175);
        doc.text('LEGALSWAMI - CHAT HISTORY', 105, 20, null, null, 'center');
        
        doc.setFontSize(10);
        doc.setFont('helvetica', 'normal');
        doc.setTextColor(100, 100, 100);
        doc.text(`Generated: ${new Date().toLocaleString()}`, 105, 28, null, null, 'center');
        
        // Add separator line
        doc.setDrawColor(212, 175, 55);
        doc.setLineWidth(0.5);
        doc.line(20, 32, 190, 32);
        
        // Prepare content
        doc.setFontSize(11);
        doc.setFont('helvetica', 'normal');
        doc.setTextColor(0, 0, 0);
        
        const lines = doc.splitTextToSize(content, 170);
        let yPos = 42;
        
        // Add content with pagination
        for (let i = 0; i < lines.length; i++) {
            if (yPos > 280) {
                doc.addPage();
                yPos = 20;
            }
            doc.text(lines[i], 20, yPos);
            yPos += 7;
        }
        
        // Add footer
        doc.setFontSize(9);
        doc.setTextColor(100, 100, 100);
        doc.text('Generated by LegalSwami AI Legal Assistant - https://legalswami.com', 105, 290, null, null, 'center');
        doc.text('Disclaimer: This is AI-generated information, not legal advice. Consult a qualified attorney.', 105, 295, null, null, 'center');
        
        // Save PDF
        doc.save(`${filename}.pdf`);
        showToast('PDF document downloaded successfully 📥', 'success');
    } catch (error) {
        console.error('PDF generation error:', error);
        throw error;
    }
}

function downloadAsDOC(content, filename) {
    const htmlContent = `
        <!DOCTYPE html>
        <html>
        <head>
            <meta charset="UTF-8">
            <title>${filename}</title>
            <style>
                body { font-family: Arial, sans-serif; line-height: 1.6; margin: 40px; }
                h1 { color: #1e40af; border-bottom: 2px solid #d4af37; padding-bottom: 10px; }
                .header { text-align: center; margin-bottom: 30px; }
                .message { margin-bottom: 20px; padding: 15px; border-left: 4px solid #d4af37; background: #f8fafc; }
                .user { border-left-color: #1e40af; }
                .ai { border-left-color: #059669; }
                .timestamp { color: #64748b; font-size: 0.9em; margin-bottom: 5px; }
                .disclaimer { margin-top: 40px; padding: 20px; background: #fef3c7; border: 1px solid #f59e0b; border-radius: 5px; }
            </style>
        </head>
        <body>
            <div class="header">
                <h1>LegalSwami Chat History</h1>
                <p>Generated on: ${new Date().toLocaleString()}</p>
            </div>
            
            <div class="content">
                <pre style="white-space: pre-wrap; font-family: 'Courier New', monospace;">${content.replace(/</g, '&lt;').replace(/>/g, '&gt;')}</pre>
            </div>
            
            <div class="disclaimer">
                <h3>Important Notice</h3>
                <p>This document contains AI-generated information from LegalSwami AI Legal Assistant. The content is provided for educational and informational purposes only and does not constitute legal advice. Always consult with a qualified attorney for legal matters specific to your situation.</p>
            </div>
        </body>
        </html>
    `;
    
    const blob = new Blob([htmlContent], { type: 'application/msword' });
    const url = URL.createObjectURL(blob);
    const a = document.createElement('a');
    a.href = url;
    a.download = `${filename}.doc`;
    document.body.appendChild(a);
    a.click();
    document.body.removeChild(a);
    URL.revokeObjectURL(url);
    showToast('Word document downloaded successfully 📥', 'success');
}

function formatDateForFilename(date) {
    return date.toISOString()
        .replace(/[:\-]/g, '')
        .replace('T', '_')
        .split('.')[0];
}

// =============================================
// LOGIN & AUTHENTICATION FUNCTIONS
// =============================================

function handleGoogleLogin() {
    console.log("🔐 Initializing Google login...");
    
    // For demo purposes, simulate Google login
    setTimeout(() => {
        const userData = {
            id: 'google_' + Date.now(),
            name: 'John Doe',
            email: 'john.doe@example.com',
            picture: 'https://randomuser.me/api/portraits/men/32.jpg',
            provider: 'google',
            isGuest: false
        };
        
        localStorage.setItem('legalSwamiUser', JSON.stringify(userData));
        localStorage.setItem('legalSwamiToken', 'google_token_' + Date.now());
        
        currentUser = userData;
        isLoggedIn = true;
        userToken = 'google_token';
        
        updateUserUI();
        
        const loginModal = document.getElementById('loginModal');
        if (loginModal) loginModal.classList.remove('active');
        
        showToast('Successfully signed in with Google! ✅', 'success');
    }, 1000);
}

function handleDemoLogin() {
    console.log("👤 Demo login triggered...");
    
    const demoUsers = [
        {
            id: 'demo_lawyer_1',
            name: 'Advocate Rajesh Kumar',
            email: 'demo.lawyer@example.com',
            role: 'lawyer',
            specialization: 'Corporate Law',
            picture: 'https://randomuser.me/api/portraits/men/32.jpg'
        },
        {
            id: 'demo_client_1',
            name: 'Priya Sharma',
            email: 'demo.client@example.com',
            role: 'client',
            caseType: 'Property Dispute',
            picture: 'https://randomuser.me/api/portraits/women/44.jpg'
        }
    ];
    
    const randomUser = demoUsers[Math.floor(Math.random() * demoUsers.length)];
    
    const userData = {
        id: randomUser.id,
        name: randomUser.name,
        email: randomUser.email,
        role: randomUser.role,
        picture: randomUser.picture,
        provider: 'demo',
        isDemo: true,
        isGuest: false
    };
    
    localStorage.setItem('legalSwamiUser', JSON.stringify(userData));
    localStorage.setItem('legalSwamiToken', 'demo_token_' + Date.now());
    
    currentUser = userData;
    isLoggedIn = true;
    userToken = 'demo_token';
    
    updateUserUI();
    
    const loginModal = document.getElementById('loginModal');
    if (loginModal) loginModal.classList.remove('active');
    
    showToast('Welcome ' + userData.name + '! (Demo Mode)', 'success');
}

// =============================================
// GLOBAL FUNCTIONS FOR MESSAGE ACTIONS
// =============================================

window.copyMessage = function(button) {
    const messageText = button.closest('.message-content').querySelector('.message-text');
    let textToCopy = messageText.textContent || messageText.innerText;
    
    // Create a temporary textarea element
    const textarea = document.createElement('textarea');
    textarea.value = textToCopy;
    textarea.style.position = 'fixed';
    textarea.style.opacity = '0';
    document.body.appendChild(textarea);
    textarea.select();
    textarea.setSelectionRange(0, 99999); // For mobile devices
    
    try {
        const successful = document.execCommand('copy');
        if (successful) {
            showToast('Response copied to clipboard! 📋', 'success');
            
            // Visual feedback
            button.innerHTML = '<i class="fas fa-check"></i> Copied!';
            button.style.background = 'linear-gradient(135deg, var(--success) 0%, #059669 100%)';
            button.style.color = 'white';
            
            setTimeout(() => {
                button.innerHTML = '<i class="fas fa-copy"></i> Copy';
                button.style.background = '';
                button.style.color = '';
            }, 2000);
        }
    } catch (err) {
        console.error('Copy failed:', err);
        showToast('Copy failed. Please select and copy manually.', 'error');
    }
    
    document.body.removeChild(textarea);
};

window.likeMessage = function(button) {
    button.innerHTML = '<i class="fas fa-thumbs-up"></i> Thank you!';
    button.style.background = 'linear-gradient(135deg, var(--success) 0%, #059669 100%)';
    button.style.color = 'white';
    button.disabled = true;
    showToast('Thank you for your feedback! 👍', 'success');
};

window.saveMessage = function(button) {
    button.innerHTML = '<i class="fas fa-bookmark"></i> Saved!';
    button.style.background = 'linear-gradient(135deg, var(--court-gold) 0%, var(--court-maroon) 100%)';
    button.style.color = 'white';
    button.disabled = true;
    showToast('Message saved to your library! 📚', 'success');
};

// =============================================
// TOAST NOTIFICATION
// =============================================

function showToast(message, type = 'success') {
    const toast = document.getElementById('toast');
    const toastMessage = document.getElementById('toast-message');
    
    if (toast && toastMessage) {
        // Update toast content
        toastMessage.textContent = message;
        toast.className = `toast ${type} show`;
        
        // Update icon based on type
        const icon = toast.querySelector('i');
        if (icon) {
            switch(type) {
                case 'success': icon.className = 'fas fa-check-circle'; break;
                case 'error': icon.className = 'fas fa-exclamation-circle'; break;
                case 'warning': icon.className = 'fas fa-exclamation-triangle'; break;
                case 'info': icon.className = 'fas fa-info-circle'; break;
                default: icon.className = 'fas fa-check-circle';
            }
        }
        
        // Auto-hide after 3 seconds
        setTimeout(() => {
            toast.classList.remove('show');
        }, 3000);
    }
}

// =============================================
// EVENT LISTENERS SETUP
// =============================================

document.addEventListener('DOMContentLoaded', function() {
    console.log('🚀 LegalSwami AI Legal Assistant Initialized');
    
    // Start chat buttons
    const startChatBtn = document.getElementById('startChatBtn');
    if (startChatBtn) {
        startChatBtn.addEventListener('click', function(e) {
            e.preventDefault();
            e.stopPropagation();
            openChat();
        });
    }

    const ctaStartChat = document.getElementById('ctaStartChat');
    if (ctaStartChat) {
        ctaStartChat.addEventListener('click', function(e) {
            e.preventDefault();
            e.stopPropagation();
            openChat();
        });
    }

    const mobileStartChat = document.getElementById('mobileStartChat');
    if (mobileStartChat) {
        mobileStartChat.addEventListener('click', function(e) {
            e.preventDefault();
            e.stopPropagation();
            openChat();
            const mobileMenu = document.getElementById('mobileMenu');
            if (mobileMenu) mobileMenu.style.display = 'none';
        });
    }

    // Hero assistant button
    const heroAssistantBtn = document.getElementById('heroAssistantBtn');
    if (heroAssistantBtn) {
        heroAssistantBtn.addEventListener('click', openChat);
    }

    // Document generation buttons
    document.querySelectorAll('.btn-generate, .btn-database, .btn-guide, .btn-consult').forEach(button => {
        button.addEventListener('click', function(e) {
            e.preventDefault();
            openChat();
        });
    });

    // Header login button
    const headerLoginBtn = document.getElementById('headerLoginBtn');
    if (headerLoginBtn) {
        headerLoginBtn.addEventListener('click', function() {
            const loginModal = document.getElementById('loginModal');
            if (loginModal) loginModal.classList.add('active');
        });
    }

    // Pricing plan buttons
    const freePlanBtn = document.getElementById('freePlanBtn');
    if (freePlanBtn) {
        freePlanBtn.addEventListener('click', function() {
            showToast('Free plan activated! Enjoy 10 daily messages.', 'success');
        });
    }

    const proPlanBtn = document.getElementById('proPlanBtn');
    if (proPlanBtn) {
        proPlanBtn.addEventListener('click', function() {
            const loginModal = document.getElementById('loginModal');
            if (loginModal) loginModal.classList.add('active');
            showToast('Please sign in to subscribe to Professional plan.', 'info');
        });
    }

    const enterprisePlanBtn = document.getElementById('enterprisePlanBtn');
    if (enterprisePlanBtn) {
        enterprisePlanBtn.addEventListener('click', function() {
            showToast('Enterprise plan contact feature coming soon! 📞', 'info');
        });
    }

    // Pricing Google login button
    const pricingGoogleBtn = document.getElementById('pricingGoogleBtn');
    if (pricingGoogleBtn) {
        pricingGoogleBtn.addEventListener('click', function() {
            const loginModal = document.getElementById('loginModal');
            if (loginModal) loginModal.classList.add('active');
        });
    }

    // Watch demo button
    const watchDemo = document.getElementById('watchDemo');
    if (watchDemo) {
        watchDemo.addEventListener('click', function(e) {
            e.preventDefault();
            showToast('Demo video feature coming soon! 🎬', 'info');
        });
    }

    // Schedule demo button
    const ctaScheduleDemo = document.getElementById('ctaScheduleDemo');
    if (ctaScheduleDemo) {
        ctaScheduleDemo.addEventListener('click', function(e) {
            e.preventDefault();
            showToast('Schedule demo feature coming soon! 📅', 'info');
        });
    }

    // Mobile menu toggle
    const mobileToggle = document.getElementById('mobileToggle');
    const mobileMenu = document.getElementById('mobileMenu');
    const mobileClose = document.getElementById('mobileClose');
    
    if (mobileToggle && mobileMenu) {
        mobileToggle.addEventListener('click', function() {
            mobileMenu.style.display = 'block';
            setTimeout(() => {
                mobileMenu.style.opacity = '1';
            }, 10);
        });
    }
    
    if (mobileClose && mobileMenu) {
        mobileClose.addEventListener('click', function() {
            mobileMenu.style.opacity = '0';
            setTimeout(() => {
                mobileMenu.style.display = 'none';
            }, 300);
        });
    }

    // Initialize app for guest
    setTimeout(() => {
        // Check for existing user
        const savedUser = localStorage.getItem('legalSwamiUser');
        if (savedUser) {
            try {
                currentUser = JSON.parse(savedUser);
                isLoggedIn = true;
                userToken = localStorage.getItem('legalSwamiToken');
                showToast('Welcome back, ' + currentUser.name + '!', 'success');
            } catch (e) {
                console.error('Error parsing user data:', e);
                initializeAppForGuest();
            }
        } else {
            initializeAppForGuest();
        }
        
        updateUserUI();
        
        // Hide loading screen
        const loadingScreen = document.getElementById('loadingScreen');
        if (loadingScreen) {
            loadingScreen.style.opacity = '0';
            setTimeout(() => {
                loadingScreen.style.display = 'none';
            }, 300);
        }
    }, 1500);

    // Back to top button
    const backToTopBtn = document.getElementById('backToTop');
    if (backToTopBtn) {
        backToTopBtn.addEventListener('click', function() {
            window.scrollTo({ top: 0, behavior: 'smooth' });
        });
        
        window.addEventListener('scroll', function() {
            if (window.pageYOffset > 300) {
                backToTopBtn.style.display = 'flex';
            } else {
                backToTopBtn.style.display = 'none';
            }
        });
    }

    // Smooth scrolling for navigation links
    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener('click', function(e) {
            const href = this.getAttribute('href');
            if (href === '#' || href === '#chat') return;
            
            e.preventDefault();
            const targetId = href;
            const targetElement = document.querySelector(targetId);
            
            if (targetElement) {
                window.scrollTo({
                    top: targetElement.offsetTop - 80,
                    behavior: 'smooth'
                });
                
                // Update active nav link
                document.querySelectorAll('.nav-link, .mobile-link').forEach(link => {
                    link.classList.remove('active');
                });
                this.classList.add('active');
                
                // Close mobile menu if open
                const mobileMenu = document.getElementById('mobileMenu');
                if (mobileMenu && mobileMenu.style.display === 'block') {
                    mobileMenu.style.opacity = '0';
                    setTimeout(() => {
                        mobileMenu.style.display = 'none';
                    }, 300);
                }
            }
        });
    });

    // Handle escape key
    document.addEventListener('keydown', function(e) {
        if (e.key === 'Escape') {
            // Close chat if open
            if (document.body.classList.contains('chat-active')) {
                closeChat();
            }
            
            // Close mobile menu
            const mobileMenu = document.getElementById('mobileMenu');
            if (mobileMenu && mobileMenu.style.display === 'block') {
                mobileMenu.style.opacity = '0';
                setTimeout(() => {
                    mobileMenu.style.display = 'none';
                }, 300);
            }
            
            // Close sidebar
            const sidebar = document.getElementById('sidebar');
            if (sidebar && sidebar.classList.contains('active')) {
                sidebar.classList.remove('active');
            }
            
            // Close download modal
            const downloadModal = document.getElementById('downloadModal');
            if (downloadModal && downloadModal.classList.contains('active')) {
                downloadModal.classList.remove('active');
            }
            
            // Close login modal
            const loginModal = document.getElementById('loginModal');
            if (loginModal && loginModal.classList.contains('active')) {
                loginModal.classList.remove('active');
            }
        }
    });

    // Handle clicks outside sidebar on mobile
    document.addEventListener('click', function(e) {
        const sidebar = document.getElementById('sidebar');
        const sidebarToggle = document.getElementById('sidebarToggle');
        
        if (sidebar && sidebar.classList.contains('active') && 
            window.innerWidth <= 992 && 
            !sidebar.contains(e.target) && 
            (!sidebarToggle || !sidebarToggle.contains(e.target))) {
            sidebar.classList.remove('active');
        }
    });

    console.log('✅ App ready to use');
});
    </script>
</body>
</html>
